Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=16, epochs=1000, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='padding', prompt_size=30, text_prompt_template='A photo of a {}', root='./data', dataset='cifar10', image_size=224, test_noise=True, visualize_prompt=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume='./checkpoints/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar', evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 32768/170498071 [00:00<11:31, 246437.98it/s]  0%|          | 98304/170498071 [00:00<07:47, 364391.16it/s]  0%|          | 196608/170498071 [00:00<05:34, 509796.80it/s]  0%|          | 491520/170498071 [00:00<02:13, 1271065.61it/s]  1%|          | 1081344/170498071 [00:00<01:03, 2685516.53it/s]  1%|▏         | 2392064/170498071 [00:00<00:32, 5227376.88it/s]  2%|▏         | 4128768/170498071 [00:00<00:19, 8573249.70it/s]  4%|▎         | 6127616/170498071 [00:00<00:13, 11803727.81it/s]  5%|▍         | 8224768/170498071 [00:01<00:11, 14440943.53it/s]  6%|▌         | 10452992/170498071 [00:01<00:09, 16712616.53it/s]  7%|▋         | 12615680/170498071 [00:01<00:08, 18136830.52it/s]  9%|▊         | 14712832/170498071 [00:01<00:08, 18879055.74it/s] 10%|█         | 17399808/170498071 [00:01<00:07, 21239181.36it/s] 12%|█▏        | 19955712/170498071 [00:01<00:06, 22506834.55it/s] 14%|█▎        | 23068672/170498071 [00:01<00:05, 24870070.76it/s] 15%|█▌        | 26247168/170498071 [00:01<00:05, 26834666.23it/s] 17%|█▋        | 29229056/170498071 [00:01<00:05, 27717963.59it/s] 19%|█▉        | 32210944/170498071 [00:01<00:04, 28338287.65it/s] 21%|██        | 35094528/170498071 [00:02<00:04, 28467011.09it/s] 22%|██▏       | 37978112/170498071 [00:02<00:04, 28244391.82it/s] 24%|██▍       | 40927232/170498071 [00:02<00:04, 28519125.04it/s] 26%|██▌       | 44072960/170498071 [00:02<00:04, 29261770.13it/s] 28%|██▊       | 47022080/170498071 [00:02<00:04, 29318720.91it/s] 29%|██▉       | 49971200/170498071 [00:02<00:04, 29331253.28it/s] 31%|███       | 53018624/170498071 [00:02<00:03, 29659645.31it/s] 33%|███▎      | 56000512/170498071 [00:02<00:03, 29179062.58it/s] 35%|███▍      | 59211776/170498071 [00:02<00:03, 30041250.31it/s] 36%|███▋      | 62226432/170498071 [00:02<00:03, 29646870.43it/s] 38%|███▊      | 65208320/170498071 [00:03<00:03, 29504000.59it/s] 40%|███▉      | 68190208/170498071 [00:03<00:03, 29557090.50it/s] 42%|████▏     | 71270400/170498071 [00:03<00:03, 29757902.25it/s] 44%|████▎     | 74317824/170498071 [00:03<00:03, 29911129.12it/s] 45%|████▌     | 77332480/170498071 [00:03<00:03, 29892422.76it/s] 47%|████▋     | 80347136/170498071 [00:03<00:03, 29717000.57it/s] 49%|████▉     | 83329024/170498071 [00:03<00:02, 29451214.59it/s] 51%|█████     | 86310912/170498071 [00:03<00:02, 29471504.77it/s] 52%|█████▏    | 89292800/170498071 [00:03<00:02, 29459551.19it/s] 54%|█████▍    | 92438528/170498071 [00:04<00:02, 29889938.97it/s] 56%|█████▌    | 95715328/170498071 [00:04<00:02, 30741972.10it/s] 58%|█████▊    | 98795520/170498071 [00:04<00:02, 30697139.64it/s] 60%|█████▉    | 101941248/170498071 [00:04<00:02, 30674885.46it/s] 62%|██████▏   | 105119744/170498071 [00:04<00:02, 30648366.85it/s] 63%|██████▎   | 108232704/170498071 [00:04<00:02, 30707423.19it/s] 65%|██████▌   | 111443968/170498071 [00:04<00:01, 31109007.46it/s] 67%|██████▋   | 114556928/170498071 [00:04<00:01, 30843704.73it/s] 69%|██████▉   | 117702656/170498071 [00:04<00:01, 30961956.55it/s] 71%|███████   | 120848384/170498071 [00:04<00:01, 29974056.99it/s] 73%|███████▎  | 123895808/170498071 [00:05<00:01, 30062552.45it/s] 74%|███████▍  | 126910464/170498071 [00:05<00:01, 29826246.54it/s] 76%|███████▌  | 129957888/170498071 [00:05<00:01, 29735899.92it/s] 78%|███████▊  | 133136384/170498071 [00:05<00:01, 29946709.82it/s] 80%|███████▉  | 136216576/170498071 [00:05<00:01, 29836275.28it/s] 82%|████████▏ | 139296768/170498071 [00:05<00:01, 29911499.42it/s] 84%|████████▎ | 142376960/170498071 [00:05<00:00, 30041454.57it/s] 85%|████████▌ | 145620992/170498071 [00:05<00:00, 30738702.73it/s] 87%|████████▋ | 148733952/170498071 [00:05<00:00, 30846116.45it/s] 89%|████████▉ | 151977984/170498071 [00:05<00:00, 31063266.19it/s] 91%|█████████ | 155123712/170498071 [00:06<00:00, 31122552.17it/s] 93%|█████████▎| 158269440/170498071 [00:06<00:00, 30929995.45it/s] 95%|█████████▍| 161415168/170498071 [00:06<00:00, 30952910.90it/s] 97%|█████████▋| 164560896/170498071 [00:06<00:00, 30912887.46it/s] 98%|█████████▊| 167706624/170498071 [00:06<00:00, 30934584.20it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 26029161.83it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting ./data/cifar-10-python.tar.gz to ./data
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  8%|██▉                                    | 25.5M/338M [00:00<00:01, 267MiB/s] 16%|██████                                 | 52.7M/338M [00:00<00:01, 278MiB/s] 24%|█████████▎                             | 80.3M/338M [00:00<00:00, 283MiB/s] 32%|████████████▋                           | 107M/338M [00:00<00:00, 271MiB/s] 40%|████████████████                        | 136M/338M [00:00<00:00, 281MiB/s] 49%|███████████████████▍                    | 164M/338M [00:00<00:00, 284MiB/s] 57%|██████████████████████▋                 | 191M/338M [00:00<00:00, 209MiB/s] 63%|█████████████████████████▎              | 213M/338M [00:01<00:00, 178MiB/s] 72%|████████████████████████████▋           | 242M/338M [00:01<00:00, 206MiB/s] 80%|████████████████████████████████        | 271M/338M [00:01<00:00, 230MiB/s] 88%|███████████████████████████████████▎    | 298M/338M [00:01<00:00, 243MiB/s] 96%|██████████████████████████████████████▎ | 323M/338M [00:01<00:00, 238MiB/s]100%|████████████████████████████████████████| 338M/338M [00:01<00:00, 239MiB/s]
List of prompts:
['A photo of a airplane',
 'A photo of a automobile',
 'A photo of a bird',
 'A photo of a cat',
 'A photo of a deer',
 'A photo of a dog',
 'A photo of a frog',
 'A photo of a horse',
 'A photo of a ship',
 'A photo of a truck']
=> loading checkpoint './checkpoints/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1/model_best.pth.tar'
Traceback (most recent call last):
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/robustness.py", line 156, in <module>
    main()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/robustness.py", line 143, in main
    learn = Learner(args)
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/learner.py", line 60, in __init__
    self.resume_checkpoint()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/learner.py", line 127, in resume_checkpoint
    self.vpt.prompt_learner.load_state_dict(checkpoint["state_dict"])
  File "/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1667, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for PadPrompter:
	Missing key(s) in state_dict: "pad_down", "pad_up", "pad_left", "pad_right". 
	Unexpected key(s) in state_dict: "patch". 
