Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:00, 354735.18it/s]  0%|          | 131072/170498071 [00:00<05:54, 480908.70it/s]  0%|          | 262144/170498071 [00:00<03:37, 782994.74it/s]  0%|          | 360448/170498071 [00:00<03:22, 838221.53it/s]  0%|          | 720896/170498071 [00:00<01:38, 1729659.75it/s]  1%|          | 1507328/170498071 [00:00<00:46, 3636224.05it/s]  2%|▏         | 2883584/170498071 [00:00<00:24, 6769894.94it/s]  3%|▎         | 4489216/170498071 [00:00<00:17, 9586547.37it/s]  4%|▎         | 6193152/170498071 [00:01<00:13, 11789489.33it/s]  5%|▍         | 7897088/170498071 [00:01<00:12, 13347808.23it/s]  6%|▌         | 9666560/170498071 [00:01<00:10, 14651686.08it/s]  7%|▋         | 11599872/170498071 [00:01<00:09, 16039094.97it/s]  8%|▊         | 13402112/170498071 [00:01<00:09, 16619912.33it/s]  9%|▉         | 15171584/170498071 [00:01<00:09, 16914335.37it/s] 10%|█         | 17170432/170498071 [00:01<00:08, 17809792.21it/s] 11%|█▏        | 19202048/170498071 [00:01<00:08, 18554960.87it/s] 13%|█▎        | 21397504/170498071 [00:01<00:07, 19549542.80it/s] 14%|█▍        | 23724032/170498071 [00:01<00:07, 20657691.60it/s] 15%|█▌        | 26214400/170498071 [00:02<00:06, 21914693.65it/s] 17%|█▋        | 28901376/170498071 [00:02<00:06, 23394713.54it/s] 19%|█▊        | 31653888/170498071 [00:02<00:05, 24616518.92it/s] 20%|██        | 34603008/170498071 [00:02<00:05, 26059854.85it/s] 22%|██▏       | 37715968/170498071 [00:02<00:04, 27559827.73it/s] 24%|██▍       | 40828928/170498071 [00:02<00:04, 28619151.84it/s] 26%|██▌       | 43843584/170498071 [00:02<00:04, 29076746.51it/s] 27%|██▋       | 46825472/170498071 [00:02<00:04, 29280994.66it/s] 29%|██▉       | 49807360/170498071 [00:02<00:04, 29429834.99it/s] 31%|███       | 52756480/170498071 [00:02<00:04, 29429540.08it/s] 33%|███▎      | 55738368/170498071 [00:03<00:03, 29535495.28it/s] 35%|███▍      | 58884096/170498071 [00:03<00:03, 29953011.57it/s] 36%|███▋      | 62128128/170498071 [00:03<00:03, 30465663.87it/s] 38%|███▊      | 65306624/170498071 [00:03<00:03, 30665207.17it/s] 40%|████      | 68517888/170498071 [00:03<00:03, 30869775.61it/s] 42%|████▏     | 71663616/170498071 [00:03<00:03, 30912142.36it/s] 44%|████▍     | 74842112/170498071 [00:03<00:03, 30968577.43it/s] 46%|████▌     | 77955072/170498071 [00:03<00:02, 30909671.08it/s] 48%|████▊     | 81068032/170498071 [00:03<00:02, 30840478.00it/s] 49%|████▉     | 84180992/170498071 [00:03<00:02, 30796493.65it/s] 51%|█████     | 87261184/170498071 [00:04<00:02, 30686408.60it/s] 53%|█████▎    | 90341376/170498071 [00:04<00:02, 30593300.24it/s] 55%|█████▍    | 93552640/170498071 [00:04<00:02, 30822239.20it/s] 57%|█████▋    | 96665600/170498071 [00:04<00:02, 30786944.21it/s] 59%|█████▊    | 99745792/170498071 [00:04<00:02, 30663948.13it/s] 60%|██████    | 102825984/170498071 [00:04<00:02, 30596466.26it/s] 62%|██████▏   | 106037248/170498071 [00:04<00:02, 30845256.91it/s] 64%|██████▍   | 109182976/170498071 [00:04<00:01, 30819428.88it/s] 66%|██████▌   | 112328704/170498071 [00:04<00:01, 30865764.97it/s] 68%|██████▊   | 115539968/170498071 [00:04<00:01, 31022467.63it/s] 70%|██████▉   | 118751232/170498071 [00:05<00:01, 31153279.06it/s] 72%|███████▏  | 121962496/170498071 [00:05<00:01, 31232492.12it/s] 73%|███████▎  | 125140992/170498071 [00:05<00:01, 31207200.13it/s] 75%|███████▌  | 128319488/170498071 [00:05<00:01, 31224206.07it/s] 77%|███████▋  | 131530752/170498071 [00:05<00:01, 31283285.56it/s] 79%|███████▉  | 134676480/170498071 [00:05<00:01, 30974772.05it/s] 81%|████████  | 137789440/170498071 [00:05<00:01, 30265003.60it/s] 83%|████████▎ | 140836864/170498071 [00:05<00:00, 30239659.78it/s] 84%|████████▍ | 143982592/170498071 [00:05<00:00, 30450695.56it/s] 86%|████████▋ | 147193856/170498071 [00:05<00:00, 30665340.50it/s] 88%|████████▊ | 150372352/170498071 [00:06<00:00, 30816743.39it/s] 90%|█████████ | 153485312/170498071 [00:06<00:00, 30771435.90it/s] 92%|█████████▏| 156565504/170498071 [00:06<00:00, 30670865.13it/s] 94%|█████████▎| 159645696/170498071 [00:06<00:00, 30601570.93it/s] 95%|█████████▌| 162758656/170498071 [00:06<00:00, 30632836.42it/s] 97%|█████████▋| 165937152/170498071 [00:06<00:00, 30774689.80it/s] 99%|█████████▉| 169148416/170498071 [00:06<00:00, 30965796.99it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25264649.91it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Using prompt template: This is a photo of a {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  2%|▉                                     | 8.26M/338M [00:00<00:04, 86.1MiB/s]  5%|██                                    | 18.0M/338M [00:00<00:03, 95.2MiB/s]  8%|███▎                                   | 28.4M/338M [00:00<00:03, 102MiB/s] 11%|████▎                                 | 38.1M/338M [00:00<00:03, 98.4MiB/s] 14%|█████▎                                | 47.5M/338M [00:00<00:03, 94.5MiB/s] 17%|██████▎                               | 56.6M/338M [00:00<00:03, 91.0MiB/s] 19%|███████▎                              | 65.3M/338M [00:00<00:05, 52.7MiB/s] 22%|████████▍                             | 75.1M/338M [00:01<00:04, 62.9MiB/s] 25%|█████████▎                            | 82.8M/338M [00:01<00:04, 60.6MiB/s] 27%|██████████                            | 89.7M/338M [00:01<00:04, 61.9MiB/s] 29%|██████████▊                           | 96.4M/338M [00:01<00:03, 63.3MiB/s] 31%|████████████▏                          | 106M/338M [00:01<00:03, 71.9MiB/s] 34%|█████████████                          | 113M/338M [00:01<00:03, 65.0MiB/s] 36%|██████████████                         | 122M/338M [00:01<00:03, 72.0MiB/s] 39%|███████████████▏                       | 132M/338M [00:01<00:02, 79.0MiB/s] 42%|████████████████▎                      | 141M/338M [00:01<00:02, 83.7MiB/s] 44%|█████████████████▏                     | 149M/338M [00:02<00:02, 76.3MiB/s] 47%|██████████████████▎                    | 158M/338M [00:02<00:02, 80.7MiB/s] 49%|███████████████████▏                   | 166M/338M [00:02<00:02, 81.4MiB/s] 52%|████████████████████                   | 174M/338M [00:02<00:02, 80.9MiB/s] 54%|█████████████████████▏                 | 183M/338M [00:02<00:01, 85.8MiB/s] 57%|██████████████████████▏                | 192M/338M [00:02<00:01, 76.7MiB/s] 59%|███████████████████████                | 199M/338M [00:02<00:02, 58.3MiB/s] 62%|████████████████████████               | 208M/338M [00:02<00:02, 65.5MiB/s] 64%|████████████████████████▊              | 215M/338M [00:03<00:02, 62.7MiB/s] 66%|█████████████████████████▋             | 222M/338M [00:03<00:02, 58.6MiB/s] 69%|██████████████████████████▊            | 232M/338M [00:03<00:01, 68.6MiB/s] 71%|███████████████████████████▋           | 239M/338M [00:03<00:01, 61.6MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:03<00:01, 65.6MiB/s] 76%|█████████████████████████████▌         | 256M/338M [00:03<00:01, 73.2MiB/s] 78%|██████████████████████████████▌        | 264M/338M [00:03<00:00, 77.0MiB/s] 81%|███████████████████████████████▌       | 273M/338M [00:03<00:00, 81.6MiB/s] 83%|████████████████████████████████▍      | 281M/338M [00:04<00:00, 70.6MiB/s] 86%|█████████████████████████████████▌     | 291M/338M [00:04<00:00, 75.6MiB/s] 89%|██████████████████████████████████▌    | 299M/338M [00:04<00:00, 78.7MiB/s] 91%|███████████████████████████████████▍   | 307M/338M [00:04<00:00, 79.2MiB/s] 93%|████████████████████████████████████▎  | 315M/338M [00:04<00:00, 79.7MiB/s] 96%|█████████████████████████████████████▎ | 323M/338M [00:04<00:00, 80.7MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:04<00:00, 83.0MiB/s]100%|███████████████████████████████████████| 338M/338M [00:04<00:00, 73.9MiB/s]


List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Precomputing text features
Iterating over train set of cifar10
Zero-shot CLIP top-1 accuracy on cifar10/train: 88.676
