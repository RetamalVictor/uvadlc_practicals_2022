Running experiment on cifar10 with padding, and prompt size 1,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'padding,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with padding, and prompt size 3,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'padding,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with padding, and prompt size 6
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'padding,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with random_patch, and prompt size 1,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'random_patch,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with random_patch, and prompt size 3,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'random_patch,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with random_patch, and prompt size 6
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --method: invalid choice: 'random_patch,' (choose from 'padding', 'random_patch', 'fixed_patch')
Running experiment on cifar10 with fixed_patch and prompt size 1,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --prompt_size: invalid int value: '1,'
Running experiment on cifar10 with fixed_patch and prompt size 3,
usage: Visual Prompting for CLIP [-h] [--print_freq PRINT_FREQ]
                                 [--save_freq SAVE_FREQ]
                                 [--batch_size BATCH_SIZE]
                                 [--num_workers NUM_WORKERS] [--epochs EPOCHS]
                                 [--square_size SQUARE_SIZE] [--optim OPTIM]
                                 [--learning_rate LEARNING_RATE]
                                 [--weight_decay WEIGHT_DECAY]
                                 [--warmup WARMUP] [--momentum MOMENTUM]
                                 [--patience PATIENCE] [--model MODEL]
                                 [--arch ARCH]
                                 [--method {padding,random_patch,fixed_patch}]
                                 [--prompt_size PROMPT_SIZE]
                                 [--text_prompt_template TEXT_PROMPT_TEMPLATE]
                                 [--visualize_prompt] [--root ROOT]
                                 [--dataset DATASET] [--image_size IMAGE_SIZE]
                                 [--test_noise] [--seed SEED]
                                 [--model_dir MODEL_DIR]
                                 [--image_dir IMAGE_DIR] [--filename FILENAME]
                                 [--trial TRIAL] [--resume RESUME]
                                 [--evaluate] [--gpu GPU] [--use_wandb]
Visual Prompting for CLIP: error: argument --prompt_size: invalid int value: '3,'
Running experiment on cifar10 with fixed_patch and prompt size 6
Namespace(print_freq=10, save_freq=50, batch_size=128, num_workers=12, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=1000, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=6, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='./save/models', image_dir='./save/images', filename='fixed_patch_6_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='./save/models/fixed_patch_6_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:08, 349096.97it/s]  0%|          | 131072/170498071 [00:00<08:19, 340757.84it/s]  0%|          | 229376/170498071 [00:00<06:50, 415239.97it/s]  0%|          | 458752/170498071 [00:00<03:11, 887654.38it/s]  1%|          | 917504/170498071 [00:00<01:30, 1864960.85it/s]  1%|          | 1835008/170498071 [00:00<00:43, 3868259.17it/s]  2%|▏         | 3309568/170498071 [00:00<00:24, 6921642.04it/s]  3%|▎         | 5111808/170498071 [00:01<00:16, 10098991.75it/s]  4%|▍         | 6914048/170498071 [00:01<00:13, 12377179.63it/s]  5%|▌         | 8814592/170498071 [00:01<00:11, 14314166.91it/s]  6%|▋         | 10911744/170498071 [00:01<00:09, 16268535.96it/s]  8%|▊         | 13074432/170498071 [00:01<00:08, 17850004.50it/s]  9%|▉         | 15433728/170498071 [00:01<00:08, 18361143.97it/s] 11%|█         | 18251776/170498071 [00:01<00:07, 21131136.21it/s] 12%|█▏        | 21266432/170498071 [00:01<00:06, 23722846.22it/s] 14%|█▍        | 24313856/170498071 [00:01<00:05, 25686130.97it/s] 16%|█▌        | 27230208/170498071 [00:02<00:05, 26706988.65it/s] 18%|█▊        | 30474240/170498071 [00:02<00:04, 28381943.02it/s] 20%|█▉        | 33554432/170498071 [00:02<00:05, 26090557.97it/s] 22%|██▏       | 36831232/170498071 [00:02<00:04, 27909746.22it/s] 23%|██▎       | 39976960/170498071 [00:02<00:04, 28379670.68it/s] 25%|██▌       | 43188224/170498071 [00:02<00:04, 29428532.77it/s] 27%|██▋       | 46432256/170498071 [00:02<00:04, 30271234.18it/s] 29%|██▉       | 49512448/170498071 [00:02<00:03, 30355081.81it/s] 31%|███       | 52690944/170498071 [00:02<00:03, 30754253.06it/s] 33%|███▎      | 55803904/170498071 [00:02<00:03, 30804181.82it/s] 35%|███▍      | 58949632/170498071 [00:03<00:03, 30890248.27it/s] 36%|███▋      | 62095360/170498071 [00:03<00:03, 31052655.42it/s] 38%|███▊      | 65241088/170498071 [00:03<00:03, 31149636.78it/s] 40%|████      | 68386816/170498071 [00:03<00:03, 31150273.14it/s] 42%|████▏     | 71532544/170498071 [00:03<00:03, 31003226.76it/s] 44%|████▍     | 74645504/170498071 [00:03<00:03, 30872844.41it/s] 46%|████▌     | 77758464/170498071 [00:03<00:03, 30778780.33it/s] 47%|████▋     | 80838656/170498071 [00:03<00:02, 30590118.20it/s] 49%|████▉     | 83918848/170498071 [00:03<00:02, 30419687.32it/s] 51%|█████     | 86966272/170498071 [00:03<00:02, 30344497.02it/s] 53%|█████▎    | 90013696/170498071 [00:04<00:02, 30284490.56it/s] 55%|█████▍    | 93159424/170498071 [00:04<00:02, 30274242.78it/s] 57%|█████▋    | 96403456/170498071 [00:04<00:02, 30893606.26it/s] 58%|█████▊    | 99516416/170498071 [00:04<00:02, 30665643.96it/s] 60%|██████    | 102760448/170498071 [00:04<00:02, 31109643.60it/s] 62%|██████▏   | 105938944/170498071 [00:04<00:02, 31303142.72it/s] 64%|██████▍   | 109084672/170498071 [00:04<00:01, 31304908.78it/s] 66%|██████▌   | 112295936/170498071 [00:04<00:01, 31520513.46it/s] 68%|██████▊   | 115474432/170498071 [00:04<00:01, 31556186.81it/s] 70%|██████▉   | 118652928/170498071 [00:04<00:01, 31091865.60it/s] 71%|███████▏  | 121798656/170498071 [00:05<00:01, 30956184.86it/s] 73%|███████▎  | 125009920/170498071 [00:05<00:01, 31251236.56it/s] 75%|███████▌  | 128155648/170498071 [00:05<00:01, 30840545.57it/s] 77%|███████▋  | 131301376/170498071 [00:05<00:01, 30655723.62it/s] 79%|███████▉  | 134414336/170498071 [00:05<00:01, 30636752.25it/s] 81%|████████  | 137658368/170498071 [00:05<00:01, 30755447.59it/s] 83%|████████▎ | 140771328/170498071 [00:05<00:00, 30819363.69it/s] 84%|████████▍ | 143917056/170498071 [00:05<00:00, 30991406.78it/s] 86%|████████▋ | 147095552/170498071 [00:05<00:00, 31224114.58it/s] 88%|████████▊ | 150339584/170498071 [00:06<00:00, 31340820.67it/s] 90%|█████████ | 153583616/170498071 [00:06<00:00, 31638519.96it/s] 92%|█████████▏| 156762112/170498071 [00:06<00:00, 31668740.77it/s] 94%|█████████▍| 160006144/170498071 [00:06<00:00, 31779560.48it/s] 96%|█████████▌| 163184640/170498071 [00:06<00:00, 31773505.84it/s] 98%|█████████▊| 166363136/170498071 [00:06<00:00, 30835567.74it/s] 99%|█████████▉| 169508864/170498071 [00:06<00:00, 29703953.31it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25566648.66it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  2%|▋                                     | 6.09M/338M [00:00<00:05, 63.8MiB/s]  4%|█▎                                    | 12.2M/338M [00:00<00:06, 56.4MiB/s]  5%|██                                    | 18.3M/338M [00:00<00:05, 59.6MiB/s]  7%|██▋                                   | 24.0M/338M [00:00<00:05, 58.9MiB/s]  9%|███▎                                  | 29.7M/338M [00:00<00:05, 57.6MiB/s] 11%|████                                  | 36.0M/338M [00:00<00:05, 59.8MiB/s] 12%|████▋                                 | 41.7M/338M [00:00<00:05, 59.0MiB/s] 14%|█████▎                                | 47.4M/338M [00:00<00:05, 57.6MiB/s] 16%|█████▉                                | 52.9M/338M [00:00<00:05, 53.5MiB/s] 17%|██████▌                               | 58.6M/338M [00:01<00:05, 55.2MiB/s] 19%|███████▏                              | 64.3M/338M [00:01<00:05, 56.6MiB/s] 21%|███████▉                              | 70.3M/338M [00:01<00:04, 58.5MiB/s] 22%|████████▌                             | 75.9M/338M [00:01<00:04, 58.0MiB/s] 24%|█████████▏                            | 81.5M/338M [00:01<00:04, 58.0MiB/s] 26%|██████████                            | 89.0M/338M [00:01<00:04, 63.9MiB/s] 28%|██████████▊                           | 95.7M/338M [00:01<00:03, 65.9MiB/s] 30%|███████████▊                           | 102M/338M [00:01<00:04, 54.0MiB/s] 32%|████████████▍                          | 108M/338M [00:01<00:04, 54.5MiB/s] 34%|█████████████▎                         | 115M/338M [00:02<00:03, 61.4MiB/s] 36%|██████████████                         | 121M/338M [00:02<00:03, 62.5MiB/s] 38%|██████████████▊                        | 128M/338M [00:02<00:03, 64.1MiB/s] 40%|███████████████▍                       | 134M/338M [00:02<00:03, 62.3MiB/s] 42%|████████████████▏                      | 140M/338M [00:02<00:03, 55.8MiB/s] 44%|█████████████████                      | 147M/338M [00:02<00:03, 60.3MiB/s] 45%|█████████████████▋                     | 153M/338M [00:02<00:03, 60.0MiB/s] 47%|██████████████████▍                    | 160M/338M [00:02<00:02, 63.1MiB/s] 49%|███████████████████▏                   | 166M/338M [00:02<00:02, 63.1MiB/s] 51%|███████████████████▉                   | 172M/338M [00:03<00:02, 64.2MiB/s] 53%|████████████████████▋                  | 179M/338M [00:03<00:02, 56.7MiB/s] 55%|█████████████████████▍                 | 186M/338M [00:03<00:02, 62.0MiB/s] 57%|██████████████████████▏                | 192M/338M [00:03<00:02, 63.5MiB/s] 59%|██████████████████████▉                | 199M/338M [00:03<00:02, 58.3MiB/s] 61%|███████████████████████▌               | 204M/338M [00:03<00:02, 58.5MiB/s] 62%|████████████████████████▎              | 210M/338M [00:03<00:02, 57.4MiB/s] 64%|████████████████████████▉              | 216M/338M [00:03<00:02, 56.0MiB/s] 65%|█████████████████████████▌             | 221M/338M [00:03<00:02, 56.1MiB/s] 68%|██████████████████████████▎            | 228M/338M [00:04<00:01, 61.0MiB/s] 70%|███████████████████████████            | 235M/338M [00:04<00:01, 63.9MiB/s] 71%|███████████████████████████▊           | 241M/338M [00:04<00:01, 64.1MiB/s] 73%|████████████████████████████▌          | 247M/338M [00:04<00:01, 60.8MiB/s] 75%|█████████████████████████████▏         | 253M/338M [00:04<00:01, 59.1MiB/s] 77%|█████████████████████████████▉         | 259M/338M [00:04<00:01, 49.8MiB/s] 78%|██████████████████████████████▍        | 264M/338M [00:04<00:01, 43.7MiB/s] 80%|███████████████████████████████        | 269M/338M [00:04<00:01, 45.5MiB/s] 81%|███████████████████████████████▋       | 275M/338M [00:04<00:01, 49.9MiB/s] 83%|████████████████████████████████▎      | 280M/338M [00:05<00:01, 51.4MiB/s] 84%|████████████████████████████████▉      | 285M/338M [00:05<00:01, 50.8MiB/s] 86%|█████████████████████████████████▌     | 291M/338M [00:05<00:00, 54.0MiB/s] 88%|██████████████████████████████████▎    | 297M/338M [00:05<00:00, 56.0MiB/s] 90%|███████████████████████████████████    | 303M/338M [00:05<00:00, 59.5MiB/s] 92%|███████████████████████████████████▊   | 310M/338M [00:05<00:00, 61.5MiB/s] 94%|████████████████████████████████████▋  | 317M/338M [00:05<00:00, 67.1MiB/s] 96%|█████████████████████████████████████▍ | 324M/338M [00:05<00:00, 67.8MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:05<00:00, 62.0MiB/s]100%|██████████████████████████████████████▉| 337M/338M [00:06<00:00, 59.9MiB/s]100%|███████████████████████████████████████| 338M/338M [00:06<00:00, 58.4MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  108
Training mode
Epoch: [0][  0/313]	Time  5.589 ( 5.589)	Data  2.453 ( 2.453)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  90.62 ( 90.62)
Epoch: [0][ 10/313]	Time  0.396 ( 0.877)	Data  0.013 ( 0.239)	Loss 2.0801e+00 (2.0792e+00)	Acc@1  89.84 ( 89.35)
Epoch: [0][ 20/313]	Time  0.408 ( 0.652)	Data  0.013 ( 0.132)	Loss 2.0801e+00 (2.0783e+00)	Acc@1  89.06 ( 89.25)
Epoch: [0][ 30/313]	Time  0.405 ( 0.573)	Data  0.016 ( 0.095)	Loss 2.0781e+00 (2.0783e+00)	Acc@1  87.50 ( 89.59)
Epoch: [0][ 40/313]	Time  0.403 ( 0.531)	Data  0.015 ( 0.075)	Loss 2.0664e+00 (2.0774e+00)	Acc@1  92.97 ( 89.65)
Epoch: [0][ 50/313]	Time  0.411 ( 0.507)	Data  0.015 ( 0.063)	Loss 2.0742e+00 (2.0772e+00)	Acc@1  92.97 ( 89.77)
Epoch: [0][ 60/313]	Time  0.406 ( 0.490)	Data  0.015 ( 0.056)	Loss 2.0723e+00 (2.0765e+00)	Acc@1  87.50 ( 89.66)
Epoch: [0][ 70/313]	Time  0.399 ( 0.478)	Data  0.015 ( 0.050)	Loss 2.0664e+00 (2.0750e+00)	Acc@1  91.41 ( 89.83)
Epoch: [0][ 80/313]	Time  0.403 ( 0.469)	Data  0.015 ( 0.046)	Loss 2.0723e+00 (2.0744e+00)	Acc@1  87.50 ( 89.78)
Epoch: [0][ 90/313]	Time  0.405 ( 0.462)	Data  0.015 ( 0.042)	Loss 2.0723e+00 (2.0739e+00)	Acc@1  92.19 ( 89.70)
Epoch: [0][100/313]	Time  0.399 ( 0.456)	Data  0.015 ( 0.040)	Loss 2.0645e+00 (2.0737e+00)	Acc@1  90.62 ( 89.52)
Epoch: [0][110/313]	Time  0.408 ( 0.452)	Data  0.015 ( 0.037)	Loss 2.0723e+00 (2.0731e+00)	Acc@1  92.97 ( 89.56)
Epoch: [0][120/313]	Time  0.408 ( 0.448)	Data  0.016 ( 0.036)	Loss 2.0664e+00 (2.0729e+00)	Acc@1  89.06 ( 89.53)
Epoch: [0][130/313]	Time  0.412 ( 0.445)	Data  0.016 ( 0.034)	Loss 2.0566e+00 (2.0721e+00)	Acc@1  96.09 ( 89.77)
Epoch: [0][140/313]	Time  0.407 ( 0.442)	Data  0.015 ( 0.033)	Loss 2.0605e+00 (2.0720e+00)	Acc@1  89.84 ( 89.75)
Epoch: [0][150/313]	Time  0.402 ( 0.440)	Data  0.015 ( 0.032)	Loss 2.0742e+00 (2.0717e+00)	Acc@1  85.94 ( 89.77)
Epoch: [0][160/313]	Time  0.403 ( 0.438)	Data  0.015 ( 0.031)	Loss 2.0723e+00 (2.0715e+00)	Acc@1  91.41 ( 89.85)
Epoch: [0][170/313]	Time  0.404 ( 0.436)	Data  0.015 ( 0.030)	Loss 2.0723e+00 (2.0712e+00)	Acc@1  91.41 ( 89.83)
Epoch: [0][180/313]	Time  0.412 ( 0.434)	Data  0.016 ( 0.029)	Loss 2.0586e+00 (2.0709e+00)	Acc@1  91.41 ( 89.76)
Epoch: [0][190/313]	Time  0.403 ( 0.433)	Data  0.016 ( 0.028)	Loss 2.0723e+00 (2.0706e+00)	Acc@1  89.84 ( 89.78)
Epoch: [0][200/313]	Time  0.403 ( 0.432)	Data  0.015 ( 0.027)	Loss 2.0605e+00 (2.0706e+00)	Acc@1  89.06 ( 89.74)
Epoch: [0][210/313]	Time  0.402 ( 0.431)	Data  0.015 ( 0.027)	Loss 2.0547e+00 (2.0702e+00)	Acc@1  92.19 ( 89.77)
Epoch: [0][220/313]	Time  0.417 ( 0.430)	Data  0.015 ( 0.026)	Loss 2.0703e+00 (2.0701e+00)	Acc@1  89.84 ( 89.71)
Epoch: [0][230/313]	Time  0.424 ( 0.429)	Data  0.015 ( 0.026)	Loss 2.0625e+00 (2.0701e+00)	Acc@1  90.62 ( 89.65)
Epoch: [0][240/313]	Time  0.408 ( 0.428)	Data  0.016 ( 0.025)	Loss 2.0605e+00 (2.0697e+00)	Acc@1  92.19 ( 89.69)
Epoch: [0][250/313]	Time  0.409 ( 0.427)	Data  0.015 ( 0.025)	Loss 2.0820e+00 (2.0694e+00)	Acc@1  81.25 ( 89.69)
Epoch: [0][260/313]	Time  0.426 ( 0.427)	Data  0.015 ( 0.025)	Loss 2.0742e+00 (2.0691e+00)	Acc@1  85.94 ( 89.69)
Epoch: [0][270/313]	Time  0.410 ( 0.426)	Data  0.015 ( 0.024)	Loss 2.0684e+00 (2.0688e+00)	Acc@1  87.50 ( 89.68)
Epoch: [0][280/313]	Time  0.419 ( 0.425)	Data  0.019 ( 0.024)	Loss 2.0723e+00 (2.0687e+00)	Acc@1  87.50 ( 89.67)
Epoch: [0][290/313]	Time  0.411 ( 0.425)	Data  0.015 ( 0.024)	Loss 2.0605e+00 (2.0684e+00)	Acc@1  90.62 ( 89.65)
Epoch: [0][300/313]	Time  0.414 ( 0.424)	Data  0.015 ( 0.023)	Loss 2.0742e+00 (2.0683e+00)	Acc@1  84.38 ( 89.61)
Epoch: [0][310/313]	Time  0.410 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0742e+00 (2.0683e+00)	Acc@1  86.72 ( 89.59)
Validate: [ 0/79]	Time  2.738 ( 2.738)	Loss 2.0547e+00 (2.0547e+00)	Prompt Acc@1  92.19 ( 92.19)
Validate: [10/79]	Time  0.219 ( 0.549)	Loss 2.0645e+00 (2.0652e+00)	Prompt Acc@1  93.75 ( 89.91)
Validate: [20/79]	Time  0.212 ( 0.392)	Loss 2.0723e+00 (2.0641e+00)	Prompt Acc@1  85.94 ( 89.88)
Validate: [30/79]	Time  0.218 ( 0.337)	Loss 2.0742e+00 (2.0653e+00)	Prompt Acc@1  85.16 ( 89.21)
Validate: [40/79]	Time  0.216 ( 0.307)	Loss 2.0547e+00 (2.0643e+00)	Prompt Acc@1  89.84 ( 89.52)
Validate: [50/79]	Time  0.216 ( 0.289)	Loss 2.0781e+00 (2.0640e+00)	Prompt Acc@1  88.28 ( 89.38)
Validate: [60/79]	Time  0.213 ( 0.277)	Loss 2.0762e+00 (2.0645e+00)	Prompt Acc@1  85.94 ( 89.36)
Validate: [70/79]	Time  0.215 ( 0.268)	Loss 2.0762e+00 (2.0644e+00)	Prompt Acc@1  90.62 ( 89.35)
 * Prompt Acc@1 89.460
saved best file
Training mode
Epoch: [1][  0/313]	Time  2.555 ( 2.555)	Data  2.076 ( 2.076)	Loss 2.0664e+00 (2.0664e+00)	Acc@1  90.62 ( 90.62)
Epoch: [1][ 10/313]	Time  0.410 ( 0.671)	Data  0.013 ( 0.226)	Loss 2.0645e+00 (2.0636e+00)	Acc@1  90.62 ( 89.56)
Epoch: [1][ 20/313]	Time  0.403 ( 0.546)	Data  0.015 ( 0.126)	Loss 2.0664e+00 (2.0629e+00)	Acc@1  88.28 ( 89.36)
Epoch: [1][ 30/313]	Time  0.403 ( 0.502)	Data  0.015 ( 0.090)	Loss 2.0605e+00 (2.0630e+00)	Acc@1  87.50 ( 89.44)
Epoch: [1][ 40/313]	Time  0.415 ( 0.479)	Data  0.015 ( 0.072)	Loss 2.0508e+00 (2.0624e+00)	Acc@1  93.75 ( 89.63)
Epoch: [1][ 50/313]	Time  0.403 ( 0.465)	Data  0.015 ( 0.061)	Loss 2.0625e+00 (2.0628e+00)	Acc@1  94.53 ( 89.84)
Epoch: [1][ 60/313]	Time  0.410 ( 0.456)	Data  0.015 ( 0.053)	Loss 2.0625e+00 (2.0628e+00)	Acc@1  87.50 ( 89.79)
Epoch: [1][ 70/313]	Time  0.403 ( 0.449)	Data  0.015 ( 0.048)	Loss 2.0547e+00 (2.0619e+00)	Acc@1  91.41 ( 89.92)
Epoch: [1][ 80/313]	Time  0.403 ( 0.444)	Data  0.015 ( 0.044)	Loss 2.0625e+00 (2.0618e+00)	Acc@1  87.50 ( 89.90)
Epoch: [1][ 90/313]	Time  0.406 ( 0.440)	Data  0.016 ( 0.041)	Loss 2.0645e+00 (2.0619e+00)	Acc@1  93.75 ( 89.83)
Epoch: [1][100/313]	Time  0.405 ( 0.437)	Data  0.015 ( 0.038)	Loss 2.0547e+00 (2.0620e+00)	Acc@1  91.41 ( 89.67)
Epoch: [1][110/313]	Time  0.408 ( 0.434)	Data  0.015 ( 0.036)	Loss 2.0645e+00 (2.0618e+00)	Acc@1  92.97 ( 89.70)
Epoch: [1][120/313]	Time  0.407 ( 0.432)	Data  0.015 ( 0.034)	Loss 2.0586e+00 (2.0619e+00)	Acc@1  89.84 ( 89.65)
Epoch: [1][130/313]	Time  0.414 ( 0.430)	Data  0.015 ( 0.033)	Loss 2.0508e+00 (2.0614e+00)	Acc@1  95.31 ( 89.88)
Epoch: [1][140/313]	Time  0.406 ( 0.429)	Data  0.016 ( 0.032)	Loss 2.0527e+00 (2.0616e+00)	Acc@1  89.06 ( 89.85)
Epoch: [1][150/313]	Time  0.408 ( 0.428)	Data  0.015 ( 0.031)	Loss 2.0703e+00 (2.0616e+00)	Acc@1  86.72 ( 89.87)
Epoch: [1][160/313]	Time  0.407 ( 0.426)	Data  0.018 ( 0.030)	Loss 2.0684e+00 (2.0617e+00)	Acc@1  91.41 ( 89.91)
Epoch: [1][170/313]	Time  0.405 ( 0.425)	Data  0.015 ( 0.029)	Loss 2.0684e+00 (2.0616e+00)	Acc@1  90.62 ( 89.89)
Epoch: [1][180/313]	Time  0.404 ( 0.424)	Data  0.015 ( 0.028)	Loss 2.0547e+00 (2.0616e+00)	Acc@1  91.41 ( 89.79)
Epoch: [1][190/313]	Time  0.405 ( 0.423)	Data  0.015 ( 0.027)	Loss 2.0684e+00 (2.0616e+00)	Acc@1  88.28 ( 89.79)
Epoch: [1][200/313]	Time  0.405 ( 0.423)	Data  0.016 ( 0.027)	Loss 2.0566e+00 (2.0618e+00)	Acc@1  89.84 ( 89.75)
Epoch: [1][210/313]	Time  0.404 ( 0.422)	Data  0.015 ( 0.026)	Loss 2.0508e+00 (2.0616e+00)	Acc@1  92.97 ( 89.78)
Epoch: [1][220/313]	Time  0.416 ( 0.421)	Data  0.015 ( 0.026)	Loss 2.0645e+00 (2.0617e+00)	Acc@1  89.06 ( 89.73)
Epoch: [1][230/313]	Time  0.412 ( 0.421)	Data  0.015 ( 0.025)	Loss 2.0586e+00 (2.0618e+00)	Acc@1  90.62 ( 89.67)
Epoch: [1][240/313]	Time  0.407 ( 0.420)	Data  0.015 ( 0.025)	Loss 2.0566e+00 (2.0616e+00)	Acc@1  92.19 ( 89.72)
Epoch: [1][250/313]	Time  0.408 ( 0.420)	Data  0.015 ( 0.024)	Loss 2.0781e+00 (2.0615e+00)	Acc@1  82.03 ( 89.72)
Epoch: [1][260/313]	Time  0.421 ( 0.420)	Data  0.015 ( 0.024)	Loss 2.0703e+00 (2.0614e+00)	Acc@1  87.50 ( 89.73)
Epoch: [1][270/313]	Time  0.410 ( 0.419)	Data  0.016 ( 0.024)	Loss 2.0645e+00 (2.0612e+00)	Acc@1  86.72 ( 89.71)
Epoch: [1][280/313]	Time  0.408 ( 0.419)	Data  0.015 ( 0.023)	Loss 2.0684e+00 (2.0613e+00)	Acc@1  89.84 ( 89.72)
Epoch: [1][290/313]	Time  0.412 ( 0.418)	Data  0.015 ( 0.023)	Loss 2.0566e+00 (2.0612e+00)	Acc@1  91.41 ( 89.71)
Epoch: [1][300/313]	Time  0.409 ( 0.418)	Data  0.015 ( 0.023)	Loss 2.0703e+00 (2.0612e+00)	Acc@1  85.16 ( 89.67)
Epoch: [1][310/313]	Time  0.403 ( 0.418)	Data  0.015 ( 0.023)	Loss 2.0723e+00 (2.0613e+00)	Acc@1  85.94 ( 89.63)
slurmstepd: error: *** JOB 10414956 ON r31n3 CANCELLED AT 2022-11-30T22:51:09 ***
