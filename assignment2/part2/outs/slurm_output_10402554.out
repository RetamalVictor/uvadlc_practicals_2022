Matplotlib is building the font cache; this may take a moment.
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 3.22M/338M [00:00<00:10, 33.7MiB/s]  5%|█▊                                    | 16.6M/338M [00:00<00:03, 96.5MiB/s]  9%|███▎                                   | 29.1M/338M [00:00<00:02, 112MiB/s] 12%|████▊                                  | 41.3M/338M [00:00<00:02, 118MiB/s] 16%|██████▏                                | 53.8M/338M [00:00<00:02, 123MiB/s] 20%|███████▋                               | 66.3M/338M [00:00<00:02, 125MiB/s] 23%|█████████▏                             | 79.0M/338M [00:00<00:02, 128MiB/s] 27%|██████████▌                            | 91.2M/338M [00:00<00:02, 127MiB/s] 31%|████████████▎                           | 104M/338M [00:00<00:01, 128MiB/s] 34%|█████████████▊                          | 116M/338M [00:01<00:01, 130MiB/s] 38%|███████████████▎                        | 129M/338M [00:01<00:01, 130MiB/s] 42%|████████████████▊                       | 142M/338M [00:01<00:01, 132MiB/s] 46%|██████████████████▎                     | 155M/338M [00:01<00:01, 132MiB/s] 50%|███████████████████▊                    | 167M/338M [00:01<00:01, 133MiB/s] 53%|█████████████████████▎                  | 180M/338M [00:01<00:01, 131MiB/s] 57%|██████████████████████▊                 | 193M/338M [00:01<00:01, 132MiB/s] 61%|████████████████████████▍               | 206M/338M [00:01<00:01, 133MiB/s] 65%|█████████████████████████▉              | 219M/338M [00:01<00:00, 133MiB/s] 69%|███████████████████████████▍            | 231M/338M [00:01<00:00, 133MiB/s] 72%|████████████████████████████▉           | 244M/338M [00:02<00:00, 127MiB/s] 76%|██████████████████████████████▍         | 257M/338M [00:02<00:00, 129MiB/s] 80%|███████████████████████████████▉        | 270M/338M [00:02<00:00, 130MiB/s] 84%|█████████████████████████████████▍      | 283M/338M [00:02<00:00, 132MiB/s] 88%|███████████████████████████████████     | 296M/338M [00:02<00:00, 134MiB/s] 91%|████████████████████████████████████▌   | 309M/338M [00:02<00:00, 134MiB/s] 95%|██████████████████████████████████████  | 321M/338M [00:02<00:00, 133MiB/s] 99%|███████████████████████████████████████▌| 334M/338M [00:02<00:00, 131MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 128MiB/s]
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 32768/170498071 [00:00<08:53, 319525.16it/s]  0%|          | 98304/170498071 [00:00<08:23, 338124.31it/s]  0%|          | 196608/170498071 [00:00<05:11, 546396.96it/s]  0%|          | 327680/170498071 [00:00<03:34, 791631.01it/s]  0%|          | 655360/170498071 [00:00<02:15, 1249659.24it/s]  1%|          | 1277952/170498071 [00:00<01:06, 2542429.34it/s]  2%|▏         | 2588672/170498071 [00:00<00:31, 5414281.16it/s]  2%|▏         | 4259840/170498071 [00:00<00:19, 8560693.18it/s]  3%|▎         | 5898240/170498071 [00:01<00:15, 10761784.23it/s]  4%|▍         | 7667712/170498071 [00:01<00:12, 12757585.25it/s]  6%|▌         | 9404416/170498071 [00:01<00:11, 14055066.68it/s]  7%|▋         | 11239424/170498071 [00:01<00:10, 15291601.57it/s]  8%|▊         | 13107200/170498071 [00:01<00:09, 16222853.33it/s]  9%|▉         | 15040512/170498071 [00:01<00:09, 17094600.57it/s] 10%|█         | 17137664/170498071 [00:01<00:08, 18134183.16it/s] 11%|█▏        | 19333120/170498071 [00:01<00:07, 19263657.31it/s] 13%|█▎        | 21463040/170498071 [00:01<00:07, 19863450.23it/s] 14%|█▍        | 23756800/170498071 [00:01<00:07, 20770164.39it/s] 15%|█▌        | 26116096/170498071 [00:02<00:06, 21596660.76it/s] 17%|█▋        | 28540928/170498071 [00:02<00:06, 22335658.84it/s] 18%|█▊        | 30998528/170498071 [00:02<00:06, 22981611.53it/s] 20%|█▉        | 33619968/170498071 [00:02<00:05, 23939498.04it/s] 21%|██        | 36077568/170498071 [00:02<00:05, 24046930.53it/s] 23%|██▎       | 38731776/170498071 [00:02<00:05, 24783052.46it/s] 24%|██▍       | 41418752/170498071 [00:02<00:05, 25395268.49it/s] 26%|██▌       | 44400640/170498071 [00:02<00:04, 26708664.19it/s] 28%|██▊       | 47218688/170498071 [00:02<00:04, 27141831.19it/s] 29%|██▉       | 50266112/170498071 [00:03<00:04, 27782703.95it/s] 31%|███▏      | 53477376/170498071 [00:03<00:04, 28912830.25it/s] 33%|███▎      | 56688640/170498071 [00:03<00:03, 29857990.22it/s] 35%|███▌      | 59834368/170498071 [00:03<00:03, 30261084.85it/s] 37%|███▋      | 63078400/170498071 [00:03<00:03, 30889082.21it/s] 39%|███▉      | 66256896/170498071 [00:03<00:03, 31069221.91it/s] 41%|████      | 69500928/170498071 [00:03<00:03, 31466100.78it/s] 43%|████▎     | 72712192/170498071 [00:03<00:03, 31367266.71it/s] 44%|████▍     | 75857920/170498071 [00:03<00:03, 29601011.25it/s] 46%|████▋     | 79134720/170498071 [00:03<00:02, 30487074.45it/s] 48%|████▊     | 82247680/170498071 [00:04<00:03, 29322992.46it/s] 50%|█████     | 85458944/170498071 [00:04<00:02, 30111018.69it/s] 52%|█████▏    | 88670208/170498071 [00:04<00:02, 30676381.52it/s] 54%|█████▍    | 91815936/170498071 [00:04<00:02, 30591600.36it/s] 56%|█████▌    | 95092736/170498071 [00:04<00:02, 31219687.03it/s] 58%|█████▊    | 98336768/170498071 [00:04<00:02, 31569017.46it/s] 60%|█████▉    | 101515264/170498071 [00:04<00:02, 31465167.24it/s] 61%|██████▏   | 104759296/170498071 [00:04<00:02, 31223336.35it/s] 63%|██████▎   | 107937792/170498071 [00:04<00:01, 31380557.21it/s] 65%|██████▌   | 111181824/170498071 [00:04<00:01, 31693243.40it/s] 67%|██████▋   | 114360320/170498071 [00:05<00:01, 31150224.59it/s] 69%|██████▉   | 117506048/170498071 [00:05<00:01, 31069180.25it/s] 71%|███████   | 120619008/170498071 [00:05<00:01, 30805782.97it/s] 73%|███████▎  | 123830272/170498071 [00:05<00:01, 31176656.51it/s] 75%|███████▍  | 127041536/170498071 [00:05<00:01, 31428560.28it/s] 76%|███████▋  | 130351104/170498071 [00:05<00:01, 31899408.92it/s] 78%|███████▊  | 133562368/170498071 [00:05<00:01, 31840676.27it/s] 80%|████████  | 136806400/170498071 [00:05<00:01, 31779180.98it/s] 82%|████████▏ | 140017664/170498071 [00:05<00:00, 31660109.62it/s] 84%|████████▍ | 143196160/170498071 [00:05<00:00, 31585885.64it/s] 86%|████████▌ | 146374656/170498071 [00:06<00:00, 31572510.67it/s] 88%|████████▊ | 149553152/170498071 [00:06<00:00, 29850890.73it/s] 90%|████████▉ | 152666112/170498071 [00:06<00:00, 29750091.89it/s] 91%|█████████▏| 155844608/170498071 [00:06<00:00, 30324390.98it/s] 93%|█████████▎| 159088640/170498071 [00:06<00:00, 30932139.03it/s] 95%|█████████▌| 162267136/170498071 [00:06<00:00, 31174040.33it/s] 97%|█████████▋| 165511168/170498071 [00:06<00:00, 31526005.53it/s] 99%|█████████▉| 168689664/170498071 [00:06<00:00, 31431039.09it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 24841676.38it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Using prompt template: This is a photo of a {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▏                                     | 1.95M/338M [00:00<00:17, 20.2MiB/s]  4%|█▌                                    | 14.2M/338M [00:00<00:04, 83.5MiB/s]  8%|███                                    | 26.9M/338M [00:00<00:03, 106MiB/s] 12%|████▋                                  | 40.8M/338M [00:00<00:02, 122MiB/s] 16%|██████▎                                | 54.4M/338M [00:00<00:02, 129MiB/s] 20%|███████▊                               | 68.0M/338M [00:00<00:02, 134MiB/s] 24%|█████████▎                             | 80.9M/338M [00:00<00:02, 134MiB/s] 28%|██████████▉                            | 94.4M/338M [00:00<00:01, 137MiB/s] 32%|████████████▊                           | 108M/338M [00:00<00:01, 139MiB/s] 36%|██████████████▍                         | 122M/338M [00:01<00:01, 140MiB/s] 40%|████████████████                        | 135M/338M [00:01<00:01, 140MiB/s] 44%|█████████████████▋                      | 149M/338M [00:01<00:01, 141MiB/s] 48%|███████████████████▏                    | 162M/338M [00:01<00:01, 139MiB/s] 52%|████████████████████▊                   | 175M/338M [00:01<00:01, 138MiB/s] 56%|██████████████████████▎                 | 189M/338M [00:01<00:01, 135MiB/s] 60%|███████████████████████▉                | 202M/338M [00:01<00:01, 135MiB/s] 64%|█████████████████████████▍              | 215M/338M [00:01<00:00, 135MiB/s] 67%|██████████████████████████▉             | 228M/338M [00:01<00:00, 136MiB/s] 72%|████████████████████████████▋           | 243M/338M [00:01<00:00, 142MiB/s] 76%|██████████████████████████████▎         | 256M/338M [00:02<00:00, 140MiB/s] 80%|███████████████████████████████▉        | 270M/338M [00:02<00:00, 140MiB/s] 84%|█████████████████████████████████▌      | 283M/338M [00:02<00:00, 140MiB/s] 88%|███████████████████████████████████     | 296M/338M [00:02<00:00, 139MiB/s] 92%|████████████████████████████████████▋   | 310M/338M [00:02<00:00, 139MiB/s] 96%|██████████████████████████████████████▎ | 323M/338M [00:02<00:00, 140MiB/s]100%|███████████████████████████████████████▉| 337M/338M [00:02<00:00, 140MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 134MiB/s]


List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Precomputing text features
Traceback (most recent call last):
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 397, in <module>
    main()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 342, in main
    clipzs = ZeroshotCLIP(args=args, dataset=dataset, template=args.prompt_template)
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 132, in __init__
    text_features = self.precompute_text_features(clip_model, prompts, args.device)
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 168, in precompute_text_features
    with torch.no_grad:
AttributeError: __enter__
