Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:06, 350305.29it/s]  0%|          | 131072/170498071 [00:00<08:19, 341244.38it/s]  0%|          | 262144/170498071 [00:00<04:28, 634901.30it/s]  0%|          | 491520/170498071 [00:00<02:29, 1135691.17it/s]  1%|          | 983040/170498071 [00:00<01:14, 2273396.30it/s]  1%|          | 1310720/170498071 [00:00<01:05, 2572616.94it/s]  2%|▏         | 2686976/170498071 [00:00<00:28, 5927726.44it/s]  3%|▎         | 4423680/170498071 [00:00<00:17, 9354389.65it/s]  4%|▎         | 6193152/170498071 [00:01<00:13, 11830788.08it/s]  5%|▍         | 8093696/170498071 [00:01<00:11, 13959075.07it/s]  6%|▌         | 10027008/170498071 [00:01<00:10, 15529559.25it/s]  7%|▋         | 11993088/170498071 [00:01<00:09, 16753489.70it/s]  8%|▊         | 14123008/170498071 [00:01<00:08, 18083120.59it/s] 10%|▉         | 16285696/170498071 [00:01<00:08, 19128386.92it/s] 11%|█         | 18481152/170498071 [00:01<00:07, 19938180.36it/s] 12%|█▏        | 20709376/170498071 [00:01<00:07, 20570110.15it/s] 14%|█▎        | 23035904/170498071 [00:01<00:06, 21316223.34it/s] 15%|█▍        | 25395200/170498071 [00:01<00:06, 21978274.64it/s] 16%|█▋        | 27951104/170498071 [00:02<00:06, 23042173.20it/s] 18%|█▊        | 30605312/170498071 [00:02<00:05, 24083046.43it/s] 19%|█▉        | 33030144/170498071 [00:02<00:05, 24030045.75it/s] 21%|██        | 35815424/170498071 [00:02<00:05, 25155624.08it/s] 23%|██▎       | 38666240/170498071 [00:02<00:05, 26145794.84it/s] 24%|██▍       | 41615360/170498071 [00:02<00:04, 26988651.51it/s] 26%|██▌       | 44695552/170498071 [00:02<00:04, 28032301.53it/s] 28%|██▊       | 47742976/170498071 [00:02<00:04, 28594168.62it/s] 30%|██▉       | 50823168/170498071 [00:02<00:04, 28938708.47it/s] 32%|███▏      | 53903360/170498071 [00:03<00:03, 29324976.78it/s] 33%|███▎      | 57016320/170498071 [00:03<00:03, 29599417.18it/s] 35%|███▌      | 60030976/170498071 [00:03<00:03, 29693507.72it/s] 37%|███▋      | 63209472/170498071 [00:03<00:03, 30044437.93it/s] 39%|███▉      | 66420736/170498071 [00:03<00:03, 30243334.34it/s] 41%|████      | 69468160/170498071 [00:03<00:03, 30159118.99it/s] 43%|████▎     | 72515584/170498071 [00:03<00:03, 29989901.00it/s] 44%|████▍     | 75530240/170498071 [00:03<00:03, 29792060.22it/s] 46%|████▌     | 78675968/170498071 [00:03<00:03, 30142828.23it/s] 48%|████▊     | 81690624/170498071 [00:03<00:02, 30077571.39it/s] 50%|████▉     | 84770816/170498071 [00:04<00:02, 30112090.98it/s] 52%|█████▏    | 87851008/170498071 [00:04<00:02, 30108503.05it/s] 53%|█████▎    | 90963968/170498071 [00:04<00:02, 30190747.88it/s] 55%|█████▌    | 94011392/170498071 [00:04<00:02, 30174272.11it/s] 57%|█████▋    | 97058816/170498071 [00:04<00:02, 30157457.74it/s] 59%|█████▉    | 100171776/170498071 [00:04<00:02, 30279929.09it/s] 61%|██████    | 103284736/170498071 [00:04<00:02, 30079350.82it/s] 62%|██████▏   | 106332160/170498071 [00:04<00:02, 29972635.96it/s] 64%|██████▍   | 109379584/170498071 [00:04<00:02, 29962748.75it/s] 66%|██████▌   | 112394240/170498071 [00:04<00:01, 29827961.06it/s] 68%|██████▊   | 115408896/170498071 [00:05<00:01, 29887353.62it/s] 70%|██████▉   | 118554624/170498071 [00:05<00:01, 30050701.45it/s] 71%|███████▏  | 121569280/170498071 [00:05<00:01, 29993058.25it/s] 73%|███████▎  | 124583936/170498071 [00:05<00:01, 29945978.52it/s] 75%|███████▍  | 127631360/170498071 [00:05<00:01, 30053424.50it/s] 77%|███████▋  | 130646016/170498071 [00:05<00:01, 29996943.57it/s] 78%|███████▊  | 133660672/170498071 [00:05<00:01, 29830330.96it/s] 80%|████████  | 136675328/170498071 [00:05<00:01, 29850391.82it/s] 82%|████████▏ | 139722752/170498071 [00:05<00:01, 29894692.41it/s] 84%|████████▎ | 142737408/170498071 [00:05<00:00, 29575667.50it/s] 85%|████████▌ | 145719296/170498071 [00:06<00:00, 29592839.89it/s] 87%|████████▋ | 148701184/170498071 [00:06<00:00, 29159835.98it/s] 89%|████████▉ | 151912448/170498071 [00:06<00:00, 30009033.47it/s] 91%|█████████ | 155090944/170498071 [00:06<00:00, 30504083.87it/s] 93%|█████████▎| 158171136/170498071 [00:06<00:00, 30352487.98it/s] 95%|█████████▍| 161218560/170498071 [00:06<00:00, 29897995.07it/s] 96%|█████████▋| 164233216/170498071 [00:06<00:00, 29666595.68it/s] 98%|█████████▊| 167444480/170498071 [00:06<00:00, 29920168.00it/s]100%|█████████▉| 170459136/170498071 [00:06<00:00, 29969421.97it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 24744608.38it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Using prompt template: This is a photo of a {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  3%|█▎                                     | 11.3M/338M [00:00<00:02, 119MiB/s]  7%|██▋                                    | 23.6M/338M [00:00<00:02, 125MiB/s] 11%|████                                   | 35.5M/338M [00:00<00:02, 109MiB/s] 14%|█████▌                                 | 47.9M/338M [00:00<00:02, 117MiB/s] 18%|██████▊                                | 59.2M/338M [00:00<00:02, 111MiB/s] 21%|███████▊                              | 69.9M/338M [00:00<00:03, 85.4MiB/s] 23%|████████▊                             | 78.8M/338M [00:00<00:03, 83.2MiB/s] 26%|█████████▊                            | 87.4M/338M [00:00<00:03, 85.0MiB/s] 28%|██████████▊                           | 95.9M/338M [00:01<00:03, 73.6MiB/s] 31%|███████████▉                           | 103M/338M [00:01<00:03, 73.6MiB/s] 33%|████████████▉                          | 112M/338M [00:01<00:03, 78.5MiB/s] 37%|██████████████▎                        | 123M/338M [00:01<00:02, 89.2MiB/s] 39%|███████████████▎                       | 132M/338M [00:01<00:02, 87.4MiB/s] 42%|████████████████▎                      | 141M/338M [00:01<00:02, 81.2MiB/s] 44%|█████████████████▎                     | 150M/338M [00:01<00:02, 84.0MiB/s] 47%|██████████████████▎                    | 159M/338M [00:01<00:02, 85.2MiB/s] 50%|███████████████████▎                   | 168M/338M [00:01<00:02, 86.5MiB/s] 52%|████████████████████▎                  | 176M/338M [00:02<00:01, 88.2MiB/s] 55%|█████████████████████▎                 | 185M/338M [00:02<00:01, 88.7MiB/s] 57%|██████████████████████▍                | 194M/338M [00:02<00:01, 90.1MiB/s] 60%|███████████████████████▍               | 203M/338M [00:02<00:01, 91.2MiB/s] 63%|████████████████████████▍              | 212M/338M [00:02<00:01, 81.1MiB/s] 66%|█████████████████████████▋             | 223M/338M [00:02<00:01, 90.0MiB/s] 69%|██████████████████████████▋            | 231M/338M [00:02<00:01, 86.5MiB/s] 71%|███████████████████████████▋           | 240M/338M [00:02<00:01, 65.3MiB/s] 74%|████████████████████████████▋          | 249M/338M [00:03<00:01, 71.3MiB/s] 76%|█████████████████████████████▋         | 257M/338M [00:03<00:01, 76.8MiB/s] 79%|██████████████████████████████▋        | 266M/338M [00:03<00:00, 78.7MiB/s] 81%|███████████████████████████████▌       | 273M/338M [00:03<00:00, 71.0MiB/s] 83%|████████████████████████████████▌      | 282M/338M [00:03<00:00, 74.3MiB/s] 86%|█████████████████████████████████▍     | 289M/338M [00:03<00:00, 74.9MiB/s] 88%|██████████████████████████████████▏    | 296M/338M [00:03<00:00, 73.0MiB/s] 90%|███████████████████████████████████    | 304M/338M [00:03<00:00, 70.4MiB/s] 92%|███████████████████████████████████▊   | 310M/338M [00:03<00:00, 62.7MiB/s] 94%|████████████████████████████████████▋  | 317M/338M [00:04<00:00, 64.9MiB/s] 96%|█████████████████████████████████████▌ | 325M/338M [00:04<00:00, 69.4MiB/s] 99%|██████████████████████████████████████▋| 335M/338M [00:04<00:00, 78.0MiB/s]100%|███████████████████████████████████████| 338M/338M [00:04<00:00, 79.7MiB/s]


List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Precomputing text features
Iterating over test set of cifar10
Traceback (most recent call last):
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 437, in <module>
    main()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//clipzs.py", line 388, in main
    calculated_acc = accuracy(predictions,targets)
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/utils.py", line 91, in accuracy
    _, pred = output.topk(maxk, 1, True, True)
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
