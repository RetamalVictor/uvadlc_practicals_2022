Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0649/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:04, 348495.49it/s]  0%|          | 131072/169001437 [00:00<06:00, 468600.68it/s]  0%|          | 196608/169001437 [00:00<06:00, 468168.48it/s]  0%|          | 360448/169001437 [00:00<03:49, 735537.08it/s]  0%|          | 786432/169001437 [00:00<01:36, 1737699.59it/s]  1%|          | 1671168/169001437 [00:00<00:44, 3789366.71it/s]  2%|▏         | 3145728/169001437 [00:00<00:23, 6982925.70it/s]  3%|▎         | 4980736/169001437 [00:00<00:15, 10319362.46it/s]  4%|▍         | 6651904/169001437 [00:01<00:14, 10851297.34it/s]  5%|▍         | 8421376/169001437 [00:01<00:12, 12623174.74it/s]  6%|▌         | 10354688/169001437 [00:01<00:10, 14486570.90it/s]  7%|▋         | 12386304/169001437 [00:01<00:09, 16141574.28it/s]  9%|▊         | 14385152/169001437 [00:01<00:09, 15732720.31it/s] 10%|▉         | 16416768/169001437 [00:01<00:08, 16984508.20it/s] 11%|█         | 18677760/169001437 [00:01<00:08, 18559788.47it/s] 12%|█▏        | 21004288/169001437 [00:01<00:07, 19888090.68it/s] 14%|█▍        | 23363584/169001437 [00:01<00:06, 20958561.66it/s] 15%|█▌        | 25853952/169001437 [00:02<00:06, 22103142.50it/s] 17%|█▋        | 28344320/169001437 [00:02<00:06, 22923264.25it/s] 18%|█▊        | 30867456/169001437 [00:02<00:05, 23605305.00it/s] 20%|█▉        | 33390592/169001437 [00:02<00:06, 21734856.99it/s] 21%|██▏       | 35979264/169001437 [00:02<00:05, 22731132.57it/s] 23%|██▎       | 38797312/169001437 [00:02<00:05, 24156737.82it/s] 25%|██▍       | 41582592/169001437 [00:02<00:05, 25172726.60it/s] 26%|██▋       | 44466176/169001437 [00:02<00:04, 26231289.60it/s] 28%|██▊       | 47546368/169001437 [00:02<00:04, 27558473.80it/s] 30%|██▉       | 50593792/169001437 [00:03<00:04, 28416146.94it/s] 32%|███▏      | 53477376/169001437 [00:03<00:04, 26351984.61it/s] 34%|███▎      | 56688640/169001437 [00:03<00:04, 27967011.22it/s] 35%|███▌      | 59834368/169001437 [00:03<00:03, 28855685.42it/s] 37%|███▋      | 63111168/169001437 [00:03<00:03, 29967112.61it/s] 39%|███▉      | 66355200/169001437 [00:03<00:03, 30682995.14it/s] 41%|████      | 69468160/169001437 [00:03<00:03, 30737337.52it/s] 43%|████▎     | 72581120/169001437 [00:03<00:03, 30742478.23it/s] 45%|████▍     | 75890688/169001437 [00:03<00:02, 31420554.18it/s] 47%|████▋     | 79069184/169001437 [00:03<00:02, 31112369.66it/s] 49%|████▊     | 82214912/169001437 [00:04<00:02, 31065506.08it/s] 51%|█████     | 85458944/169001437 [00:04<00:02, 31471117.92it/s] 53%|█████▎    | 88735744/169001437 [00:04<00:02, 31840717.60it/s] 54%|█████▍    | 91947008/169001437 [00:04<00:02, 29375612.47it/s] 56%|█████▋    | 95223808/169001437 [00:04<00:02, 30315688.97it/s] 58%|█████▊    | 98467840/169001437 [00:04<00:02, 30765011.11it/s] 60%|██████    | 101580800/169001437 [00:04<00:02, 30779191.46it/s] 62%|██████▏   | 104792064/169001437 [00:04<00:02, 31158738.47it/s] 64%|██████▍   | 107937792/169001437 [00:04<00:01, 31117862.26it/s] 66%|██████▌   | 111149056/169001437 [00:04<00:01, 31409455.38it/s] 68%|██████▊   | 114327552/169001437 [00:05<00:01, 30935629.28it/s] 70%|██████▉   | 117538816/169001437 [00:05<00:01, 30549696.65it/s] 71%|███████▏  | 120782848/169001437 [00:05<00:01, 31080863.51it/s] 73%|███████▎  | 123928576/169001437 [00:05<00:01, 31154750.34it/s] 75%|███████▌  | 127172608/169001437 [00:05<00:01, 31529503.30it/s] 77%|███████▋  | 130351104/169001437 [00:05<00:01, 31186781.36it/s] 79%|███████▉  | 133562368/169001437 [00:05<00:01, 31456884.31it/s] 81%|████████  | 136740864/169001437 [00:05<00:01, 31423333.51it/s] 83%|████████▎ | 139886592/169001437 [00:05<00:00, 31243126.49it/s] 85%|████████▍ | 143032320/169001437 [00:05<00:00, 31096367.30it/s] 87%|████████▋ | 146210816/169001437 [00:06<00:00, 31282152.87it/s] 88%|████████▊ | 149356544/169001437 [00:06<00:00, 31251317.01it/s] 90%|█████████ | 152502272/169001437 [00:06<00:00, 31241118.46it/s] 92%|█████████▏| 155648000/169001437 [00:06<00:00, 31189415.21it/s] 94%|█████████▍| 158793728/169001437 [00:06<00:00, 31066765.48it/s] 96%|█████████▌| 161939456/169001437 [00:06<00:00, 31180047.16it/s] 98%|█████████▊| 165085184/169001437 [00:06<00:00, 30890290.56it/s]100%|█████████▉| 168230912/169001437 [00:06<00:00, 30742851.58it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24703056.23it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-100-python.tar.gz to /scratch/lcur0649
Using prompt template: The primary color is {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 2.52M/338M [00:00<00:13, 26.2MiB/s]  5%|██                                     | 18.3M/338M [00:00<00:03, 108MiB/s] 10%|███▊                                   | 32.9M/338M [00:00<00:02, 129MiB/s] 14%|█████▌                                 | 47.6M/338M [00:00<00:02, 138MiB/s] 18%|███████▏                               | 61.8M/338M [00:00<00:02, 142MiB/s] 23%|████████▉                              | 76.9M/338M [00:00<00:01, 146MiB/s] 27%|██████████▌                            | 92.0M/338M [00:00<00:01, 150MiB/s] 32%|████████████▋                           | 107M/338M [00:00<00:01, 151MiB/s] 36%|██████████████▌                         | 123M/338M [00:00<00:01, 154MiB/s] 41%|████████████████▎                       | 138M/338M [00:01<00:01, 156MiB/s] 45%|██████████████████▏                     | 154M/338M [00:01<00:01, 157MiB/s] 50%|████████████████████                    | 170M/338M [00:01<00:01, 159MiB/s] 55%|██████████████████████                  | 186M/338M [00:01<00:00, 162MiB/s] 60%|███████████████████████▉                | 202M/338M [00:01<00:00, 162MiB/s] 65%|█████████████████████████▊              | 218M/338M [00:01<00:00, 165MiB/s] 69%|███████████████████████████▋            | 234M/338M [00:01<00:00, 165MiB/s] 74%|█████████████████████████████▋          | 250M/338M [00:01<00:00, 167MiB/s] 79%|███████████████████████████████▌        | 266M/338M [00:01<00:00, 167MiB/s] 84%|█████████████████████████████████▍      | 283M/338M [00:01<00:00, 168MiB/s] 89%|███████████████████████████████████▍    | 300M/338M [00:02<00:00, 171MiB/s] 94%|█████████████████████████████████████▍  | 316M/338M [00:02<00:00, 171MiB/s] 99%|███████████████████████████████████████▍| 333M/338M [00:02<00:00, 173MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 157MiB/s]


List of prompts:
['The primary color is red',
 'The primary color is blue',
 'The primary color is green']
Precomputing text features
