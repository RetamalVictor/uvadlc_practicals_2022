Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:07, 349778.85it/s]  0%|          | 131072/170498071 [00:00<08:19, 341170.71it/s]  0%|          | 229376/170498071 [00:00<05:17, 536373.44it/s]  0%|          | 360448/170498071 [00:00<03:40, 770538.56it/s]  0%|          | 524288/170498071 [00:00<02:44, 1032464.97it/s]  0%|          | 819200/170498071 [00:00<01:45, 1601106.41it/s]  1%|          | 1638400/170498071 [00:00<00:47, 3566946.99it/s]  2%|▏         | 3309568/170498071 [00:00<00:22, 7489863.79it/s]  3%|▎         | 4915200/170498071 [00:01<00:16, 10050782.36it/s]  4%|▍         | 6717440/170498071 [00:01<00:13, 12419323.95it/s]  5%|▌         | 8781824/170498071 [00:01<00:10, 14867781.24it/s]  6%|▋         | 10944512/170498071 [00:01<00:09, 16870893.11it/s]  8%|▊         | 13139968/170498071 [00:01<00:08, 18360438.94it/s]  9%|▉         | 15499264/170498071 [00:01<00:07, 19867965.30it/s] 10%|█         | 17530880/170498071 [00:01<00:07, 19938889.86it/s] 12%|█▏        | 19824640/170498071 [00:01<00:07, 20782637.43it/s] 13%|█▎        | 22249472/170498071 [00:01<00:06, 21812571.81it/s] 15%|█▍        | 24838144/170498071 [00:01<00:06, 23013218.09it/s] 16%|█▌        | 27164672/170498071 [00:02<00:06, 23063886.33it/s] 17%|█▋        | 29786112/170498071 [00:02<00:05, 24003192.06it/s] 19%|█▉        | 32604160/170498071 [00:02<00:05, 25149438.49it/s] 21%|██        | 35520512/170498071 [00:02<00:05, 26319562.09it/s] 23%|██▎       | 38633472/170498071 [00:02<00:04, 27692747.13it/s] 25%|██▍       | 41877504/170498071 [00:02<00:04, 29078500.48it/s] 26%|██▋       | 44924928/170498071 [00:02<00:04, 29484102.62it/s] 28%|██▊       | 47874048/170498071 [00:02<00:04, 29103856.02it/s] 30%|██▉       | 50790400/170498071 [00:02<00:04, 28242479.52it/s] 31%|███▏      | 53641216/170498071 [00:03<00:04, 28148534.84it/s] 33%|███▎      | 56492032/170498071 [00:03<00:04, 27750986.17it/s] 35%|███▍      | 59277312/170498071 [00:03<00:04, 26332081.82it/s] 36%|███▋      | 61931520/170498071 [00:03<00:05, 19589790.08it/s] 38%|███▊      | 64159744/170498071 [00:03<00:06, 17557155.07it/s] 39%|███▉      | 66125824/170498071 [00:03<00:05, 17760774.78it/s] 40%|███▉      | 68059136/170498071 [00:03<00:05, 17200565.01it/s] 41%|████      | 69894144/170498071 [00:03<00:05, 17410902.75it/s] 42%|████▏     | 71729152/170498071 [00:04<00:05, 17630541.03it/s] 43%|████▎     | 73728000/170498071 [00:04<00:05, 18200367.47it/s] 44%|████▍     | 75857920/170498071 [00:04<00:04, 18993401.95it/s] 46%|████▌     | 78118912/170498071 [00:04<00:04, 20011635.98it/s] 47%|████▋     | 80543744/170498071 [00:04<00:04, 21039510.25it/s] 49%|████▉     | 83132416/170498071 [00:04<00:03, 22366238.30it/s] 50%|█████     | 85852160/170498071 [00:04<00:03, 23697720.14it/s] 52%|█████▏    | 88637440/170498071 [00:04<00:03, 24872455.79it/s] 54%|█████▎    | 91389952/170498071 [00:04<00:03, 25642429.75it/s] 55%|█████▌    | 94306304/170498071 [00:04<00:02, 26423202.67it/s] 57%|█████▋    | 97320960/170498071 [00:05<00:02, 27448487.98it/s] 59%|█████▊    | 100073472/170498071 [00:05<00:02, 23886201.21it/s] 60%|██████    | 102629376/170498071 [00:05<00:02, 24335127.27it/s] 62%|██████▏   | 105152512/170498071 [00:05<00:03, 19388363.84it/s] 63%|██████▎   | 107315200/170498071 [00:05<00:03, 19750233.24it/s] 64%|██████▍   | 109445120/170498071 [00:05<00:03, 20133264.38it/s] 65%|██████▌   | 111575040/170498071 [00:05<00:02, 20260108.20it/s] 67%|██████▋   | 113704960/170498071 [00:05<00:02, 20497580.94it/s] 68%|██████▊   | 115834880/170498071 [00:06<00:02, 20627303.99it/s] 69%|██████▉   | 117964800/170498071 [00:06<00:02, 20754227.88it/s] 70%|███████   | 120160256/170498071 [00:06<00:02, 21090189.30it/s] 72%|███████▏  | 122486784/170498071 [00:06<00:02, 21691658.18it/s] 73%|███████▎  | 124846080/170498071 [00:06<00:02, 22244515.09it/s] 75%|███████▍  | 127270912/170498071 [00:06<00:01, 22790343.59it/s] 76%|███████▌  | 129695744/170498071 [00:06<00:01, 23183091.92it/s] 77%|███████▋  | 132022272/170498071 [00:06<00:01, 23116195.37it/s] 79%|███████▉  | 134447104/170498071 [00:06<00:01, 23444245.85it/s] 80%|████████  | 136871936/170498071 [00:06<00:01, 23672851.94it/s] 82%|████████▏ | 139296768/170498071 [00:07<00:01, 23819228.16it/s] 83%|████████▎ | 141754368/170498071 [00:07<00:01, 23997331.56it/s] 85%|████████▍ | 144244736/170498071 [00:07<00:01, 24224725.69it/s] 86%|████████▌ | 146800640/170498071 [00:07<00:00, 24469763.61it/s] 88%|████████▊ | 149356544/170498071 [00:07<00:00, 24775979.13it/s] 89%|████████▉ | 151846912/170498071 [00:07<00:00, 24774998.14it/s] 91%|█████████ | 154337280/170498071 [00:07<00:00, 19550771.34it/s] 92%|█████████▏| 157188096/170498071 [00:07<00:00, 21801388.23it/s] 94%|█████████▎| 159547392/170498071 [00:07<00:00, 21603555.52it/s] 95%|█████████▍| 161841152/170498071 [00:08<00:00, 20181735.01it/s] 96%|█████████▌| 163971072/170498071 [00:08<00:00, 18197866.27it/s] 97%|█████████▋| 165904384/170498071 [00:08<00:00, 18475002.11it/s] 98%|█████████▊| 167870464/170498071 [00:08<00:00, 18776075.78it/s]100%|█████████▉| 169803776/170498071 [00:08<00:00, 18921838.34it/s]100%|██████████| 170498071/170498071 [00:08<00:00, 19908254.90it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Using prompt template: This is a photo of a {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  0%|                                       | 320k/338M [00:00<02:00, 2.93MiB/s]  2%|▋                                     | 6.47M/338M [00:00<00:09, 37.5MiB/s]  3%|█▏                                    | 10.7M/338M [00:00<00:08, 40.6MiB/s]  4%|█▋                                    | 14.9M/338M [00:00<00:08, 41.9MiB/s]  6%|██▏                                   | 19.9M/338M [00:00<00:07, 44.4MiB/s]  7%|██▊                                   | 25.1M/338M [00:00<00:06, 47.8MiB/s]  9%|███▌                                  | 31.4M/338M [00:00<00:06, 53.4MiB/s] 11%|████▏                                 | 37.1M/338M [00:00<00:05, 54.5MiB/s] 13%|████▊                                 | 42.3M/338M [00:00<00:06, 46.0MiB/s] 14%|█████▍                                | 48.1M/338M [00:01<00:06, 50.0MiB/s] 16%|██████▏                               | 54.5M/338M [00:01<00:05, 53.5MiB/s] 18%|██████▋                               | 59.9M/338M [00:01<00:05, 54.5MiB/s] 19%|███████▎                              | 65.2M/338M [00:01<00:05, 52.0MiB/s] 21%|███████▉                              | 70.5M/338M [00:01<00:05, 52.9MiB/s] 22%|████████▌                             | 75.7M/338M [00:01<00:05, 53.2MiB/s] 24%|█████████▏                            | 81.7M/338M [00:01<00:04, 56.0MiB/s] 26%|█████████▊                            | 87.1M/338M [00:01<00:04, 53.2MiB/s] 27%|██████████▍                           | 92.2M/338M [00:01<00:05, 50.7MiB/s] 29%|██████████▉                           | 97.3M/338M [00:02<00:04, 51.6MiB/s] 31%|███████████▉                           | 103M/338M [00:02<00:04, 54.9MiB/s] 32%|████████████▌                          | 109M/338M [00:02<00:04, 56.7MiB/s] 34%|█████████████▏                         | 115M/338M [00:02<00:04, 53.4MiB/s] 36%|█████████████▊                         | 120M/338M [00:02<00:04, 54.0MiB/s] 37%|██████████████▌                        | 126M/338M [00:02<00:03, 56.0MiB/s] 39%|███████████████▏                       | 131M/338M [00:02<00:03, 56.7MiB/s] 41%|███████████████▊                       | 137M/338M [00:02<00:04, 45.4MiB/s] 42%|████████████████▍                      | 142M/338M [00:02<00:04, 47.0MiB/s] 44%|█████████████████                      | 147M/338M [00:03<00:03, 50.1MiB/s] 45%|█████████████████▌                     | 152M/338M [00:03<00:04, 48.2MiB/s] 47%|██████████████████▏                    | 158M/338M [00:03<00:03, 50.6MiB/s] 48%|██████████████████▊                    | 163M/338M [00:03<00:03, 49.8MiB/s] 50%|███████████████████▍                   | 169M/338M [00:03<00:03, 52.7MiB/s] 51%|████████████████████                   | 174M/338M [00:03<00:03, 52.5MiB/s] 53%|████████████████████▊                  | 180M/338M [00:03<00:02, 56.0MiB/s] 55%|█████████████████████▍                 | 185M/338M [00:03<00:02, 54.2MiB/s] 57%|██████████████████████▏                | 192M/338M [00:03<00:02, 58.4MiB/s] 59%|██████████████████████▉                | 198M/338M [00:04<00:02, 59.3MiB/s] 60%|███████████████████████▌               | 204M/338M [00:04<00:02, 60.3MiB/s] 62%|████████████████████████▎              | 210M/338M [00:04<00:02, 60.2MiB/s] 64%|█████████████████████████              | 217M/338M [00:04<00:01, 63.4MiB/s] 66%|█████████████████████████▊             | 224M/338M [00:04<00:01, 66.5MiB/s] 68%|██████████████████████████▋            | 231M/338M [00:04<00:01, 69.4MiB/s] 70%|███████████████████████████▍           | 238M/338M [00:04<00:01, 63.9MiB/s] 72%|████████████████████████████▏          | 244M/338M [00:04<00:01, 63.9MiB/s] 74%|████████████████████████████▉          | 250M/338M [00:04<00:01, 61.1MiB/s] 76%|█████████████████████████████▌         | 256M/338M [00:05<00:01, 53.8MiB/s] 77%|██████████████████████████████▏        | 261M/338M [00:05<00:01, 54.5MiB/s] 79%|██████████████████████████████▉        | 268M/338M [00:05<00:01, 58.0MiB/s] 81%|███████████████████████████████▋       | 274M/338M [00:05<00:01, 59.4MiB/s] 83%|████████████████████████████████▎      | 280M/338M [00:05<00:01, 53.1MiB/s] 85%|████████████████████████████████▉      | 286M/338M [00:05<00:00, 55.4MiB/s] 86%|█████████████████████████████████▋     | 292M/338M [00:05<00:00, 56.5MiB/s] 88%|██████████████████████████████████▎    | 297M/338M [00:05<00:00, 55.6MiB/s] 90%|██████████████████████████████████▉    | 302M/338M [00:05<00:00, 54.8MiB/s] 91%|███████████████████████████████████▌   | 308M/338M [00:06<00:00, 47.0MiB/s] 93%|████████████████████████████████████   | 313M/338M [00:06<00:00, 48.3MiB/s] 95%|████████████████████████████████████▊  | 319M/338M [00:06<00:00, 53.6MiB/s] 96%|█████████████████████████████████████▍ | 324M/338M [00:06<00:00, 48.6MiB/s] 98%|██████████████████████████████████████▏| 331M/338M [00:06<00:00, 54.1MiB/s]100%|███████████████████████████████████████| 338M/338M [00:06<00:00, 57.6MiB/s]100%|███████████████████████████████████████| 338M/338M [00:06<00:00, 53.8MiB/s]


List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Precomputing text features
Iterating over test set of cifar10
Zero-shot CLIP top-1 accuracy on cifar10/test: 88.94
