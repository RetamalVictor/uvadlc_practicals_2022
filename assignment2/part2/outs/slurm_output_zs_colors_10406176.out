Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0649/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:06, 347140.39it/s]  0%|          | 131072/169001437 [00:00<08:18, 339036.72it/s]  0%|          | 196608/169001437 [00:00<06:29, 433441.13it/s]  0%|          | 327680/169001437 [00:00<04:04, 688762.86it/s]  0%|          | 622592/169001437 [00:00<02:05, 1344648.01it/s]  1%|          | 1245184/169001437 [00:00<01:14, 2257623.08it/s]  1%|▏         | 2424832/169001437 [00:00<00:35, 4670068.36it/s]  2%|▏         | 4063232/169001437 [00:01<00:21, 7773635.27it/s]  3%|▎         | 5701632/169001437 [00:01<00:16, 10111005.59it/s]  4%|▍         | 7405568/169001437 [00:01<00:13, 12006699.00it/s]  5%|▌         | 9273344/169001437 [00:01<00:11, 13902207.06it/s]  7%|▋         | 11042816/169001437 [00:01<00:10, 14938071.39it/s]  8%|▊         | 12943360/169001437 [00:01<00:09, 16105029.23it/s]  9%|▉         | 14942208/169001437 [00:01<00:08, 17146371.72it/s] 10%|█         | 17039360/169001437 [00:01<00:08, 18245657.05it/s] 11%|█▏        | 19169280/169001437 [00:01<00:07, 19146217.46it/s] 13%|█▎        | 21397504/169001437 [00:01<00:07, 20058269.65it/s] 14%|█▍        | 23756800/169001437 [00:02<00:06, 21091459.98it/s] 15%|█▌        | 26148864/169001437 [00:02<00:06, 21914216.63it/s] 17%|█▋        | 28540928/169001437 [00:02<00:06, 22397343.80it/s] 18%|█▊        | 31031296/169001437 [00:02<00:05, 23101863.29it/s] 20%|█▉        | 33652736/169001437 [00:02<00:05, 23894395.83it/s] 21%|██▏       | 36274176/169001437 [00:02<00:05, 24573439.77it/s] 23%|██▎       | 38895616/169001437 [00:02<00:05, 24978448.49it/s] 25%|██▍       | 41648128/169001437 [00:02<00:04, 25714233.73it/s] 26%|██▋       | 44367872/169001437 [00:02<00:04, 26021073.70it/s] 28%|██▊       | 47218688/169001437 [00:02<00:04, 26761085.86it/s] 30%|██▉       | 50036736/169001437 [00:03<00:04, 27173169.34it/s] 31%|███▏      | 53018624/169001437 [00:03<00:04, 27818978.15it/s] 33%|███▎      | 56131584/169001437 [00:03<00:03, 28785081.97it/s] 35%|███▌      | 59375616/169001437 [00:03<00:03, 29832558.49it/s] 37%|███▋      | 62554112/169001437 [00:03<00:03, 30394677.43it/s] 39%|███▉      | 65732608/169001437 [00:03<00:03, 30796448.07it/s] 41%|████      | 68812800/169001437 [00:03<00:03, 30759066.74it/s] 43%|████▎     | 71892992/169001437 [00:03<00:03, 29800016.49it/s] 44%|████▍     | 74907648/169001437 [00:03<00:03, 29850817.61it/s] 46%|████▌     | 77922304/169001437 [00:04<00:03, 29757542.87it/s] 48%|████▊     | 81035264/169001437 [00:04<00:02, 30132687.62it/s] 50%|████▉     | 84115456/169001437 [00:04<00:02, 30066765.17it/s] 52%|█████▏    | 87261184/169001437 [00:04<00:02, 30283536.95it/s] 54%|█████▎    | 90505216/169001437 [00:04<00:02, 30915260.57it/s] 55%|█████▌    | 93618176/169001437 [00:04<00:02, 30336909.55it/s] 57%|█████▋    | 96698368/169001437 [00:04<00:02, 30453558.79it/s] 59%|█████▉    | 99778560/169001437 [00:04<00:02, 28748277.42it/s] 61%|██████    | 102957056/169001437 [00:04<00:02, 29588873.01it/s] 63%|██████▎   | 105971712/169001437 [00:04<00:02, 29741167.33it/s] 64%|██████▍   | 108986368/169001437 [00:05<00:02, 29025675.69it/s] 66%|██████▋   | 111968256/169001437 [00:05<00:01, 29245371.38it/s] 68%|██████▊   | 114950144/169001437 [00:05<00:01, 29407476.59it/s] 70%|██████▉   | 117899264/169001437 [00:05<00:01, 29226496.15it/s] 72%|███████▏  | 120848384/169001437 [00:05<00:01, 28510592.87it/s] 73%|███████▎  | 123830272/169001437 [00:05<00:01, 28887235.09it/s] 75%|███████▍  | 126746624/169001437 [00:05<00:01, 28859555.46it/s] 77%|███████▋  | 129957888/169001437 [00:05<00:01, 29760307.07it/s] 79%|███████▊  | 133038080/169001437 [00:05<00:01, 29276912.43it/s] 80%|████████  | 136019968/169001437 [00:05<00:01, 29323596.74it/s] 82%|████████▏ | 139001856/169001437 [00:06<00:01, 29385780.91it/s] 84%|████████▍ | 141950976/169001437 [00:06<00:00, 29415563.18it/s] 86%|████████▌ | 144900096/169001437 [00:06<00:00, 29350758.62it/s] 87%|████████▋ | 147849216/169001437 [00:06<00:00, 29317155.16it/s] 89%|████████▉ | 150798336/169001437 [00:06<00:00, 29310095.16it/s] 91%|█████████ | 153911296/169001437 [00:06<00:00, 29746024.29it/s] 93%|█████████▎| 157057024/169001437 [00:06<00:00, 30190976.05it/s] 95%|█████████▍| 160202752/169001437 [00:06<00:00, 30529813.85it/s] 97%|█████████▋| 163414016/169001437 [00:06<00:00, 30976794.14it/s] 99%|█████████▊| 166559744/169001437 [00:06<00:00, 30871250.93it/s]100%|██████████| 169001437/169001437 [00:07<00:00, 23900163.42it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-100-python.tar.gz to /scratch/lcur0649
Using prompt template: The primary color of this photo is {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  1%|▎                                     | 2.56M/338M [00:00<00:13, 26.9MiB/s]  5%|█▊                                    | 16.0M/338M [00:00<00:03, 93.9MiB/s]  9%|███▌                                   | 31.1M/338M [00:00<00:02, 123MiB/s] 14%|█████▎                                 | 46.4M/338M [00:00<00:02, 138MiB/s] 18%|███████                                | 61.2M/338M [00:00<00:02, 144MiB/s] 23%|████████▊                              | 76.6M/338M [00:00<00:01, 150MiB/s] 27%|██████████▌                            | 91.3M/338M [00:00<00:01, 151MiB/s] 32%|████████████▌                           | 106M/338M [00:00<00:01, 153MiB/s] 36%|██████████████▎                         | 121M/338M [00:00<00:01, 153MiB/s] 41%|████████████████▍                       | 138M/338M [00:01<00:01, 162MiB/s] 46%|██████████████████▏                     | 154M/338M [00:01<00:01, 161MiB/s] 50%|████████████████████                    | 169M/338M [00:01<00:01, 161MiB/s] 55%|█████████████████████▊                  | 184M/338M [00:01<00:01, 160MiB/s] 59%|███████████████████████▋                | 200M/338M [00:01<00:00, 159MiB/s] 64%|█████████████████████████▍              | 215M/338M [00:01<00:00, 158MiB/s] 68%|███████████████████████████▎            | 230M/338M [00:01<00:00, 158MiB/s] 73%|█████████████████████████████           | 245M/338M [00:01<00:00, 157MiB/s] 77%|██████████████████████████████▊         | 260M/338M [00:01<00:00, 158MiB/s] 82%|████████████████████████████████▌       | 275M/338M [00:01<00:00, 157MiB/s] 86%|██████████████████████████████████▌     | 292M/338M [00:02<00:00, 161MiB/s] 91%|████████████████████████████████████▎   | 307M/338M [00:02<00:00, 160MiB/s] 95%|██████████████████████████████████████▏ | 322M/338M [00:02<00:00, 155MiB/s]100%|███████████████████████████████████████▉| 337M/338M [00:02<00:00, 155MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 152MiB/s]


List of prompts:
['The primary color of this photo is red',
 'The primary color of this photo is blue',
 'The primary color of this photo is green']
Precomputing text features
