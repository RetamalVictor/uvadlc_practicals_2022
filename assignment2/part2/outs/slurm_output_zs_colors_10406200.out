Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0649/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<07:48, 360660.22it/s]  0%|          | 131072/169001437 [00:00<06:04, 463435.55it/s]  0%|          | 196608/169001437 [00:00<06:49, 412694.31it/s]  0%|          | 393216/169001437 [00:00<03:23, 830154.56it/s]  0%|          | 819200/169001437 [00:00<01:33, 1807687.20it/s]  1%|          | 1638400/169001437 [00:00<00:45, 3654411.65it/s]  2%|▏         | 3309568/169001437 [00:00<00:22, 7470938.99it/s]  3%|▎         | 5177344/169001437 [00:00<00:15, 10769086.57it/s]  4%|▍         | 7143424/169001437 [00:01<00:13, 12177729.41it/s]  5%|▌         | 9043968/169001437 [00:01<00:12, 12832848.64it/s]  7%|▋         | 11141120/169001437 [00:01<00:10, 14987647.31it/s]  8%|▊         | 13271040/169001437 [00:01<00:09, 16714500.73it/s]  9%|▉         | 15663104/169001437 [00:01<00:08, 18709953.30it/s] 11%|█         | 18120704/169001437 [00:01<00:07, 20365946.11it/s] 12%|█▏        | 20578304/169001437 [00:01<00:06, 21576093.17it/s] 14%|█▎        | 22937600/169001437 [00:01<00:06, 22068356.05it/s] 15%|█▌        | 25460736/169001437 [00:01<00:06, 22995509.08it/s] 17%|█▋        | 28016640/169001437 [00:02<00:05, 23711403.34it/s] 18%|█▊        | 30670848/169001437 [00:02<00:05, 24538008.59it/s] 20%|█▉        | 33357824/169001437 [00:02<00:05, 25210134.55it/s] 21%|██▏       | 36110336/169001437 [00:02<00:05, 25892745.51it/s] 23%|██▎       | 38764544/169001437 [00:02<00:04, 26071382.11it/s] 24%|██▍       | 41385984/169001437 [00:02<00:04, 25756081.39it/s] 26%|██▌       | 43974656/169001437 [00:02<00:04, 25749011.50it/s] 28%|██▊       | 46563328/169001437 [00:02<00:04, 25750660.51it/s] 29%|██▉       | 49446912/169001437 [00:02<00:04, 26634729.91it/s] 31%|███       | 52658176/169001437 [00:02<00:04, 28253763.65it/s] 33%|███▎      | 55508992/169001437 [00:03<00:04, 27830473.00it/s] 35%|███▍      | 58458112/169001437 [00:03<00:03, 28316387.03it/s] 36%|███▋      | 61603840/169001437 [00:03<00:03, 29098524.38it/s] 38%|███▊      | 64913408/169001437 [00:03<00:03, 30266941.21it/s] 40%|████      | 67960832/169001437 [00:03<00:03, 29563071.92it/s] 42%|████▏     | 71204864/169001437 [00:03<00:03, 30391931.49it/s] 44%|████▍     | 74448896/169001437 [00:03<00:03, 30969773.50it/s] 46%|████▌     | 77725696/169001437 [00:03<00:03, 30126510.06it/s] 48%|████▊     | 80871424/169001437 [00:03<00:02, 30022671.66it/s] 50%|████▉     | 83918848/169001437 [00:04<00:02, 29952471.19it/s] 52%|█████▏    | 87064576/169001437 [00:04<00:02, 30387153.70it/s] 53%|█████▎    | 90341376/169001437 [00:04<00:02, 31063581.16it/s] 55%|█████▌    | 93618176/169001437 [00:04<00:02, 30159317.85it/s] 57%|█████▋    | 96763904/169001437 [00:04<00:02, 30248694.45it/s] 59%|█████▉    | 99942400/169001437 [00:04<00:02, 30644487.08it/s] 61%|██████    | 103219200/169001437 [00:04<00:02, 31208414.86it/s] 63%|██████▎   | 106364928/169001437 [00:04<00:02, 30939858.49it/s] 65%|██████▍   | 109477888/169001437 [00:04<00:01, 30157437.82it/s] 67%|██████▋   | 112525312/169001437 [00:04<00:01, 30132551.10it/s] 68%|██████▊   | 115572736/169001437 [00:05<00:01, 29279742.12it/s] 70%|███████   | 118521856/169001437 [00:05<00:01, 29107956.42it/s] 72%|███████▏  | 121438208/169001437 [00:05<00:01, 28897178.80it/s] 74%|███████▎  | 124354560/169001437 [00:05<00:01, 28540023.77it/s] 75%|███████▌  | 127238144/169001437 [00:05<00:01, 27966672.34it/s] 77%|███████▋  | 130056192/169001437 [00:05<00:01, 27349830.06it/s] 79%|███████▉  | 133136384/169001437 [00:05<00:01, 28260217.23it/s] 80%|████████  | 135987200/169001437 [00:05<00:01, 28254161.41it/s] 82%|████████▏ | 139132928/169001437 [00:05<00:01, 29068035.54it/s] 84%|████████▍ | 142049280/169001437 [00:06<00:00, 27507437.34it/s] 86%|████████▌ | 144834560/169001437 [00:06<00:00, 26963688.46it/s] 88%|████████▊ | 148013056/169001437 [00:06<00:00, 28309834.34it/s] 89%|████████▉ | 151126016/169001437 [00:06<00:00, 29047177.34it/s] 91%|█████████ | 154107904/169001437 [00:06<00:00, 29235235.13it/s] 93%|█████████▎| 157057024/169001437 [00:06<00:00, 29235983.33it/s] 95%|█████████▍| 160006144/169001437 [00:06<00:00, 28931481.65it/s] 96%|█████████▋| 162988032/169001437 [00:06<00:00, 29187406.03it/s] 98%|█████████▊| 165969920/169001437 [00:06<00:00, 29100181.51it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 28602010.36it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24367139.54it/s]
/home/lcur0649/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Extracting /scratch/lcur0649/cifar-100-python.tar.gz to /scratch/lcur0649
Using prompt template: The primary color of this photo is {}
Using device: cuda
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  6%|██▎                                    | 20.0M/338M [00:00<00:01, 207MiB/s] 12%|████▌                                  | 39.7M/338M [00:00<00:01, 204MiB/s] 18%|██████▊                                | 59.2M/338M [00:00<00:01, 148MiB/s] 22%|████████▌                              | 74.6M/338M [00:00<00:01, 146MiB/s] 27%|██████████▋                            | 92.8M/338M [00:00<00:01, 160MiB/s] 32%|████████████▉                           | 109M/338M [00:00<00:01, 160MiB/s] 37%|██████████████▊                         | 125M/338M [00:00<00:01, 131MiB/s] 41%|████████████████▌                       | 139M/338M [00:00<00:01, 137MiB/s] 45%|██████████████████▏                     | 153M/338M [00:01<00:01, 121MiB/s] 49%|███████████████████▋                    | 167M/338M [00:01<00:01, 126MiB/s] 54%|█████████████████████▌                  | 182M/338M [00:01<00:01, 133MiB/s] 58%|███████████████████████                 | 195M/338M [00:01<00:01, 123MiB/s] 61%|████████████████████████▌               | 207M/338M [00:01<00:01, 121MiB/s] 66%|██████████████████████████▎             | 222M/338M [00:01<00:00, 131MiB/s] 70%|███████████████████████████▉            | 235M/338M [00:01<00:01, 106MiB/s] 74%|█████████████████████████████▍          | 249M/338M [00:01<00:00, 111MiB/s] 78%|███████████████████████████████▎        | 264M/338M [00:02<00:00, 123MiB/s] 82%|████████████████████████████████▊       | 277M/338M [00:02<00:00, 121MiB/s] 88%|███████████████████████████████████     | 296M/338M [00:02<00:00, 144MiB/s] 93%|█████████████████████████████████████▏  | 314M/338M [00:02<00:00, 156MiB/s] 98%|███████████████████████████████████████ | 330M/338M [00:02<00:00, 116MiB/s]100%|████████████████████████████████████████| 338M/338M [00:02<00:00, 130MiB/s]


List of prompts:
['The primary color of this photo is red',
 'The primary color of this photo is blue',
 'The primary color of this photo is green']
Precomputing text features
