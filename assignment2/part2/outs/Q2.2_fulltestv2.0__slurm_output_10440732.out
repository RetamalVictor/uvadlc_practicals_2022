Running experiment on cifar10 with fixed_patch and prompt size 1
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:07, 349490.23it/s]  0%|          | 163840/170498071 [00:00<06:26, 441039.02it/s]  0%|          | 393216/170498071 [00:00<02:49, 1003333.95it/s]  0%|          | 851968/170498071 [00:00<01:21, 2086481.92it/s]  1%|          | 1867776/170498071 [00:00<00:37, 4519099.69it/s]  2%|▏         | 3211264/170498071 [00:00<00:23, 7199761.34it/s]  3%|▎         | 5210112/170498071 [00:00<00:14, 11040695.72it/s]  4%|▍         | 7241728/170498071 [00:00<00:11, 13824289.58it/s]  6%|▌         | 9437184/170498071 [00:01<00:09, 16253405.33it/s]  7%|▋         | 11698176/170498071 [00:01<00:08, 18153457.07it/s]  8%|▊         | 13795328/170498071 [00:01<00:08, 17558987.55it/s] 10%|▉         | 16252928/170498071 [00:01<00:07, 19537985.35it/s] 11%|█         | 18743296/170498071 [00:01<00:08, 18602730.42it/s] 12%|█▏        | 21266432/170498071 [00:01<00:07, 20303125.06it/s] 14%|█▍        | 23920640/170498071 [00:01<00:06, 22015174.57it/s] 16%|█▌        | 26771456/170498071 [00:01<00:06, 23835761.04it/s] 17%|█▋        | 29687808/170498071 [00:01<00:05, 25357855.04it/s] 19%|█▉        | 32735232/170498071 [00:02<00:05, 26826049.04it/s] 21%|██        | 35782656/170498071 [00:02<00:04, 27882682.83it/s] 23%|██▎       | 38830080/170498071 [00:02<00:04, 28644536.04it/s] 25%|██▍       | 41910272/170498071 [00:02<00:04, 29253708.89it/s] 26%|██▋       | 44924928/170498071 [00:02<00:04, 29512576.63it/s] 28%|██▊       | 47906816/170498071 [00:02<00:04, 29583421.86it/s] 30%|██▉       | 50888704/170498071 [00:02<00:04, 29629197.51it/s] 32%|███▏      | 53870592/170498071 [00:02<00:03, 29683409.90it/s] 33%|███▎      | 56852480/170498071 [00:02<00:03, 29709195.97it/s] 35%|███▌      | 59834368/170498071 [00:02<00:03, 29716522.81it/s] 37%|███▋      | 62816256/170498071 [00:03<00:03, 29715423.51it/s] 39%|███▊      | 65929216/170498071 [00:03<00:03, 30014156.26it/s] 41%|████      | 69140480/170498071 [00:03<00:03, 30632077.38it/s] 42%|████▏     | 72286208/170498071 [00:03<00:03, 30811428.56it/s] 44%|████▍     | 75431936/170498071 [00:03<00:03, 30847363.04it/s] 46%|████▌     | 78577664/170498071 [00:03<00:02, 30891137.08it/s] 48%|████▊     | 81723392/170498071 [00:03<00:02, 30638527.36it/s] 50%|████▉     | 84803584/170498071 [00:03<00:02, 30570219.75it/s] 52%|█████▏    | 87883776/170498071 [00:03<00:02, 30558153.10it/s] 53%|█████▎    | 90996736/170498071 [00:03<00:02, 30613455.60it/s] 55%|█████▌    | 94109696/170498071 [00:04<00:02, 30656188.07it/s] 57%|█████▋    | 97189888/170498071 [00:04<00:02, 30607420.62it/s] 59%|█████▉    | 100302848/170498071 [00:04<00:02, 30639621.50it/s] 61%|██████    | 103383040/170498071 [00:04<00:02, 30581236.81it/s] 63%|██████▎   | 106561536/170498071 [00:04<00:02, 30750412.82it/s] 64%|██████▍   | 109740032/170498071 [00:04<00:01, 30901666.07it/s] 66%|██████▌   | 112918528/170498071 [00:04<00:01, 30966131.75it/s] 68%|██████▊   | 116031488/170498071 [00:04<00:01, 30902848.58it/s] 70%|██████▉   | 119242752/170498071 [00:04<00:01, 31240510.40it/s] 72%|███████▏  | 122388480/170498071 [00:04<00:01, 31198428.79it/s] 74%|███████▎  | 125534208/170498071 [00:05<00:01, 31165904.34it/s] 75%|███████▌  | 128679936/170498071 [00:05<00:01, 31095567.57it/s] 77%|███████▋  | 131858432/170498071 [00:05<00:01, 31084586.58it/s] 79%|███████▉  | 135036928/170498071 [00:05<00:01, 30898626.45it/s] 81%|████████  | 138149888/170498071 [00:05<00:01, 30903283.06it/s] 83%|████████▎ | 141295616/170498071 [00:05<00:00, 30967257.07it/s] 85%|████████▍ | 144408576/170498071 [00:05<00:00, 29193897.98it/s] 86%|████████▋ | 147357696/170498071 [00:05<00:00, 29053993.88it/s] 88%|████████▊ | 150306816/170498071 [00:05<00:00, 29057806.02it/s] 90%|████████▉ | 153321472/170498071 [00:06<00:00, 29036138.34it/s] 92%|█████████▏| 156237824/170498071 [00:06<00:00, 29062739.85it/s] 93%|█████████▎| 159219712/170498071 [00:06<00:00, 29025751.17it/s] 95%|█████████▌| 162201600/170498071 [00:06<00:00, 29158594.87it/s] 97%|█████████▋| 165183488/170498071 [00:06<00:00, 29032818.11it/s] 99%|█████████▊| 168099840/170498071 [00:06<00:00, 28905059.64it/s]100%|██████████| 170498071/170498071 [00:06<00:00, 25825588.30it/s]
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  8%|███                                    | 26.4M/338M [00:00<00:01, 277MiB/s] 16%|██████                                 | 52.8M/338M [00:00<00:01, 210MiB/s] 24%|█████████▌                             | 82.3M/338M [00:00<00:01, 249MiB/s] 32%|████████████▋                           | 107M/338M [00:00<00:00, 249MiB/s] 39%|███████████████▌                        | 132M/338M [00:00<00:01, 201MiB/s] 47%|██████████████████▋                     | 158M/338M [00:00<00:00, 223MiB/s] 55%|██████████████████████                  | 187M/338M [00:00<00:00, 244MiB/s] 63%|█████████████████████████▏              | 213M/338M [00:00<00:00, 253MiB/s] 71%|████████████████████████████▍           | 241M/338M [00:01<00:00, 264MiB/s] 80%|███████████████████████████████▉        | 269M/338M [00:01<00:00, 276MiB/s] 89%|███████████████████████████████████▍    | 299M/338M [00:01<00:00, 285MiB/s] 97%|██████████████████████████████████████▊ | 328M/338M [00:01<00:00, 291MiB/s]100%|████████████████████████████████████████| 338M/338M [00:01<00:00, 259MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Validate: [ 0/79]	Time  1.949 ( 1.949)	Loss 3.5962e-01 (3.5962e-01)	Prompt Acc@1  89.84 ( 89.84)
 * Prompt Acc@1 88.940
Running experiment on cifar10 with random_patch and prompt size 1
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.random_patch'}"
Number of prompt parameters:  3
Validate: [ 0/79]	Time  1.922 ( 1.922)	Loss 3.5620e-01 (3.5620e-01)	Prompt Acc@1  90.62 ( 90.62)
 * Prompt Acc@1 89.020
Running experiment on cifar10 with padding and prompt size 30
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='padding', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
("Parameters to be updated: {'prompt_learner.pad_down', "
 "'prompt_learner.pad_right', 'prompt_learner.pad_up', "
 "'prompt_learner.pad_left'}")
Number of prompt parameters:  69840
Validate: [ 0/79]	Time  1.896 ( 1.896)	Loss 7.5000e-01 (7.5000e-01)	Prompt Acc@1  78.12 ( 78.12)
 * Prompt Acc@1 77.030
Running experiment on cifar10 with custom_patch and prompt size 30
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='custom_patch', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='custom_patch_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/custom_patch_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  192
Validate: [ 0/79]	Time  1.924 ( 1.924)	Loss 4.1895e-01 (4.1895e-01)	Prompt Acc@1  87.50 ( 87.50)
 * Prompt Acc@1 80.570
Running experiment on cifar100 with fixed_patch and prompt size 1
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0649/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:09, 345017.56it/s]  0%|          | 131072/169001437 [00:00<08:16, 339967.75it/s]  0%|          | 262144/169001437 [00:00<05:43, 490538.46it/s]  0%|          | 491520/169001437 [00:00<02:58, 942647.77it/s]  1%|          | 950272/169001437 [00:00<01:28, 1904264.29it/s]  1%|          | 1933312/169001437 [00:00<00:41, 4071933.20it/s]  2%|▏         | 3276800/169001437 [00:00<00:24, 6700376.17it/s]  3%|▎         | 5079040/169001437 [00:01<00:16, 9936624.59it/s]  4%|▍         | 6914048/169001437 [00:01<00:13, 12370336.52it/s]  5%|▌         | 8683520/169001437 [00:01<00:12, 12728916.75it/s]  6%|▌         | 10485760/169001437 [00:01<00:12, 12822833.91it/s]  7%|▋         | 12320768/169001437 [00:01<00:11, 14034261.71it/s]  8%|▊         | 14352384/169001437 [00:01<00:09, 15713465.28it/s] 10%|▉         | 16482304/169001437 [00:01<00:08, 17262529.72it/s] 11%|█         | 18776064/169001437 [00:01<00:07, 18874431.91it/s] 13%|█▎        | 21135360/169001437 [00:01<00:07, 20235244.38it/s] 14%|█▍        | 23560192/169001437 [00:02<00:06, 21400238.90it/s] 15%|█▌        | 25952256/169001437 [00:02<00:06, 22077763.23it/s] 17%|█▋        | 28475392/169001437 [00:02<00:06, 23006990.85it/s] 18%|█▊        | 31031296/169001437 [00:02<00:05, 23762442.32it/s] 20%|█▉        | 33685504/169001437 [00:02<00:05, 24534526.58it/s] 22%|██▏       | 36470784/169001437 [00:02<00:05, 25521457.68it/s] 23%|██▎       | 39288832/169001437 [00:02<00:04, 26308679.50it/s] 25%|██▍       | 42172416/169001437 [00:02<00:04, 25476297.41it/s] 27%|██▋       | 45219840/169001437 [00:02<00:04, 26905807.65it/s] 29%|██▊       | 48332800/169001437 [00:03<00:04, 24799552.27it/s] 30%|███       | 51412992/169001437 [00:03<00:04, 26111766.68it/s] 32%|███▏      | 54657024/169001437 [00:03<00:04, 27848073.48it/s] 34%|███▍      | 57802752/169001437 [00:03<00:03, 28822962.13it/s] 36%|███▌      | 61046784/169001437 [00:03<00:03, 29729556.52it/s] 38%|███▊      | 64290816/169001437 [00:03<00:03, 29775877.85it/s] 40%|███▉      | 67403776/169001437 [00:03<00:03, 30082762.93it/s] 42%|████▏     | 70549504/169001437 [00:03<00:03, 30081192.68it/s] 44%|████▎     | 73760768/169001437 [00:03<00:03, 30662820.93it/s] 45%|████▌     | 76840960/169001437 [00:03<00:03, 30672206.48it/s] 47%|████▋     | 79986688/169001437 [00:04<00:02, 30737799.05it/s] 49%|████▉     | 83099648/169001437 [00:04<00:02, 30797091.77it/s] 51%|█████     | 86278144/169001437 [00:04<00:02, 30639006.19it/s] 53%|█████▎    | 89358336/169001437 [00:04<00:02, 30591870.15it/s] 55%|█████▍    | 92504064/169001437 [00:04<00:02, 30694327.31it/s] 57%|█████▋    | 95584256/169001437 [00:04<00:02, 30639780.63it/s] 58%|█████▊    | 98729984/169001437 [00:04<00:02, 30724732.11it/s] 60%|██████    | 101810176/169001437 [00:04<00:02, 30645784.54it/s] 62%|██████▏   | 104923136/169001437 [00:04<00:02, 30684535.78it/s] 64%|██████▍   | 108003328/169001437 [00:04<00:01, 30616810.42it/s] 66%|██████▌   | 111083520/169001437 [00:05<00:01, 30570562.25it/s] 68%|██████▊   | 114196480/169001437 [00:05<00:01, 30631567.07it/s] 69%|██████▉   | 117374976/169001437 [00:05<00:01, 30799725.72it/s] 71%|███████▏  | 120553472/169001437 [00:05<00:01, 30913882.36it/s] 73%|███████▎  | 123731968/169001437 [00:05<00:01, 31005430.40it/s] 75%|███████▌  | 126910464/169001437 [00:05<00:01, 31074074.73it/s] 77%|███████▋  | 130121728/169001437 [00:05<00:01, 31372986.40it/s] 79%|███████▉  | 133267456/169001437 [00:05<00:01, 31353129.88it/s] 81%|████████  | 136413184/169001437 [00:05<00:01, 31172464.19it/s] 83%|████████▎ | 139558912/169001437 [00:05<00:00, 31143500.45it/s] 84%|████████▍ | 142704640/169001437 [00:06<00:00, 30807909.08it/s] 86%|████████▋ | 145883136/169001437 [00:06<00:00, 30928565.33it/s] 88%|████████▊ | 149127168/169001437 [00:06<00:00, 31155581.00it/s] 90%|█████████ | 152272896/169001437 [00:06<00:00, 31042411.02it/s] 92%|█████████▏| 155451392/169001437 [00:06<00:00, 31049019.67it/s] 94%|█████████▍| 158564352/169001437 [00:06<00:00, 30875104.16it/s] 96%|█████████▌| 161677312/169001437 [00:06<00:00, 30740852.24it/s] 97%|█████████▋| 164757504/169001437 [00:06<00:00, 30614636.82it/s] 99%|█████████▉| 167870464/169001437 [00:06<00:00, 30504789.58it/s]100%|██████████| 169001437/169001437 [00:06<00:00, 24416301.78it/s]
Extracting /scratch/lcur0649/cifar-100-python.tar.gz to /scratch/lcur0649
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Validate: [ 0/79]	Time  1.880 ( 1.880)	Loss 1.1387e+00 (1.1387e+00)	Prompt Acc@1  74.22 ( 74.22)
 * Prompt Acc@1 63.080
Running experiment on cifar100 with random_patch and prompt size 1
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='random_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/random_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.random_patch'}"
Number of prompt parameters:  3
Validate: [ 0/79]	Time  2.019 ( 2.019)	Loss 1.1387e+00 (1.1387e+00)	Prompt Acc@1  73.44 ( 73.44)
 * Prompt Acc@1 63.310
Running experiment on cifar100 with padding and prompt size 30
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='padding', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='padding_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/padding_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
("Parameters to be updated: {'prompt_learner.pad_left', "
 "'prompt_learner.pad_right', 'prompt_learner.pad_down', "
 "'prompt_learner.pad_up'}")
Number of prompt parameters:  69840
Validate: [ 0/79]	Time  2.136 ( 2.136)	Loss 1.7676e+00 (1.7676e+00)	Prompt Acc@1  56.25 ( 56.25)
 * Prompt Acc@1 47.410
Running experiment on cifar100 with custom_patch and prompt size 30
Namespace(print_freq=100, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=10, model='clip', arch='ViT-B/32', method='custom_patch', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='custom_patch_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=True, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/custom_patch_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  192
Validate: [ 0/79]	Time  1.914 ( 1.914)	Loss 1.6768e+00 (1.6768e+00)	Prompt Acc@1  60.16 ( 60.16)
 * Prompt Acc@1 55.350
