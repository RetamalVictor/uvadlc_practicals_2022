Running experiment on cifar10 with fixed_patch and prompt size 1
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/fixed_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /scratch/lcur0649/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:28, 335294.24it/s]  0%|          | 131072/170498071 [00:00<06:08, 462845.10it/s]  0%|          | 196608/170498071 [00:00<05:18, 533911.99it/s]  0%|          | 360448/170498071 [00:00<03:12, 883668.00it/s]  0%|          | 688128/170498071 [00:00<01:43, 1638927.81it/s]  1%|          | 1146880/170498071 [00:00<01:06, 2538288.72it/s]  1%|          | 1605632/170498071 [00:00<00:54, 3111647.63it/s]  1%|          | 2064384/170498071 [00:00<00:47, 3521474.40it/s]  1%|▏         | 2523136/170498071 [00:01<00:44, 3779875.58it/s]  2%|▏         | 3014656/170498071 [00:01<00:41, 4055314.47it/s]  2%|▏         | 3473408/170498071 [00:01<00:40, 4165295.76it/s]  2%|▏         | 3932160/170498071 [00:01<00:39, 4251315.61it/s]  3%|▎         | 4423680/170498071 [00:01<00:37, 4401839.23it/s]  3%|▎         | 4915200/170498071 [00:01<00:36, 4522888.98it/s]  3%|▎         | 5439488/170498071 [00:01<00:35, 4691979.17it/s]  3%|▎         | 5963776/170498071 [00:01<00:34, 4784166.68it/s]  4%|▍         | 6455296/170498071 [00:01<00:34, 4817047.47it/s]  4%|▍         | 6946816/170498071 [00:01<00:34, 4805407.51it/s]  4%|▍         | 7438336/170498071 [00:02<00:33, 4833852.32it/s]  5%|▍         | 7929856/170498071 [00:02<00:33, 4831779.32it/s]  5%|▍         | 8421376/170498071 [00:02<00:33, 4805215.02it/s]  5%|▌         | 8912896/170498071 [00:02<00:33, 4790458.75it/s]  6%|▌         | 9404416/170498071 [00:02<00:33, 4758256.10it/s]  6%|▌         | 9895936/170498071 [00:02<00:33, 4750994.83it/s]  6%|▌         | 10387456/170498071 [00:02<00:33, 4773027.13it/s]  6%|▋         | 10878976/170498071 [00:02<00:33, 4773033.30it/s]  7%|▋         | 11370496/170498071 [00:02<00:33, 4774967.53it/s]  7%|▋         | 11862016/170498071 [00:02<00:33, 4792339.08it/s]  7%|▋         | 12353536/170498071 [00:03<00:33, 4764894.88it/s]  8%|▊         | 12845056/170498071 [00:03<00:33, 4747547.75it/s]  8%|▊         | 13336576/170498071 [00:03<00:33, 4717415.33it/s]  8%|▊         | 13828096/170498071 [00:03<00:32, 4749413.65it/s]  8%|▊         | 14319616/170498071 [00:03<00:33, 4718801.40it/s]  9%|▊         | 14811136/170498071 [00:03<00:32, 4727772.12it/s]  9%|▉         | 15302656/170498071 [00:03<00:32, 4734489.49it/s]  9%|▉         | 15794176/170498071 [00:03<00:32, 4741341.51it/s] 10%|▉         | 16285696/170498071 [00:03<00:32, 4738080.10it/s] 10%|▉         | 16777216/170498071 [00:04<00:32, 4742090.67it/s] 10%|█         | 17268736/170498071 [00:04<00:32, 4733179.33it/s] 10%|█         | 17760256/170498071 [00:04<00:32, 4735032.26it/s] 11%|█         | 18284544/170498071 [00:04<00:31, 4802938.90it/s] 11%|█         | 18776064/170498071 [00:04<00:31, 4788580.94it/s] 11%|█▏        | 19267584/170498071 [00:04<00:31, 4794724.92it/s] 12%|█▏        | 19759104/170498071 [00:04<00:31, 4770882.32it/s] 12%|█▏        | 20250624/170498071 [00:04<00:31, 4747014.70it/s] 12%|█▏        | 20742144/170498071 [00:04<00:31, 4753119.93it/s] 12%|█▏        | 21233664/170498071 [00:04<00:31, 4737861.45it/s] 13%|█▎        | 21725184/170498071 [00:05<00:31, 4730553.80it/s] 13%|█▎        | 22216704/170498071 [00:05<00:31, 4695516.62it/s] 13%|█▎        | 22708224/170498071 [00:05<00:31, 4710215.49it/s] 14%|█▎        | 23199744/170498071 [00:05<00:31, 4739728.68it/s] 14%|█▍        | 23691264/170498071 [00:05<00:31, 4678539.76it/s] 14%|█▍        | 24182784/170498071 [00:05<00:31, 4625936.87it/s] 14%|█▍        | 24674304/170498071 [00:05<00:31, 4630055.46it/s] 15%|█▍        | 25165824/170498071 [00:05<00:31, 4676003.40it/s] 15%|█▌        | 25657344/170498071 [00:05<00:31, 4615111.55it/s] 15%|█▌        | 26148864/170498071 [00:06<00:31, 4626763.14it/s] 16%|█▌        | 26640384/170498071 [00:06<00:31, 4635930.24it/s] 16%|█▌        | 27131904/170498071 [00:06<00:30, 4652977.49it/s] 16%|█▌        | 27623424/170498071 [00:06<00:30, 4710616.88it/s] 16%|█▋        | 28114944/170498071 [00:06<00:30, 4723079.35it/s] 17%|█▋        | 28606464/170498071 [00:06<00:29, 4738289.43it/s] 17%|█▋        | 29097984/170498071 [00:06<00:29, 4734924.81it/s] 17%|█▋        | 29589504/170498071 [00:06<00:29, 4761045.66it/s] 18%|█▊        | 30081024/170498071 [00:06<00:29, 4754483.42it/s] 18%|█▊        | 30605312/170498071 [00:06<00:29, 4805586.98it/s] 18%|█▊        | 31096832/170498071 [00:07<00:28, 4820855.30it/s] 19%|█▊        | 31588352/170498071 [00:07<00:28, 4810174.19it/s] 19%|█▉        | 32112640/170498071 [00:07<00:28, 4815974.48it/s] 19%|█▉        | 32604160/170498071 [00:07<00:28, 4840417.69it/s] 19%|█▉        | 33128448/170498071 [00:07<00:28, 4859139.73it/s] 20%|█▉        | 33652736/170498071 [00:07<00:27, 4891342.20it/s] 20%|██        | 34177024/170498071 [00:07<00:27, 4934417.47it/s] 20%|██        | 34701312/170498071 [00:07<00:27, 4971864.82it/s] 21%|██        | 35225600/170498071 [00:07<00:27, 4974589.61it/s] 21%|██        | 35749888/170498071 [00:07<00:27, 4987582.18it/s] 21%|██▏       | 36274176/170498071 [00:08<00:27, 4947993.27it/s] 22%|██▏       | 36798464/170498071 [00:08<00:26, 4973470.97it/s] 22%|██▏       | 37322752/170498071 [00:08<00:26, 4954318.07it/s] 22%|██▏       | 37847040/170498071 [00:08<00:26, 4956961.26it/s] 23%|██▎       | 38371328/170498071 [00:08<00:26, 4947745.97it/s] 23%|██▎       | 38895616/170498071 [00:08<00:26, 5014337.82it/s] 23%|██▎       | 39419904/170498071 [00:08<00:26, 4940747.04it/s] 23%|██▎       | 39944192/170498071 [00:08<00:26, 4914793.98it/s] 24%|██▎       | 40468480/170498071 [00:08<00:26, 4976690.44it/s] 24%|██▍       | 40992768/170498071 [00:09<00:26, 4977591.49it/s] 24%|██▍       | 41517056/170498071 [00:09<00:25, 4967614.16it/s] 25%|██▍       | 42041344/170498071 [00:09<00:25, 4941647.42it/s] 25%|██▍       | 42565632/170498071 [00:09<00:25, 4923258.88it/s] 25%|██▌       | 43089920/170498071 [00:09<00:25, 4914709.35it/s] 26%|██▌       | 43614208/170498071 [00:09<00:25, 4883914.60it/s] 26%|██▌       | 44138496/170498071 [00:09<00:25, 4915040.07it/s] 26%|██▌       | 44662784/170498071 [00:09<00:25, 4932556.38it/s] 27%|██▋       | 45187072/170498071 [00:09<00:25, 4943171.45it/s] 27%|██▋       | 45711360/170498071 [00:10<00:25, 4965129.26it/s] 27%|██▋       | 46235648/170498071 [00:10<00:25, 4929383.45it/s] 27%|██▋       | 46759936/170498071 [00:10<00:24, 4955001.73it/s] 28%|██▊       | 47284224/170498071 [00:10<00:24, 4961154.64it/s] 28%|██▊       | 47808512/170498071 [00:10<00:25, 4890402.40it/s] 28%|██▊       | 48300032/170498071 [00:10<00:25, 4881859.25it/s] 29%|██▊       | 48791552/170498071 [00:10<00:24, 4881274.65it/s] 29%|██▉       | 49283072/170498071 [00:10<00:24, 4854482.41it/s] 29%|██▉       | 49774592/170498071 [00:10<00:24, 4850430.19it/s] 29%|██▉       | 50266112/170498071 [00:10<00:24, 4836333.59it/s] 30%|██▉       | 50757632/170498071 [00:11<00:24, 4852911.87it/s] 30%|███       | 51249152/170498071 [00:11<00:24, 4793440.39it/s] 30%|███       | 51773440/170498071 [00:11<00:24, 4855863.33it/s] 31%|███       | 52297728/170498071 [00:11<00:24, 4864661.45it/s] 31%|███       | 52822016/170498071 [00:11<00:24, 4894123.57it/s] 31%|███▏      | 53313536/170498071 [00:11<00:23, 4897925.12it/s] 32%|███▏      | 53837824/170498071 [00:11<00:23, 4954435.76it/s] 32%|███▏      | 54362112/170498071 [00:11<00:23, 4954283.93it/s] 32%|███▏      | 54886400/170498071 [00:11<00:23, 4968421.25it/s] 32%|███▏      | 55410688/170498071 [00:12<00:23, 4884204.72it/s] 33%|███▎      | 55902208/170498071 [00:12<00:23, 4891925.00it/s] 33%|███▎      | 56393728/170498071 [00:12<00:23, 4890043.25it/s] 33%|███▎      | 56918016/170498071 [00:12<00:23, 4933946.96it/s] 34%|███▎      | 57442304/170498071 [00:12<00:22, 4931492.52it/s] 34%|███▍      | 57999360/170498071 [00:12<00:22, 5042253.25it/s] 34%|███▍      | 58556416/170498071 [00:12<00:21, 5110481.80it/s] 35%|███▍      | 59113472/170498071 [00:12<00:21, 5149049.76it/s] 35%|███▌      | 59736064/170498071 [00:12<00:20, 5367471.32it/s] 35%|███▌      | 60424192/170498071 [00:12<00:19, 5777070.28it/s] 36%|███▌      | 61243392/170498071 [00:13<00:17, 6417507.69it/s] 36%|███▋      | 62062592/170498071 [00:13<00:15, 6904133.01it/s] 37%|███▋      | 62881792/170498071 [00:13<00:14, 7241593.29it/s] 37%|███▋      | 63733760/170498071 [00:13<00:14, 7529082.08it/s] 38%|███▊      | 64552960/170498071 [00:13<00:13, 7712895.03it/s] 38%|███▊      | 65404928/170498071 [00:13<00:13, 7865188.35it/s] 39%|███▉      | 66224128/170498071 [00:13<00:13, 7958450.36it/s] 39%|███▉      | 67076096/170498071 [00:13<00:12, 8091206.60it/s] 40%|███▉      | 67928064/170498071 [00:13<00:12, 8213677.35it/s] 40%|████      | 68812800/170498071 [00:13<00:12, 8321366.93it/s] 41%|████      | 69664768/170498071 [00:14<00:12, 8255048.45it/s] 41%|████▏     | 70516736/170498071 [00:14<00:12, 8226539.37it/s] 42%|████▏     | 71368704/170498071 [00:14<00:12, 8155595.98it/s] 42%|████▏     | 72187904/170498071 [00:14<00:12, 8138312.76it/s] 43%|████▎     | 73039872/170498071 [00:14<00:11, 8216271.71it/s] 43%|████▎     | 73891840/170498071 [00:14<00:11, 8232728.87it/s] 44%|████▍     | 74776576/170498071 [00:14<00:11, 8288891.92it/s] 44%|████▍     | 75628544/170498071 [00:14<00:11, 8214765.73it/s] 45%|████▍     | 76480512/170498071 [00:14<00:11, 8245670.52it/s] 45%|████▌     | 77332480/170498071 [00:14<00:11, 8231541.52it/s] 46%|████▌     | 78184448/170498071 [00:15<00:11, 8274796.60it/s] 46%|████▋     | 79036416/170498071 [00:15<00:11, 8304251.66it/s] 47%|████▋     | 79888384/170498071 [00:15<00:10, 8292175.06it/s] 47%|████▋     | 80740352/170498071 [00:15<00:10, 8330473.82it/s] 48%|████▊     | 81592320/170498071 [00:15<00:10, 8194165.27it/s] 48%|████▊     | 82444288/170498071 [00:15<00:10, 8016650.76it/s] 49%|████▉     | 83263488/170498071 [00:15<00:10, 7970162.21it/s] 49%|████▉     | 84082688/170498071 [00:15<00:10, 7962813.56it/s] 50%|████▉     | 84934656/170498071 [00:15<00:10, 8090762.35it/s] 50%|█████     | 85819392/170498071 [00:16<00:10, 8293327.80it/s] 51%|█████     | 86704128/170498071 [00:16<00:09, 8449851.79it/s] 51%|█████▏    | 87588864/170498071 [00:16<00:09, 8525709.62it/s] 52%|█████▏    | 88473600/170498071 [00:16<00:09, 8577413.80it/s] 52%|█████▏    | 89358336/170498071 [00:16<00:09, 8591127.75it/s] 53%|█████▎    | 90243072/170498071 [00:16<00:09, 8559516.28it/s] 53%|█████▎    | 91127808/170498071 [00:16<00:09, 8531134.74it/s] 54%|█████▍    | 92012544/170498071 [00:16<00:09, 8486245.04it/s] 54%|█████▍    | 92864512/170498071 [00:16<00:09, 8388477.53it/s] 55%|█████▍    | 93716480/170498071 [00:16<00:09, 8171059.78it/s] 55%|█████▌    | 94535680/170498071 [00:17<00:09, 7927369.86it/s] 56%|█████▌    | 95354880/170498071 [00:17<00:09, 7629101.52it/s] 56%|█████▋    | 96141312/170498071 [00:17<00:09, 7588854.68it/s] 57%|█████▋    | 96927744/170498071 [00:17<00:09, 7569919.03it/s] 57%|█████▋    | 97714176/170498071 [00:17<00:09, 7441632.96it/s] 58%|█████▊    | 98467840/170498071 [00:17<00:09, 7419814.78it/s] 58%|█████▊    | 99221504/170498071 [00:17<00:09, 7379909.17it/s] 59%|█████▊    | 99975168/170498071 [00:17<00:09, 7391703.11it/s] 59%|█████▉    | 100728832/170498071 [00:17<00:09, 7311538.86it/s] 60%|█████▉    | 101482496/170498071 [00:18<00:09, 7343239.01it/s] 60%|█████▉    | 102236160/170498071 [00:18<00:09, 7371603.15it/s] 60%|██████    | 102989824/170498071 [00:18<00:09, 7375849.97it/s] 61%|██████    | 103743488/170498071 [00:18<00:09, 7330971.47it/s] 61%|██████▏   | 104497152/170498071 [00:18<00:08, 7339910.85it/s] 62%|██████▏   | 105250816/170498071 [00:18<00:08, 7368857.39it/s] 62%|██████▏   | 106004480/170498071 [00:18<00:08, 7415755.80it/s] 63%|██████▎   | 106758144/170498071 [00:18<00:08, 7443517.74it/s] 63%|██████▎   | 107511808/170498071 [00:18<00:08, 7389089.27it/s] 63%|██████▎   | 108265472/170498071 [00:18<00:08, 7167632.14it/s] 64%|██████▍   | 108986368/170498071 [00:19<00:08, 7017564.80it/s] 64%|██████▍   | 109707264/170498071 [00:19<00:08, 6885601.77it/s] 65%|██████▍   | 110428160/170498071 [00:19<00:09, 6643871.73it/s] 65%|██████▌   | 111116288/170498071 [00:19<00:09, 6488862.10it/s] 66%|██████▌   | 111771648/170498071 [00:19<00:09, 6361167.08it/s] 66%|██████▌   | 112427008/170498071 [00:19<00:09, 6260843.83it/s] 66%|██████▋   | 113082368/170498071 [00:19<00:09, 6185306.09it/s] 67%|██████▋   | 113704960/170498071 [00:19<00:09, 6115185.11it/s] 67%|██████▋   | 114327552/170498071 [00:19<00:09, 6064217.36it/s] 67%|██████▋   | 114950144/170498071 [00:20<00:09, 5997457.19it/s] 68%|██████▊   | 115572736/170498071 [00:20<00:09, 5977016.00it/s] 68%|██████▊   | 116195328/170498071 [00:20<00:09, 5947163.10it/s] 69%|██████▊   | 116817920/170498071 [00:20<00:09, 5926279.33it/s] 69%|██████▉   | 117440512/170498071 [00:20<00:08, 5901786.42it/s] 69%|██████▉   | 118063104/170498071 [00:20<00:08, 5891349.97it/s] 70%|██████▉   | 118652928/170498071 [00:20<00:08, 5875736.35it/s] 70%|██████▉   | 119242752/170498071 [00:20<00:08, 5836332.12it/s] 70%|███████   | 119865344/170498071 [00:20<00:08, 5876083.28it/s] 71%|███████   | 120455168/170498071 [00:20<00:08, 5864242.65it/s] 71%|███████   | 121044992/170498071 [00:21<00:08, 5808453.08it/s] 71%|███████▏  | 121667584/170498071 [00:21<00:08, 5847099.39it/s] 72%|███████▏  | 122257408/170498071 [00:21<00:08, 5833749.53it/s] 72%|███████▏  | 122880000/170498071 [00:21<00:08, 5828472.69it/s] 72%|███████▏  | 123502592/170498071 [00:21<00:08, 5873423.44it/s] 73%|███████▎  | 124125184/170498071 [00:21<00:07, 5879798.91it/s] 73%|███████▎  | 124715008/170498071 [00:21<00:07, 5866209.35it/s] 73%|███████▎  | 125304832/170498071 [00:21<00:07, 5829882.60it/s] 74%|███████▍  | 125927424/170498071 [00:21<00:07, 5853329.59it/s] 74%|███████▍  | 126517248/170498071 [00:22<00:07, 5820028.50it/s] 75%|███████▍  | 127107072/170498071 [00:22<00:07, 5788675.49it/s] 75%|███████▍  | 127696896/170498071 [00:22<00:07, 5765063.47it/s] 75%|███████▌  | 128319488/170498071 [00:22<00:07, 5861300.30it/s] 76%|███████▌  | 128909312/170498071 [00:22<00:07, 5863557.44it/s] 76%|███████▌  | 129499136/170498071 [00:22<00:07, 5819167.27it/s] 76%|███████▋  | 130088960/170498071 [00:22<00:06, 5808410.34it/s] 77%|███████▋  | 130744320/170498071 [00:22<00:06, 5989528.06it/s] 77%|███████▋  | 131399680/170498071 [00:22<00:06, 6062160.83it/s] 77%|███████▋  | 132022272/170498071 [00:22<00:06, 6073506.90it/s] 78%|███████▊  | 132644864/170498071 [00:23<00:06, 5991419.62it/s] 78%|███████▊  | 133300224/170498071 [00:23<00:06, 6093652.81it/s] 79%|███████▊  | 133955584/170498071 [00:23<00:05, 6214521.10it/s] 79%|███████▉  | 134610944/170498071 [00:23<00:05, 6235488.03it/s] 79%|███████▉  | 135266304/170498071 [00:23<00:05, 6260507.82it/s] 80%|███████▉  | 135921664/170498071 [00:23<00:05, 6239494.05it/s] 80%|████████  | 136577024/170498071 [00:23<00:05, 6260248.86it/s] 80%|████████  | 137232384/170498071 [00:23<00:05, 6206503.69it/s] 81%|████████  | 137887744/170498071 [00:23<00:05, 6206305.06it/s] 81%|████████  | 138510336/170498071 [00:23<00:05, 6133343.88it/s] 82%|████████▏ | 139132928/170498071 [00:24<00:05, 6062057.54it/s] 82%|████████▏ | 139755520/170498071 [00:24<00:05, 6016427.07it/s] 82%|████████▏ | 140378112/170498071 [00:24<00:05, 5997513.69it/s] 83%|████████▎ | 141000704/170498071 [00:24<00:04, 5941008.42it/s] 83%|████████▎ | 141623296/170498071 [00:24<00:04, 5861885.64it/s] 83%|████████▎ | 142213120/170498071 [00:24<00:04, 5808280.09it/s] 84%|████████▍ | 142802944/170498071 [00:24<00:04, 5744537.76it/s] 84%|████████▍ | 143392768/170498071 [00:24<00:04, 5713260.04it/s] 84%|████████▍ | 143982592/170498071 [00:24<00:04, 5744254.36it/s] 85%|████████▍ | 144572416/170498071 [00:25<00:04, 5762390.13it/s] 85%|████████▌ | 145162240/170498071 [00:25<00:04, 5743299.32it/s] 86%|████████▌ | 145784832/170498071 [00:25<00:04, 5806311.57it/s] 86%|████████▌ | 146407424/170498071 [00:25<00:04, 5864105.68it/s] 86%|████████▌ | 146997248/170498071 [00:25<00:04, 5867345.62it/s] 87%|████████▋ | 147587072/170498071 [00:25<00:03, 5855956.79it/s] 87%|████████▋ | 148176896/170498071 [00:25<00:03, 5794434.37it/s] 87%|████████▋ | 148766720/170498071 [00:25<00:03, 5752138.54it/s] 88%|████████▊ | 149356544/170498071 [00:25<00:03, 5705159.72it/s] 88%|████████▊ | 149946368/170498071 [00:25<00:03, 5652162.35it/s] 88%|████████▊ | 150536192/170498071 [00:26<00:03, 5674327.81it/s] 89%|████████▊ | 151126016/170498071 [00:26<00:03, 5671072.89it/s] 89%|████████▉ | 151715840/170498071 [00:26<00:03, 5622304.01it/s] 89%|████████▉ | 152305664/170498071 [00:26<00:03, 5635557.75it/s] 90%|████████▉ | 152895488/170498071 [00:26<00:03, 5634679.23it/s] 90%|█████████ | 153485312/170498071 [00:26<00:03, 5614352.80it/s] 90%|█████████ | 154075136/170498071 [00:26<00:02, 5594615.83it/s] 91%|█████████ | 154664960/170498071 [00:26<00:02, 5619468.47it/s] 91%|█████████ | 155254784/170498071 [00:26<00:02, 5632268.83it/s] 91%|█████████▏| 155844608/170498071 [00:27<00:02, 5628075.68it/s] 92%|█████████▏| 156434432/170498071 [00:27<00:02, 5598820.38it/s] 92%|█████████▏| 157024256/170498071 [00:27<00:02, 5606944.24it/s] 92%|█████████▏| 157614080/170498071 [00:27<00:02, 5626680.34it/s] 93%|█████████▎| 158203904/170498071 [00:27<00:02, 5591612.21it/s] 93%|█████████▎| 158793728/170498071 [00:27<00:02, 5588250.26it/s] 93%|█████████▎| 159383552/170498071 [00:27<00:01, 5611839.31it/s] 94%|█████████▍| 159973376/170498071 [00:27<00:01, 5610717.01it/s] 94%|█████████▍| 160563200/170498071 [00:27<00:01, 5594927.74it/s] 95%|█████████▍| 161153024/170498071 [00:27<00:01, 5605948.55it/s] 95%|█████████▍| 161742848/170498071 [00:28<00:01, 5616988.91it/s] 95%|█████████▌| 162332672/170498071 [00:28<00:01, 5611350.88it/s] 96%|█████████▌| 162922496/170498071 [00:28<00:01, 5590411.10it/s] 96%|█████████▌| 163512320/170498071 [00:28<00:01, 5616312.39it/s] 96%|█████████▌| 164102144/170498071 [00:28<00:01, 5628398.70it/s] 97%|█████████▋| 164691968/170498071 [00:28<00:01, 5597343.20it/s] 97%|█████████▋| 165281792/170498071 [00:28<00:00, 5587053.73it/s] 97%|█████████▋| 165871616/170498071 [00:28<00:00, 5594284.46it/s] 98%|█████████▊| 166461440/170498071 [00:28<00:00, 5604605.02it/s] 98%|█████████▊| 167051264/170498071 [00:29<00:00, 5569658.48it/s] 98%|█████████▊| 167608320/170498071 [00:29<00:00, 5535852.96it/s] 99%|█████████▊| 168165376/170498071 [00:29<00:00, 5480019.91it/s] 99%|█████████▉| 168722432/170498071 [00:29<00:00, 5363040.71it/s] 99%|█████████▉| 169279488/170498071 [00:29<00:00, 5258191.73it/s]100%|█████████▉| 169836544/170498071 [00:29<00:00, 5185491.88it/s]100%|█████████▉| 170360832/170498071 [00:29<00:00, 5129284.45it/s]100%|██████████| 170498071/170498071 [00:29<00:00, 5740663.06it/s]
Extracting /scratch/lcur0649/cifar-10-python.tar.gz to /scratch/lcur0649
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
  0%|                                               | 0.00/338M [00:00<?, ?iB/s]  3%|█▎                                     | 11.6M/338M [00:00<00:02, 122MiB/s]  7%|██▋                                    | 23.3M/338M [00:00<00:03, 105MiB/s] 10%|███▊                                   | 33.4M/338M [00:00<00:03, 103MiB/s] 14%|█████▍                                 | 46.6M/338M [00:00<00:02, 116MiB/s] 17%|██████▋                                | 57.8M/338M [00:00<00:02, 103MiB/s] 20%|███████▋                              | 67.9M/338M [00:00<00:03, 87.1MiB/s] 23%|████████▊                             | 78.0M/338M [00:00<00:02, 92.1MiB/s] 26%|█████████▊                            | 87.2M/338M [00:00<00:02, 90.0MiB/s] 29%|██████████▉                           | 96.6M/338M [00:01<00:02, 92.4MiB/s] 31%|████████████▏                          | 106M/338M [00:01<00:02, 93.9MiB/s] 34%|█████████████▎                         | 115M/338M [00:01<00:02, 85.6MiB/s] 37%|██████████████▍                        | 125M/338M [00:01<00:02, 90.7MiB/s] 40%|███████████████▌                       | 134M/338M [00:01<00:02, 92.5MiB/s] 43%|████████████████▊                      | 145M/338M [00:01<00:02, 97.9MiB/s] 46%|█████████████████▊                     | 154M/338M [00:01<00:01, 98.1MiB/s] 49%|██████████████████▉                    | 164M/338M [00:01<00:01, 96.0MiB/s] 51%|████████████████████                   | 173M/338M [00:01<00:01, 95.7MiB/s] 56%|██████████████████████▎                 | 188M/338M [00:01<00:01, 114MiB/s] 59%|███████████████████████▌                | 199M/338M [00:02<00:01, 108MiB/s] 62%|████████████████████████▊               | 210M/338M [00:02<00:01, 106MiB/s] 66%|██████████████████████████▎             | 222M/338M [00:02<00:01, 114MiB/s] 69%|███████████████████████████▌            | 233M/338M [00:02<00:01, 109MiB/s] 72%|████████████████████████████▊           | 244M/338M [00:02<00:00, 107MiB/s] 75%|██████████████████████████████          | 254M/338M [00:02<00:00, 106MiB/s] 79%|███████████████████████████████▌        | 266M/338M [00:02<00:00, 113MiB/s] 82%|████████████████████████████████▊       | 277M/338M [00:02<00:00, 111MiB/s] 85%|██████████████████████████████████      | 288M/338M [00:02<00:00, 109MiB/s] 88%|███████████████████████████████████▎    | 298M/338M [00:03<00:00, 103MiB/s] 91%|███████████████████████████████████▌   | 308M/338M [00:03<00:00, 98.3MiB/s] 94%|█████████████████████████████████████▋  | 318M/338M [00:03<00:00, 100MiB/s] 97%|██████████████████████████████████████▊ | 328M/338M [00:03<00:00, 100MiB/s]100%|████████████████████████████████████████| 338M/338M [00:03<00:00, 101MiB/s]
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Training mode
Epoch: [0][  0/313]	Time  2.796 ( 2.796)	Data  0.707 ( 0.707)	Loss 2.0840e+00 (2.0840e+00)	Acc@1  92.97 ( 92.97)
Epoch: [0][ 25/313]	Time  0.414 ( 0.496)	Data  0.026 ( 0.043)	Loss 2.0820e+00 (2.0876e+00)	Acc@1  89.84 ( 88.40)
Epoch: [0][ 50/313]	Time  0.399 ( 0.452)	Data  0.015 ( 0.030)	Loss 2.0820e+00 (2.0889e+00)	Acc@1  85.94 ( 87.94)
Epoch: [0][ 75/313]	Time  0.404 ( 0.437)	Data  0.016 ( 0.026)	Loss 2.0762e+00 (2.0881e+00)	Acc@1  93.75 ( 88.35)
Epoch: [0][100/313]	Time  0.404 ( 0.429)	Data  0.016 ( 0.023)	Loss 2.0879e+00 (2.0879e+00)	Acc@1  89.06 ( 88.58)
Epoch: [0][125/313]	Time  0.416 ( 0.425)	Data  0.017 ( 0.022)	Loss 2.0898e+00 (2.0877e+00)	Acc@1  87.50 ( 88.60)
Epoch: [0][150/313]	Time  0.402 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0840e+00 (2.0880e+00)	Acc@1  93.75 ( 88.67)
Epoch: [0][175/313]	Time  0.403 ( 0.421)	Data  0.015 ( 0.020)	Loss 2.0781e+00 (2.0880e+00)	Acc@1  89.84 ( 88.62)
Epoch: [0][200/313]	Time  0.406 ( 0.419)	Data  0.016 ( 0.020)	Loss 2.0918e+00 (2.0880e+00)	Acc@1  86.72 ( 88.60)
Epoch: [0][225/313]	Time  0.420 ( 0.418)	Data  0.015 ( 0.019)	Loss 2.0879e+00 (2.0878e+00)	Acc@1  89.06 ( 88.61)
Epoch: [0][250/313]	Time  0.406 ( 0.417)	Data  0.015 ( 0.019)	Loss 2.0859e+00 (2.0876e+00)	Acc@1  89.84 ( 88.60)
Epoch: [0][275/313]	Time  0.410 ( 0.417)	Data  0.017 ( 0.019)	Loss 2.0820e+00 (2.0875e+00)	Acc@1  89.84 ( 88.63)
Epoch: [0][300/313]	Time  0.409 ( 0.416)	Data  0.015 ( 0.019)	Loss 2.0801e+00 (2.0875e+00)	Acc@1  90.62 ( 88.63)
Validate: [ 0/79]	Time  0.931 ( 0.931)	Loss 2.0957e+00 (2.0957e+00)	Prompt Acc@1  82.81 ( 82.81)
Validate: [25/79]	Time  0.218 ( 0.252)	Loss 2.0762e+00 (2.0887e+00)	Prompt Acc@1  91.41 ( 88.64)
Validate: [50/79]	Time  0.217 ( 0.236)	Loss 2.0859e+00 (2.0880e+00)	Prompt Acc@1  87.50 ( 88.99)
Validate: [75/79]	Time  0.218 ( 0.229)	Loss 2.0898e+00 (2.0876e+00)	Prompt Acc@1  86.72 ( 89.07)
 * Prompt Acc@1 89.060
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.132 ( 1.132)	Data  0.704 ( 0.704)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  92.97 ( 92.97)
Epoch: [1][ 25/313]	Time  0.409 ( 0.441)	Data  0.016 ( 0.043)	Loss 2.0801e+00 (2.0871e+00)	Acc@1  89.84 ( 88.37)
Epoch: [1][ 50/313]	Time  0.407 ( 0.427)	Data  0.016 ( 0.030)	Loss 2.0820e+00 (2.0887e+00)	Acc@1  85.16 ( 87.94)
Epoch: [1][ 75/313]	Time  0.407 ( 0.422)	Data  0.016 ( 0.025)	Loss 2.0742e+00 (2.0878e+00)	Acc@1  93.75 ( 88.40)
Epoch: [1][100/313]	Time  0.416 ( 0.420)	Data  0.016 ( 0.023)	Loss 2.0879e+00 (2.0876e+00)	Acc@1  89.06 ( 88.58)
Epoch: [1][125/313]	Time  0.411 ( 0.419)	Data  0.015 ( 0.021)	Loss 2.0879e+00 (2.0874e+00)	Acc@1  87.50 ( 88.62)
Epoch: [1][150/313]	Time  0.415 ( 0.418)	Data  0.015 ( 0.020)	Loss 2.0840e+00 (2.0876e+00)	Acc@1  92.97 ( 88.68)
Epoch: [1][175/313]	Time  0.413 ( 0.418)	Data  0.016 ( 0.020)	Loss 2.0781e+00 (2.0877e+00)	Acc@1  89.06 ( 88.64)
Epoch: [1][200/313]	Time  0.412 ( 0.418)	Data  0.015 ( 0.020)	Loss 2.0918e+00 (2.0878e+00)	Acc@1  87.50 ( 88.62)
Epoch: [1][225/313]	Time  0.414 ( 0.417)	Data  0.017 ( 0.019)	Loss 2.0879e+00 (2.0876e+00)	Acc@1  89.06 ( 88.64)
Epoch: [1][250/313]	Time  0.417 ( 0.417)	Data  0.016 ( 0.019)	Loss 2.0859e+00 (2.0874e+00)	Acc@1  89.84 ( 88.64)
Epoch: [1][275/313]	Time  0.424 ( 0.417)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0873e+00)	Acc@1  89.84 ( 88.66)
Epoch: [1][300/313]	Time  0.409 ( 0.417)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0872e+00)	Acc@1  90.62 ( 88.66)
Validate: [ 0/79]	Time  1.010 ( 1.010)	Loss 2.0957e+00 (2.0957e+00)	Prompt Acc@1  82.81 ( 82.81)
Validate: [25/79]	Time  0.217 ( 0.262)	Loss 2.0762e+00 (2.0885e+00)	Prompt Acc@1  91.41 ( 88.67)
Validate: [50/79]	Time  0.218 ( 0.242)	Loss 2.0840e+00 (2.0877e+00)	Prompt Acc@1  87.50 ( 89.05)
Validate: [75/79]	Time  0.218 ( 0.235)	Loss 2.0898e+00 (2.0872e+00)	Prompt Acc@1  87.50 ( 89.11)
 * Prompt Acc@1 89.110
saved best file
Training mode
Epoch: [2][  0/313]	Time  1.121 ( 1.121)	Data  0.717 ( 0.717)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  92.97 ( 92.97)
Epoch: [2][ 25/313]	Time  0.417 ( 0.445)	Data  0.016 ( 0.044)	Loss 2.0801e+00 (2.0871e+00)	Acc@1  89.84 ( 88.43)
Epoch: [2][ 50/313]	Time  0.411 ( 0.430)	Data  0.016 ( 0.031)	Loss 2.0820e+00 (2.0885e+00)	Acc@1  84.38 ( 87.96)
Epoch: [2][ 75/313]	Time  0.412 ( 0.426)	Data  0.017 ( 0.026)	Loss 2.0742e+00 (2.0877e+00)	Acc@1  93.75 ( 88.45)
Epoch: [2][100/313]	Time  0.414 ( 0.423)	Data  0.017 ( 0.024)	Loss 2.0879e+00 (2.0874e+00)	Acc@1  89.06 ( 88.62)
Epoch: [2][125/313]	Time  0.413 ( 0.422)	Data  0.017 ( 0.023)	Loss 2.0879e+00 (2.0872e+00)	Acc@1  87.50 ( 88.62)
Epoch: [2][150/313]	Time  0.411 ( 0.421)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0875e+00)	Acc@1  92.97 ( 88.67)
Epoch: [2][175/313]	Time  0.412 ( 0.420)	Data  0.016 ( 0.021)	Loss 2.0781e+00 (2.0875e+00)	Acc@1  89.06 ( 88.67)
Epoch: [2][200/313]	Time  0.419 ( 0.420)	Data  0.015 ( 0.020)	Loss 2.0918e+00 (2.0876e+00)	Acc@1  86.72 ( 88.65)
Epoch: [2][225/313]	Time  0.414 ( 0.419)	Data  0.015 ( 0.020)	Loss 2.0859e+00 (2.0874e+00)	Acc@1  89.06 ( 88.66)
Epoch: [2][250/313]	Time  0.408 ( 0.419)	Data  0.015 ( 0.019)	Loss 2.0859e+00 (2.0872e+00)	Acc@1  89.84 ( 88.65)
Epoch: [2][275/313]	Time  0.417 ( 0.419)	Data  0.017 ( 0.019)	Loss 2.0820e+00 (2.0871e+00)	Acc@1  90.62 ( 88.69)
Epoch: [2][300/313]	Time  0.412 ( 0.419)	Data  0.017 ( 0.019)	Loss 2.0801e+00 (2.0871e+00)	Acc@1  90.62 ( 88.68)
Validate: [ 0/79]	Time  0.942 ( 0.942)	Loss 2.0957e+00 (2.0957e+00)	Prompt Acc@1  82.81 ( 82.81)
Validate: [25/79]	Time  0.223 ( 0.252)	Loss 2.0742e+00 (2.0884e+00)	Prompt Acc@1  92.19 ( 88.73)
Validate: [50/79]	Time  0.218 ( 0.237)	Loss 2.0840e+00 (2.0877e+00)	Prompt Acc@1  87.50 ( 89.05)
Validate: [75/79]	Time  0.217 ( 0.231)	Loss 2.0879e+00 (2.0872e+00)	Prompt Acc@1  86.72 ( 89.12)
 * Prompt Acc@1 89.110
There's no improvement for 1 epochs.
Training mode
Epoch: [3][  0/313]	Time  1.161 ( 1.161)	Data  0.746 ( 0.746)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  92.97 ( 92.97)
Epoch: [3][ 25/313]	Time  0.416 ( 0.447)	Data  0.017 ( 0.047)	Loss 2.0801e+00 (2.0871e+00)	Acc@1  89.84 ( 88.40)
Epoch: [3][ 50/313]	Time  0.412 ( 0.432)	Data  0.017 ( 0.032)	Loss 2.0820e+00 (2.0884e+00)	Acc@1  85.16 ( 88.02)
Epoch: [3][ 75/313]	Time  0.423 ( 0.428)	Data  0.017 ( 0.027)	Loss 2.0742e+00 (2.0876e+00)	Acc@1  93.75 ( 88.47)
Epoch: [3][100/313]	Time  0.416 ( 0.426)	Data  0.017 ( 0.025)	Loss 2.0879e+00 (2.0873e+00)	Acc@1  89.06 ( 88.64)
Epoch: [3][125/313]	Time  0.424 ( 0.425)	Data  0.017 ( 0.023)	Loss 2.0879e+00 (2.0871e+00)	Acc@1  87.50 ( 88.65)
Epoch: [3][150/313]	Time  0.417 ( 0.424)	Data  0.017 ( 0.022)	Loss 2.0840e+00 (2.0874e+00)	Acc@1  92.97 ( 88.72)
Epoch: [3][175/313]	Time  0.415 ( 0.424)	Data  0.017 ( 0.022)	Loss 2.0781e+00 (2.0875e+00)	Acc@1  89.06 ( 88.73)
Epoch: [3][200/313]	Time  0.424 ( 0.423)	Data  0.017 ( 0.021)	Loss 2.0918e+00 (2.0875e+00)	Acc@1  86.72 ( 88.69)
Epoch: [3][225/313]	Time  0.415 ( 0.423)	Data  0.017 ( 0.021)	Loss 2.0859e+00 (2.0873e+00)	Acc@1  89.06 ( 88.71)
Epoch: [3][250/313]	Time  0.421 ( 0.423)	Data  0.017 ( 0.020)	Loss 2.0859e+00 (2.0871e+00)	Acc@1  89.84 ( 88.69)
Epoch: [3][275/313]	Time  0.418 ( 0.422)	Data  0.017 ( 0.020)	Loss 2.0820e+00 (2.0870e+00)	Acc@1  89.84 ( 88.71)
Epoch: [3][300/313]	Time  0.421 ( 0.422)	Data  0.017 ( 0.020)	Loss 2.0801e+00 (2.0870e+00)	Acc@1  90.62 ( 88.72)
Validate: [ 0/79]	Time  0.952 ( 0.952)	Loss 2.0957e+00 (2.0957e+00)	Prompt Acc@1  82.81 ( 82.81)
Validate: [25/79]	Time  0.216 ( 0.252)	Loss 2.0742e+00 (2.0883e+00)	Prompt Acc@1  92.97 ( 88.79)
Validate: [50/79]	Time  0.219 ( 0.236)	Loss 2.0840e+00 (2.0877e+00)	Prompt Acc@1  87.50 ( 89.11)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 2.0879e+00 (2.0871e+00)	Prompt Acc@1  86.72 ( 89.16)
 * Prompt Acc@1 89.130
saved best file
Training mode
Epoch: [4][  0/313]	Time  1.124 ( 1.124)	Data  0.698 ( 0.698)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  92.97 ( 92.97)
Epoch: [4][ 25/313]	Time  0.419 ( 0.445)	Data  0.016 ( 0.043)	Loss 2.0801e+00 (2.0871e+00)	Acc@1  89.84 ( 88.40)
Epoch: [4][ 50/313]	Time  0.422 ( 0.431)	Data  0.017 ( 0.030)	Loss 2.0840e+00 (2.0884e+00)	Acc@1  85.16 ( 88.08)
Epoch: [4][ 75/313]	Time  0.419 ( 0.427)	Data  0.017 ( 0.026)	Loss 2.0762e+00 (2.0876e+00)	Acc@1  93.75 ( 88.53)
Epoch: [4][100/313]	Time  0.417 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0879e+00 (2.0873e+00)	Acc@1  89.06 ( 88.69)
Epoch: [4][125/313]	Time  0.412 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0879e+00 (2.0871e+00)	Acc@1  87.50 ( 88.68)
Epoch: [4][150/313]	Time  0.414 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0840e+00 (2.0874e+00)	Acc@1  93.75 ( 88.74)
Epoch: [4][175/313]	Time  0.427 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0781e+00 (2.0874e+00)	Acc@1  90.62 ( 88.73)
Epoch: [4][200/313]	Time  0.422 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0938e+00 (2.0875e+00)	Acc@1  86.72 ( 88.72)
Epoch: [4][225/313]	Time  0.420 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0859e+00 (2.0873e+00)	Acc@1  89.06 ( 88.74)
Epoch: [4][250/313]	Time  0.419 ( 0.420)	Data  0.017 ( 0.019)	Loss 2.0859e+00 (2.0871e+00)	Acc@1  90.62 ( 88.73)
Epoch: [4][275/313]	Time  0.420 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0870e+00)	Acc@1  90.62 ( 88.75)
Epoch: [4][300/313]	Time  0.426 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0869e+00)	Acc@1  90.62 ( 88.75)
Validate: [ 0/79]	Time  0.993 ( 0.993)	Loss 2.0977e+00 (2.0977e+00)	Prompt Acc@1  84.38 ( 84.38)
Validate: [25/79]	Time  0.218 ( 0.252)	Loss 2.0742e+00 (2.0880e+00)	Prompt Acc@1  92.19 ( 88.76)
Validate: [50/79]	Time  0.218 ( 0.236)	Loss 2.0859e+00 (2.0874e+00)	Prompt Acc@1  88.28 ( 89.22)
Validate: [75/79]	Time  0.217 ( 0.230)	Loss 2.0879e+00 (2.0868e+00)	Prompt Acc@1  86.72 ( 89.31)
 * Prompt Acc@1 89.290
saved best file
Training mode
Epoch: [5][  0/313]	Time  1.119 ( 1.119)	Data  0.685 ( 0.685)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  90.62 ( 90.62)
Epoch: [5][ 25/313]	Time  0.415 ( 0.444)	Data  0.016 ( 0.042)	Loss 2.0781e+00 (2.0862e+00)	Acc@1  89.84 ( 88.34)
Epoch: [5][ 50/313]	Time  0.417 ( 0.431)	Data  0.016 ( 0.029)	Loss 2.0820e+00 (2.0873e+00)	Acc@1  87.50 ( 88.25)
Epoch: [5][ 75/313]	Time  0.422 ( 0.426)	Data  0.016 ( 0.025)	Loss 2.0742e+00 (2.0861e+00)	Acc@1  93.75 ( 88.70)
Epoch: [5][100/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0820e+00 (2.0854e+00)	Acc@1  89.06 ( 88.92)
Epoch: [5][125/313]	Time  0.419 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0879e+00 (2.0850e+00)	Acc@1  85.16 ( 88.96)
Epoch: [5][150/313]	Time  0.413 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0781e+00 (2.0850e+00)	Acc@1  93.75 ( 89.01)
Epoch: [5][175/313]	Time  0.420 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0762e+00 (2.0848e+00)	Acc@1  89.84 ( 88.94)
Epoch: [5][200/313]	Time  0.420 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0918e+00 (2.0846e+00)	Acc@1  84.38 ( 88.85)
Epoch: [5][225/313]	Time  0.426 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0843e+00)	Acc@1  89.06 ( 88.87)
Epoch: [5][250/313]	Time  0.419 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0840e+00)	Acc@1  92.97 ( 88.89)
Epoch: [5][275/313]	Time  0.429 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0837e+00)	Acc@1  91.41 ( 88.94)
Epoch: [5][300/313]	Time  0.416 ( 0.420)	Data  0.017 ( 0.019)	Loss 2.0801e+00 (2.0835e+00)	Acc@1  90.62 ( 88.96)
Validate: [ 0/79]	Time  0.949 ( 0.949)	Loss 2.0938e+00 (2.0938e+00)	Prompt Acc@1  87.50 ( 87.50)
Validate: [25/79]	Time  0.215 ( 0.249)	Loss 2.0684e+00 (2.0835e+00)	Prompt Acc@1  90.62 ( 88.31)
Validate: [50/79]	Time  0.220 ( 0.234)	Loss 2.0801e+00 (2.0828e+00)	Prompt Acc@1  92.19 ( 88.91)
Validate: [75/79]	Time  0.220 ( 0.229)	Loss 2.0859e+00 (2.0822e+00)	Prompt Acc@1  89.84 ( 89.22)
 * Prompt Acc@1 89.180
There's no improvement for 1 epochs.
Training mode
Epoch: [6][  0/313]	Time  1.148 ( 1.148)	Data  0.721 ( 0.721)	Loss 2.0781e+00 (2.0781e+00)	Acc@1  88.28 ( 88.28)
Epoch: [6][ 25/313]	Time  0.424 ( 0.448)	Data  0.016 ( 0.045)	Loss 2.0723e+00 (2.0820e+00)	Acc@1  90.62 ( 88.37)
Epoch: [6][ 50/313]	Time  0.414 ( 0.433)	Data  0.016 ( 0.031)	Loss 2.0781e+00 (2.0830e+00)	Acc@1  88.28 ( 88.20)
Epoch: [6][ 75/313]	Time  0.413 ( 0.428)	Data  0.016 ( 0.026)	Loss 2.0703e+00 (2.0819e+00)	Acc@1  92.19 ( 88.83)
Epoch: [6][100/313]	Time  0.419 ( 0.425)	Data  0.016 ( 0.024)	Loss 2.0781e+00 (2.0815e+00)	Acc@1  89.06 ( 89.01)
Epoch: [6][125/313]	Time  0.414 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0813e+00)	Acc@1  86.72 ( 89.12)
Epoch: [6][150/313]	Time  0.415 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0816e+00)	Acc@1  92.97 ( 89.06)
Epoch: [6][175/313]	Time  0.416 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0742e+00 (2.0816e+00)	Acc@1  89.06 ( 88.94)
Epoch: [6][200/313]	Time  0.413 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0898e+00 (2.0816e+00)	Acc@1  85.94 ( 88.87)
Epoch: [6][225/313]	Time  0.413 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0814e+00)	Acc@1  89.84 ( 88.90)
Epoch: [6][250/313]	Time  0.413 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0812e+00)	Acc@1  92.19 ( 88.95)
Epoch: [6][275/313]	Time  0.413 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0809e+00)	Acc@1  92.19 ( 88.97)
Epoch: [6][300/313]	Time  0.415 ( 0.420)	Data  0.018 ( 0.019)	Loss 2.0781e+00 (2.0809e+00)	Acc@1  90.62 ( 89.00)
Validate: [ 0/79]	Time  0.957 ( 0.957)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.219 ( 0.252)	Loss 2.0664e+00 (2.0828e+00)	Prompt Acc@1  90.62 ( 88.13)
Validate: [50/79]	Time  0.219 ( 0.236)	Loss 2.0781e+00 (2.0819e+00)	Prompt Acc@1  93.75 ( 88.85)
Validate: [75/79]	Time  0.219 ( 0.230)	Loss 2.0840e+00 (2.0812e+00)	Prompt Acc@1  89.06 ( 89.19)
 * Prompt Acc@1 89.150
There's no improvement for 2 epochs.
Training mode
Epoch: [7][  0/313]	Time  1.152 ( 1.152)	Data  0.729 ( 0.729)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  89.84 ( 89.84)
Epoch: [7][ 25/313]	Time  0.425 ( 0.445)	Data  0.016 ( 0.044)	Loss 2.0723e+00 (2.0808e+00)	Acc@1  91.41 ( 88.43)
Epoch: [7][ 50/313]	Time  0.424 ( 0.432)	Data  0.016 ( 0.030)	Loss 2.0781e+00 (2.0820e+00)	Acc@1  88.28 ( 88.24)
Epoch: [7][ 75/313]	Time  0.418 ( 0.427)	Data  0.016 ( 0.026)	Loss 2.0703e+00 (2.0811e+00)	Acc@1  92.19 ( 88.76)
Epoch: [7][100/313]	Time  0.418 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0781e+00 (2.0807e+00)	Acc@1  89.84 ( 88.96)
Epoch: [7][125/313]	Time  0.412 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0805e+00)	Acc@1  86.72 ( 89.08)
Epoch: [7][150/313]	Time  0.415 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0808e+00)	Acc@1  92.97 ( 89.03)
Epoch: [7][175/313]	Time  0.415 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0742e+00 (2.0808e+00)	Acc@1  88.28 ( 88.94)
Epoch: [7][200/313]	Time  0.416 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0898e+00 (2.0808e+00)	Acc@1  85.94 ( 88.84)
Epoch: [7][225/313]	Time  0.418 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0806e+00)	Acc@1  90.62 ( 88.85)
Epoch: [7][250/313]	Time  0.419 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0805e+00)	Acc@1  91.41 ( 88.90)
Epoch: [7][275/313]	Time  0.413 ( 0.420)	Data  0.015 ( 0.019)	Loss 2.0781e+00 (2.0802e+00)	Acc@1  92.97 ( 88.91)
Epoch: [7][300/313]	Time  0.416 ( 0.419)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0802e+00)	Acc@1  91.41 ( 88.94)
Validate: [ 0/79]	Time  0.922 ( 0.922)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.219 ( 0.250)	Loss 2.0664e+00 (2.0824e+00)	Prompt Acc@1  90.62 ( 88.22)
Validate: [50/79]	Time  0.219 ( 0.234)	Loss 2.0781e+00 (2.0816e+00)	Prompt Acc@1  93.75 ( 88.85)
Validate: [75/79]	Time  0.218 ( 0.229)	Loss 2.0840e+00 (2.0809e+00)	Prompt Acc@1  89.06 ( 89.17)
 * Prompt Acc@1 89.150
There's no improvement for 3 epochs.
Training mode
Epoch: [8][  0/313]	Time  1.092 ( 1.092)	Data  0.685 ( 0.685)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  89.84 ( 89.84)
Epoch: [8][ 25/313]	Time  0.419 ( 0.445)	Data  0.016 ( 0.042)	Loss 2.0723e+00 (2.0805e+00)	Acc@1  91.41 ( 88.34)
Epoch: [8][ 50/313]	Time  0.420 ( 0.431)	Data  0.017 ( 0.029)	Loss 2.0781e+00 (2.0817e+00)	Acc@1  88.28 ( 88.24)
Epoch: [8][ 75/313]	Time  0.413 ( 0.427)	Data  0.016 ( 0.025)	Loss 2.0703e+00 (2.0807e+00)	Acc@1  92.19 ( 88.75)
Epoch: [8][100/313]	Time  0.415 ( 0.424)	Data  0.015 ( 0.023)	Loss 2.0781e+00 (2.0803e+00)	Acc@1  89.84 ( 88.95)
Epoch: [8][125/313]	Time  0.416 ( 0.423)	Data  0.016 ( 0.021)	Loss 2.0840e+00 (2.0801e+00)	Acc@1  86.72 ( 89.07)
Epoch: [8][150/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0804e+00)	Acc@1  92.97 ( 88.99)
Epoch: [8][175/313]	Time  0.418 ( 0.421)	Data  0.015 ( 0.020)	Loss 2.0742e+00 (2.0804e+00)	Acc@1  88.28 ( 88.89)
Epoch: [8][200/313]	Time  0.417 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0898e+00 (2.0805e+00)	Acc@1  85.16 ( 88.81)
Epoch: [8][225/313]	Time  0.419 ( 0.420)	Data  0.017 ( 0.019)	Loss 2.0762e+00 (2.0803e+00)	Acc@1  89.84 ( 88.82)
Epoch: [8][250/313]	Time  0.426 ( 0.420)	Data  0.017 ( 0.019)	Loss 2.0781e+00 (2.0801e+00)	Acc@1  91.41 ( 88.88)
Epoch: [8][275/313]	Time  0.417 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  92.97 ( 88.90)
Epoch: [8][300/313]	Time  0.419 ( 0.420)	Data  0.016 ( 0.018)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  91.41 ( 88.92)
Validate: [ 0/79]	Time  1.061 ( 1.061)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.218 ( 0.255)	Loss 2.0664e+00 (2.0823e+00)	Prompt Acc@1  90.62 ( 88.28)
Validate: [50/79]	Time  0.220 ( 0.237)	Loss 2.0781e+00 (2.0814e+00)	Prompt Acc@1  93.75 ( 88.86)
Validate: [75/79]	Time  0.217 ( 0.231)	Loss 2.0840e+00 (2.0807e+00)	Prompt Acc@1  89.06 ( 89.17)
 * Prompt Acc@1 89.160
There's no improvement for 4 epochs.
Training mode
Epoch: [9][  0/313]	Time  1.100 ( 1.100)	Data  0.686 ( 0.686)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  89.06 ( 89.06)
Epoch: [9][ 25/313]	Time  0.423 ( 0.445)	Data  0.016 ( 0.043)	Loss 2.0723e+00 (2.0805e+00)	Acc@1  91.41 ( 88.19)
Epoch: [9][ 50/313]	Time  0.418 ( 0.432)	Data  0.016 ( 0.030)	Loss 2.0781e+00 (2.0816e+00)	Acc@1  88.28 ( 88.17)
Epoch: [9][ 75/313]	Time  0.420 ( 0.427)	Data  0.016 ( 0.025)	Loss 2.0703e+00 (2.0806e+00)	Acc@1  92.19 ( 88.68)
Epoch: [9][100/313]	Time  0.420 ( 0.425)	Data  0.016 ( 0.023)	Loss 2.0781e+00 (2.0802e+00)	Acc@1  89.84 ( 88.90)
Epoch: [9][125/313]	Time  0.421 ( 0.423)	Data  0.017 ( 0.022)	Loss 2.0840e+00 (2.0800e+00)	Acc@1  86.72 ( 89.05)
Epoch: [9][150/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0802e+00)	Acc@1  92.97 ( 88.96)
Epoch: [9][175/313]	Time  0.414 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0742e+00 (2.0803e+00)	Acc@1  88.28 ( 88.87)
Epoch: [9][200/313]	Time  0.416 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0898e+00 (2.0803e+00)	Acc@1  84.38 ( 88.77)
Epoch: [9][225/313]	Time  0.419 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0762e+00 (2.0801e+00)	Acc@1  89.84 ( 88.78)
Epoch: [9][250/313]	Time  0.419 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  91.41 ( 88.84)
Epoch: [9][275/313]	Time  0.414 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0797e+00)	Acc@1  92.97 ( 88.87)
Epoch: [9][300/313]	Time  0.413 ( 0.419)	Data  0.017 ( 0.018)	Loss 2.0781e+00 (2.0797e+00)	Acc@1  91.41 ( 88.89)
Validate: [ 0/79]	Time  0.965 ( 0.965)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.216 ( 0.254)	Loss 2.0664e+00 (2.0820e+00)	Prompt Acc@1  90.62 ( 88.34)
Validate: [50/79]	Time  0.217 ( 0.236)	Loss 2.0781e+00 (2.0812e+00)	Prompt Acc@1  93.75 ( 88.89)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 2.0840e+00 (2.0806e+00)	Prompt Acc@1  89.06 ( 89.13)
 * Prompt Acc@1 89.130
There's no improvement for 5 epochs.
Training mode
Epoch: [10][  0/313]	Time  1.165 ( 1.165)	Data  0.728 ( 0.728)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  89.06 ( 89.06)
Epoch: [10][ 25/313]	Time  0.419 ( 0.445)	Data  0.016 ( 0.044)	Loss 2.0703e+00 (2.0802e+00)	Acc@1  91.41 ( 88.22)
Epoch: [10][ 50/313]	Time  0.417 ( 0.431)	Data  0.016 ( 0.030)	Loss 2.0781e+00 (2.0814e+00)	Acc@1  88.28 ( 88.17)
Epoch: [10][ 75/313]	Time  0.420 ( 0.427)	Data  0.016 ( 0.026)	Loss 2.0684e+00 (2.0804e+00)	Acc@1  92.19 ( 88.62)
Epoch: [10][100/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0781e+00 (2.0800e+00)	Acc@1  89.84 ( 88.86)
Epoch: [10][125/313]	Time  0.419 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0798e+00)	Acc@1  86.72 ( 89.01)
Epoch: [10][150/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0801e+00)	Acc@1  92.97 ( 88.93)
Epoch: [10][175/313]	Time  0.417 ( 0.421)	Data  0.016 ( 0.020)	Loss 2.0742e+00 (2.0802e+00)	Acc@1  88.28 ( 88.84)
Epoch: [10][200/313]	Time  0.418 ( 0.421)	Data  0.017 ( 0.020)	Loss 2.0879e+00 (2.0802e+00)	Acc@1  84.38 ( 88.75)
Epoch: [10][225/313]	Time  0.416 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0762e+00 (2.0800e+00)	Acc@1  89.84 ( 88.75)
Epoch: [10][250/313]	Time  0.414 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0798e+00)	Acc@1  91.41 ( 88.82)
Epoch: [10][275/313]	Time  0.413 ( 0.420)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0796e+00)	Acc@1  92.97 ( 88.85)
Epoch: [10][300/313]	Time  0.419 ( 0.419)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0796e+00)	Acc@1  91.41 ( 88.87)
Validate: [ 0/79]	Time  0.983 ( 0.983)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.218 ( 0.253)	Loss 2.0664e+00 (2.0819e+00)	Prompt Acc@1  90.62 ( 88.25)
Validate: [50/79]	Time  0.218 ( 0.236)	Loss 2.0781e+00 (2.0812e+00)	Prompt Acc@1  93.75 ( 88.85)
Validate: [75/79]	Time  0.215 ( 0.230)	Loss 2.0840e+00 (2.0805e+00)	Prompt Acc@1  89.06 ( 89.08)
 * Prompt Acc@1 89.090
There's no improvement for 6 epochs.
Training mode
Epoch: [11][  0/313]	Time  1.144 ( 1.144)	Data  0.708 ( 0.708)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  89.06 ( 89.06)
Epoch: [11][ 25/313]	Time  0.413 ( 0.445)	Data  0.017 ( 0.043)	Loss 2.0703e+00 (2.0801e+00)	Acc@1  91.41 ( 88.19)
Epoch: [11][ 50/313]	Time  0.413 ( 0.431)	Data  0.015 ( 0.030)	Loss 2.0781e+00 (2.0813e+00)	Acc@1  88.28 ( 88.14)
Epoch: [11][ 75/313]	Time  0.416 ( 0.426)	Data  0.017 ( 0.025)	Loss 2.0703e+00 (2.0803e+00)	Acc@1  92.19 ( 88.58)
Epoch: [11][100/313]	Time  0.413 ( 0.424)	Data  0.016 ( 0.023)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  89.84 ( 88.82)
Epoch: [11][125/313]	Time  0.430 ( 0.423)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0797e+00)	Acc@1  86.72 ( 88.99)
Epoch: [11][150/313]	Time  0.422 ( 0.422)	Data  0.016 ( 0.021)	Loss 2.0762e+00 (2.0800e+00)	Acc@1  92.97 ( 88.91)
Epoch: [11][175/313]	Time  0.421 ( 0.421)	Data  0.017 ( 0.020)	Loss 2.0742e+00 (2.0801e+00)	Acc@1  88.28 ( 88.84)
Epoch: [11][200/313]	Time  0.412 ( 0.421)	Data  0.015 ( 0.020)	Loss 2.0898e+00 (2.0801e+00)	Acc@1  84.38 ( 88.74)
Epoch: [11][225/313]	Time  0.417 ( 0.420)	Data  0.015 ( 0.019)	Loss 2.0762e+00 (2.0799e+00)	Acc@1  89.84 ( 88.74)
Epoch: [11][250/313]	Time  0.413 ( 0.420)	Data  0.015 ( 0.019)	Loss 2.0781e+00 (2.0798e+00)	Acc@1  91.41 ( 88.82)
Epoch: [11][275/313]	Time  0.412 ( 0.420)	Data  0.015 ( 0.019)	Loss 2.0781e+00 (2.0796e+00)	Acc@1  92.97 ( 88.85)
Epoch: [11][300/313]	Time  0.416 ( 0.419)	Data  0.016 ( 0.018)	Loss 2.0781e+00 (2.0796e+00)	Acc@1  91.41 ( 88.86)
Validate: [ 0/79]	Time  0.921 ( 0.921)	Loss 2.0918e+00 (2.0918e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.216 ( 0.252)	Loss 2.0664e+00 (2.0818e+00)	Prompt Acc@1  90.62 ( 88.31)
Validate: [50/79]	Time  0.216 ( 0.235)	Loss 2.0781e+00 (2.0811e+00)	Prompt Acc@1  92.97 ( 88.92)
Validate: [75/79]	Time  0.218 ( 0.229)	Loss 2.0840e+00 (2.0804e+00)	Prompt Acc@1  89.06 ( 89.16)
 * Prompt Acc@1 89.160
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Traceback (most recent call last):
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//main.py", line 150, in <module>
    main()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//main.py", line 144, in main
    learn.run()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/learner.py", line 178, in run
    f.write(f"Method {self.args.method}, Prompt_size {self.args.prompt_size} -- Acc: {acc}, best Acc: {self.best_acc1}\n")
NameError: name 'acc' is not defined. Did you mean: 'acc1'?
Running experiment on cifar10 with random_patch and prompt size 1
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/random_patch_1_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.random_patch'}"
Number of prompt parameters:  3
Training mode
Epoch: [0][  0/313]	Time  2.226 ( 2.226)	Data  0.697 ( 0.697)	Loss 2.0840e+00 (2.0840e+00)	Acc@1  89.84 ( 89.84)
Epoch: [0][ 25/313]	Time  0.414 ( 0.485)	Data  0.016 ( 0.042)	Loss 2.0898e+00 (2.0867e+00)	Acc@1  88.28 ( 89.54)
Epoch: [0][ 50/313]	Time  0.411 ( 0.451)	Data  0.016 ( 0.029)	Loss 2.0938e+00 (2.0880e+00)	Acc@1  82.81 ( 89.09)
Epoch: [0][ 75/313]	Time  0.419 ( 0.440)	Data  0.017 ( 0.025)	Loss 2.0781e+00 (2.0884e+00)	Acc@1  92.97 ( 88.82)
Epoch: [0][100/313]	Time  0.420 ( 0.435)	Data  0.017 ( 0.023)	Loss 2.0918e+00 (2.0872e+00)	Acc@1  84.38 ( 88.78)
Epoch: [0][125/313]	Time  0.428 ( 0.432)	Data  0.022 ( 0.022)	Loss 2.0840e+00 (2.0861e+00)	Acc@1  86.72 ( 88.75)
Epoch: [0][150/313]	Time  0.416 ( 0.429)	Data  0.017 ( 0.021)	Loss 2.0820e+00 (2.0855e+00)	Acc@1  89.84 ( 88.83)
Epoch: [0][175/313]	Time  0.419 ( 0.428)	Data  0.018 ( 0.020)	Loss 2.0625e+00 (2.0848e+00)	Acc@1  93.75 ( 88.78)
Epoch: [0][200/313]	Time  0.421 ( 0.427)	Data  0.017 ( 0.020)	Loss 2.0840e+00 (2.0844e+00)	Acc@1  89.06 ( 88.77)
Epoch: [0][225/313]	Time  0.417 ( 0.426)	Data  0.017 ( 0.020)	Loss 2.0879e+00 (2.0838e+00)	Acc@1  82.81 ( 88.86)
Epoch: [0][250/313]	Time  0.414 ( 0.425)	Data  0.017 ( 0.019)	Loss 2.0820e+00 (2.0834e+00)	Acc@1  82.03 ( 88.82)
Epoch: [0][275/313]	Time  0.424 ( 0.425)	Data  0.017 ( 0.019)	Loss 2.0801e+00 (2.0831e+00)	Acc@1  85.16 ( 88.87)
Epoch: [0][300/313]	Time  0.415 ( 0.425)	Data  0.016 ( 0.019)	Loss 2.0840e+00 (2.0828e+00)	Acc@1  88.28 ( 88.92)
Validate: [ 0/79]	Time  0.867 ( 0.867)	Loss 2.0820e+00 (2.0820e+00)	Prompt Acc@1  89.06 ( 89.06)
Validate: [25/79]	Time  0.219 ( 0.249)	Loss 2.0840e+00 (2.0793e+00)	Prompt Acc@1  89.06 ( 88.67)
Validate: [50/79]	Time  0.219 ( 0.235)	Loss 2.0781e+00 (2.0805e+00)	Prompt Acc@1  88.28 ( 89.12)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 2.0664e+00 (2.0799e+00)	Prompt Acc@1  93.75 ( 89.36)
 * Prompt Acc@1 89.330
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.104 ( 1.104)	Data  0.689 ( 0.689)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  89.84 ( 89.84)
Epoch: [1][ 25/313]	Time  0.412 ( 0.444)	Data  0.016 ( 0.042)	Loss 2.0820e+00 (2.0801e+00)	Acc@1  89.06 ( 89.60)
Epoch: [1][ 50/313]	Time  0.414 ( 0.431)	Data  0.016 ( 0.029)	Loss 2.0879e+00 (2.0807e+00)	Acc@1  83.59 ( 89.32)
Epoch: [1][ 75/313]	Time  0.421 ( 0.427)	Data  0.016 ( 0.025)	Loss 2.0762e+00 (2.0816e+00)	Acc@1  91.41 ( 88.84)
Epoch: [1][100/313]	Time  0.426 ( 0.425)	Data  0.015 ( 0.023)	Loss 2.0898e+00 (2.0811e+00)	Acc@1  85.94 ( 88.85)
Epoch: [1][125/313]	Time  0.414 ( 0.424)	Data  0.016 ( 0.022)	Loss 2.0859e+00 (2.0809e+00)	Acc@1  85.94 ( 88.86)
Epoch: [1][150/313]	Time  0.415 ( 0.423)	Data  0.016 ( 0.021)	Loss 2.0820e+00 (2.0811e+00)	Acc@1  89.84 ( 88.86)
Epoch: [1][175/313]	Time  0.414 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0645e+00 (2.0811e+00)	Acc@1  92.19 ( 88.85)
Epoch: [1][200/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0820e+00 (2.0810e+00)	Acc@1  86.72 ( 88.83)
Epoch: [1][225/313]	Time  0.421 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0879e+00 (2.0807e+00)	Acc@1  83.59 ( 88.93)
Epoch: [1][250/313]	Time  0.422 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0805e+00)	Acc@1  85.94 ( 88.90)
Epoch: [1][275/313]	Time  0.418 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0804e+00)	Acc@1  88.28 ( 88.98)
Epoch: [1][300/313]	Time  0.414 ( 0.421)	Data  0.016 ( 0.018)	Loss 2.0801e+00 (2.0803e+00)	Acc@1  88.28 ( 89.02)
Validate: [ 0/79]	Time  0.906 ( 0.906)	Loss 2.0820e+00 (2.0820e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.220 ( 0.251)	Loss 2.0801e+00 (2.0791e+00)	Prompt Acc@1  88.28 ( 88.79)
Validate: [50/79]	Time  0.219 ( 0.236)	Loss 2.0742e+00 (2.0799e+00)	Prompt Acc@1  87.50 ( 89.06)
Validate: [75/79]	Time  0.219 ( 0.230)	Loss 2.0684e+00 (2.0794e+00)	Prompt Acc@1  93.75 ( 89.17)
 * Prompt Acc@1 89.160
There's no improvement for 1 epochs.
Training mode
Epoch: [2][  0/313]	Time  1.095 ( 1.095)	Data  0.665 ( 0.665)	Loss 2.0781e+00 (2.0781e+00)	Acc@1  92.19 ( 92.19)
Epoch: [2][ 25/313]	Time  0.418 ( 0.444)	Data  0.016 ( 0.041)	Loss 2.0820e+00 (2.0796e+00)	Acc@1  89.84 ( 89.93)
Epoch: [2][ 50/313]	Time  0.417 ( 0.431)	Data  0.016 ( 0.029)	Loss 2.0859e+00 (2.0806e+00)	Acc@1  82.03 ( 89.22)
Epoch: [2][ 75/313]	Time  0.417 ( 0.427)	Data  0.016 ( 0.024)	Loss 2.0742e+00 (2.0814e+00)	Acc@1  90.62 ( 88.82)
Epoch: [2][100/313]	Time  0.424 ( 0.425)	Data  0.016 ( 0.022)	Loss 2.0898e+00 (2.0809e+00)	Acc@1  85.94 ( 88.71)
Epoch: [2][125/313]	Time  0.421 ( 0.423)	Data  0.016 ( 0.021)	Loss 2.0840e+00 (2.0809e+00)	Acc@1  86.72 ( 88.73)
Epoch: [2][150/313]	Time  0.421 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0742e+00 (2.0809e+00)	Acc@1  89.84 ( 88.77)
Epoch: [2][175/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.020)	Loss 2.0605e+00 (2.0809e+00)	Acc@1  92.97 ( 88.73)
Epoch: [2][200/313]	Time  0.416 ( 0.422)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0807e+00)	Acc@1  85.16 ( 88.68)
Epoch: [2][225/313]	Time  0.420 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0879e+00 (2.0806e+00)	Acc@1  84.38 ( 88.75)
Epoch: [2][250/313]	Time  0.422 ( 0.421)	Data  0.016 ( 0.019)	Loss 2.0859e+00 (2.0804e+00)	Acc@1  84.38 ( 88.74)
Epoch: [2][275/313]	Time  0.416 ( 0.421)	Data  0.015 ( 0.018)	Loss 2.0840e+00 (2.0803e+00)	Acc@1  85.16 ( 88.79)
Epoch: [2][300/313]	Time  0.414 ( 0.420)	Data  0.016 ( 0.018)	Loss 2.0801e+00 (2.0802e+00)	Acc@1  87.50 ( 88.83)
Validate: [ 0/79]	Time  0.905 ( 0.905)	Loss 2.0781e+00 (2.0781e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.220 ( 0.252)	Loss 2.0801e+00 (2.0790e+00)	Prompt Acc@1  88.28 ( 88.43)
Validate: [50/79]	Time  0.219 ( 0.237)	Loss 2.0762e+00 (2.0794e+00)	Prompt Acc@1  89.06 ( 88.76)
Validate: [75/79]	Time  0.217 ( 0.231)	Loss 2.0703e+00 (2.0792e+00)	Prompt Acc@1  93.75 ( 89.05)
 * Prompt Acc@1 89.010
There's no improvement for 2 epochs.
Training mode
Epoch: [3][  0/313]	Time  1.148 ( 1.148)	Data  0.720 ( 0.720)	Loss 2.0820e+00 (2.0820e+00)	Acc@1  90.62 ( 90.62)
Epoch: [3][ 25/313]	Time  0.435 ( 0.449)	Data  0.015 ( 0.044)	Loss 2.0840e+00 (2.0804e+00)	Acc@1  89.84 ( 89.39)
Epoch: [3][ 50/313]	Time  0.421 ( 0.434)	Data  0.016 ( 0.030)	Loss 2.0898e+00 (2.0809e+00)	Acc@1  82.81 ( 89.02)
Epoch: [3][ 75/313]	Time  0.417 ( 0.429)	Data  0.016 ( 0.026)	Loss 2.0781e+00 (2.0815e+00)	Acc@1  92.19 ( 88.61)
Epoch: [3][100/313]	Time  0.425 ( 0.428)	Data  0.017 ( 0.023)	Loss 2.0898e+00 (2.0810e+00)	Acc@1  87.50 ( 88.68)
Epoch: [3][125/313]	Time  0.416 ( 0.426)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0808e+00)	Acc@1  85.94 ( 88.61)
Epoch: [3][150/313]	Time  0.418 ( 0.425)	Data  0.016 ( 0.021)	Loss 2.0742e+00 (2.0809e+00)	Acc@1  89.84 ( 88.63)
Epoch: [3][175/313]	Time  0.422 ( 0.425)	Data  0.016 ( 0.020)	Loss 2.0625e+00 (2.0808e+00)	Acc@1  92.19 ( 88.56)
Epoch: [3][200/313]	Time  0.418 ( 0.424)	Data  0.016 ( 0.020)	Loss 2.0879e+00 (2.0807e+00)	Acc@1  87.50 ( 88.53)
Epoch: [3][225/313]	Time  0.421 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0879e+00 (2.0804e+00)	Acc@1  82.81 ( 88.61)
Epoch: [3][250/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0800e+00)	Acc@1  85.16 ( 88.58)
Epoch: [3][275/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0800e+00)	Acc@1  86.72 ( 88.64)
Epoch: [3][300/313]	Time  0.428 ( 0.423)	Data  0.016 ( 0.018)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  89.06 ( 88.74)
Validate: [ 0/79]	Time  0.868 ( 0.868)	Loss 2.0801e+00 (2.0801e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.221 ( 0.252)	Loss 2.0820e+00 (2.0786e+00)	Prompt Acc@1  89.84 ( 88.79)
Validate: [50/79]	Time  0.219 ( 0.236)	Loss 2.0801e+00 (2.0795e+00)	Prompt Acc@1  85.94 ( 88.86)
Validate: [75/79]	Time  0.219 ( 0.231)	Loss 2.0723e+00 (2.0791e+00)	Prompt Acc@1  92.19 ( 89.13)
 * Prompt Acc@1 89.070
There's no improvement for 3 epochs.
Training mode
Epoch: [4][  0/313]	Time  1.126 ( 1.126)	Data  0.717 ( 0.717)	Loss 2.0801e+00 (2.0801e+00)	Acc@1  89.84 ( 89.84)
Epoch: [4][ 25/313]	Time  0.424 ( 0.449)	Data  0.016 ( 0.043)	Loss 2.0820e+00 (2.0796e+00)	Acc@1  89.06 ( 89.24)
Epoch: [4][ 50/313]	Time  0.416 ( 0.435)	Data  0.016 ( 0.030)	Loss 2.0879e+00 (2.0806e+00)	Acc@1  82.03 ( 88.97)
Epoch: [4][ 75/313]	Time  0.418 ( 0.431)	Data  0.016 ( 0.026)	Loss 2.0801e+00 (2.0815e+00)	Acc@1  89.84 ( 88.52)
Epoch: [4][100/313]	Time  0.423 ( 0.428)	Data  0.016 ( 0.023)	Loss 2.0938e+00 (2.0811e+00)	Acc@1  85.94 ( 88.50)
Epoch: [4][125/313]	Time  0.416 ( 0.427)	Data  0.016 ( 0.022)	Loss 2.0840e+00 (2.0809e+00)	Acc@1  87.50 ( 88.54)
Epoch: [4][150/313]	Time  0.424 ( 0.426)	Data  0.016 ( 0.021)	Loss 2.0781e+00 (2.0809e+00)	Acc@1  88.28 ( 88.63)
Epoch: [4][175/313]	Time  0.420 ( 0.425)	Data  0.016 ( 0.020)	Loss 2.0645e+00 (2.0807e+00)	Acc@1  92.19 ( 88.61)
Epoch: [4][200/313]	Time  0.419 ( 0.425)	Data  0.016 ( 0.020)	Loss 2.0762e+00 (2.0806e+00)	Acc@1  85.94 ( 88.60)
Epoch: [4][225/313]	Time  0.421 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0879e+00 (2.0804e+00)	Acc@1  82.81 ( 88.70)
Epoch: [4][250/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0820e+00 (2.0802e+00)	Acc@1  84.38 ( 88.66)
Epoch: [4][275/313]	Time  0.425 ( 0.424)	Data  0.015 ( 0.019)	Loss 2.0781e+00 (2.0801e+00)	Acc@1  86.72 ( 88.71)
Epoch: [4][300/313]	Time  0.418 ( 0.424)	Data  0.016 ( 0.018)	Loss 2.0781e+00 (2.0801e+00)	Acc@1  89.06 ( 88.77)
Validate: [ 0/79]	Time  0.988 ( 0.988)	Loss 2.0781e+00 (2.0781e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.228 ( 0.253)	Loss 2.0801e+00 (2.0784e+00)	Prompt Acc@1  89.06 ( 88.91)
Validate: [50/79]	Time  0.220 ( 0.237)	Loss 2.0762e+00 (2.0794e+00)	Prompt Acc@1  87.50 ( 89.03)
Validate: [75/79]	Time  0.218 ( 0.232)	Loss 2.0703e+00 (2.0792e+00)	Prompt Acc@1  95.31 ( 89.14)
 * Prompt Acc@1 89.070
There's no improvement for 4 epochs.
Training mode
Epoch: [5][  0/313]	Time  1.118 ( 1.118)	Data  0.712 ( 0.712)	Loss 2.0781e+00 (2.0781e+00)	Acc@1  92.97 ( 92.97)
Epoch: [5][ 25/313]	Time  0.427 ( 0.449)	Data  0.017 ( 0.043)	Loss 2.0840e+00 (2.0799e+00)	Acc@1  87.50 ( 89.60)
Epoch: [5][ 50/313]	Time  0.421 ( 0.435)	Data  0.016 ( 0.030)	Loss 2.0879e+00 (2.0808e+00)	Acc@1  82.03 ( 89.29)
Epoch: [5][ 75/313]	Time  0.417 ( 0.430)	Data  0.016 ( 0.025)	Loss 2.0742e+00 (2.0815e+00)	Acc@1  91.41 ( 88.76)
Epoch: [5][100/313]	Time  0.438 ( 0.428)	Data  0.016 ( 0.023)	Loss 2.0879e+00 (2.0810e+00)	Acc@1  87.50 ( 88.66)
Epoch: [5][125/313]	Time  0.423 ( 0.427)	Data  0.017 ( 0.022)	Loss 2.0801e+00 (2.0809e+00)	Acc@1  87.50 ( 88.56)
Epoch: [5][150/313]	Time  0.418 ( 0.426)	Data  0.015 ( 0.021)	Loss 2.0801e+00 (2.0808e+00)	Acc@1  89.84 ( 88.65)
Epoch: [5][175/313]	Time  0.422 ( 0.425)	Data  0.015 ( 0.020)	Loss 2.0605e+00 (2.0805e+00)	Acc@1  92.97 ( 88.63)
Epoch: [5][200/313]	Time  0.415 ( 0.425)	Data  0.015 ( 0.019)	Loss 2.0801e+00 (2.0804e+00)	Acc@1  85.94 ( 88.62)
Epoch: [5][225/313]	Time  0.434 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0898e+00 (2.0801e+00)	Acc@1  82.03 ( 88.66)
Epoch: [5][250/313]	Time  0.420 ( 0.424)	Data  0.016 ( 0.019)	Loss 2.0781e+00 (2.0800e+00)	Acc@1  85.16 ( 88.62)
Epoch: [5][275/313]	Time  0.424 ( 0.424)	Data  0.016 ( 0.018)	Loss 2.0781e+00 (2.0799e+00)	Acc@1  84.38 ( 88.68)
Epoch: [5][300/313]	Time  0.417 ( 0.424)	Data  0.016 ( 0.018)	Loss 2.0801e+00 (2.0799e+00)	Acc@1  88.28 ( 88.72)
Validate: [ 0/79]	Time  0.961 ( 0.961)	Loss 2.0781e+00 (2.0781e+00)	Prompt Acc@1  91.41 ( 91.41)
Validate: [25/79]	Time  0.220 ( 0.255)	Loss 2.0820e+00 (2.0783e+00)	Prompt Acc@1  89.06 ( 88.82)
Validate: [50/79]	Time  0.219 ( 0.238)	Loss 2.0762e+00 (2.0798e+00)	Prompt Acc@1  89.84 ( 88.92)
Validate: [75/79]	Time  0.221 ( 0.232)	Loss 2.0664e+00 (2.0793e+00)	Prompt Acc@1  95.31 ( 89.09)
 * Prompt Acc@1 89.020
There's no improvement for 5 epochs.
Training mode
Epoch: [6][  0/313]	Time  1.083 ( 1.083)	Data  0.665 ( 0.665)	Loss 2.0762e+00 (2.0762e+00)	Acc@1  92.97 ( 92.97)
Epoch: [6][ 25/313]	Time  0.428 ( 0.447)	Data  0.016 ( 0.041)	Loss 2.0820e+00 (2.0790e+00)	Acc@1  87.50 ( 89.09)
Epoch: [6][ 50/313]	Time  0.423 ( 0.435)	Data  0.017 ( 0.029)	Loss 2.0840e+00 (2.0797e+00)	Acc@1  83.59 ( 88.89)
Epoch: [6][ 75/313]	Time  0.436 ( 0.432)	Data  0.021 ( 0.025)	Loss 2.0762e+00 (2.0806e+00)	Acc@1  92.19 ( 88.57)
Epoch: [6][100/313]	Time  0.426 ( 0.430)	Data  0.015 ( 0.023)	Loss 2.0859e+00 (2.0799e+00)	Acc@1  86.72 ( 88.54)
Epoch: [6][125/313]	Time  0.429 ( 0.429)	Data  0.018 ( 0.022)	Loss 2.0840e+00 (2.0799e+00)	Acc@1  84.38 ( 88.55)
Epoch: [6][150/313]	Time  0.419 ( 0.428)	Data  0.015 ( 0.021)	Loss 2.0781e+00 (2.0801e+00)	Acc@1  89.06 ( 88.61)
Epoch: [6][175/313]	Time  0.422 ( 0.427)	Data  0.015 ( 0.020)	Loss 2.0625e+00 (2.0801e+00)	Acc@1  92.19 ( 88.59)
Epoch: [6][200/313]	Time  0.426 ( 0.427)	Data  0.016 ( 0.020)	Loss 2.0781e+00 (2.0801e+00)	Acc@1  82.81 ( 88.53)
Epoch: [6][225/313]	Time  0.432 ( 0.427)	Data  0.017 ( 0.019)	Loss 2.0859e+00 (2.0799e+00)	Acc@1  83.59 ( 88.64)
Epoch: [6][250/313]	Time  0.419 ( 0.427)	Data  0.016 ( 0.019)	Loss 2.0801e+00 (2.0797e+00)	Acc@1  83.59 ( 88.60)
Epoch: [6][275/313]	Time  0.426 ( 0.427)	Data  0.017 ( 0.019)	Loss 2.0801e+00 (2.0797e+00)	Acc@1  85.94 ( 88.71)
Epoch: [6][300/313]	Time  0.422 ( 0.427)	Data  0.015 ( 0.019)	Loss 2.0781e+00 (2.0796e+00)	Acc@1  89.06 ( 88.78)
Validate: [ 0/79]	Time  0.920 ( 0.920)	Loss 2.0801e+00 (2.0801e+00)	Prompt Acc@1  89.06 ( 89.06)
Validate: [25/79]	Time  0.226 ( 0.249)	Loss 2.0820e+00 (2.0793e+00)	Prompt Acc@1  89.84 ( 88.76)
Validate: [50/79]	Time  0.221 ( 0.235)	Loss 2.0762e+00 (2.0804e+00)	Prompt Acc@1  89.06 ( 88.80)
Validate: [75/79]	Time  0.220 ( 0.231)	Loss 2.0684e+00 (2.0799e+00)	Prompt Acc@1  95.31 ( 89.14)
 * Prompt Acc@1 89.110
There's no improvement for 6 epochs.
Training mode
Epoch: [7][  0/313]	Time  1.130 ( 1.130)	Data  0.690 ( 0.690)	Loss 2.0781e+00 (2.0781e+00)	Acc@1  91.41 ( 91.41)
Epoch: [7][ 25/313]	Time  0.421 ( 0.451)	Data  0.015 ( 0.043)	Loss 2.0801e+00 (2.0808e+00)	Acc@1  91.41 ( 89.60)
Epoch: [7][ 50/313]	Time  0.440 ( 0.437)	Data  0.016 ( 0.030)	Loss 2.0820e+00 (2.0806e+00)	Acc@1  82.81 ( 89.34)
Epoch: [7][ 75/313]	Time  0.430 ( 0.433)	Data  0.017 ( 0.025)	Loss 2.0762e+00 (2.0810e+00)	Acc@1  91.41 ( 88.86)
Epoch: [7][100/313]	Time  0.424 ( 0.431)	Data  0.015 ( 0.023)	Loss 2.0918e+00 (2.0804e+00)	Acc@1  85.94 ( 88.71)
Epoch: [7][125/313]	Time  0.426 ( 0.429)	Data  0.015 ( 0.022)	Loss 2.0820e+00 (2.0804e+00)	Acc@1  86.72 ( 88.77)
Epoch: [7][150/313]	Time  0.419 ( 0.429)	Data  0.017 ( 0.021)	Loss 2.0762e+00 (2.0804e+00)	Acc@1  88.28 ( 88.78)
Epoch: [7][175/313]	Time  0.431 ( 0.428)	Data  0.016 ( 0.020)	Loss 2.0625e+00 (2.0803e+00)	Acc@1  92.97 ( 88.73)
Epoch: [7][200/313]	Time  0.421 ( 0.427)	Data  0.017 ( 0.020)	Loss 2.0859e+00 (2.0804e+00)	Acc@1  84.38 ( 88.66)
Epoch: [7][225/313]	Time  0.421 ( 0.427)	Data  0.016 ( 0.019)	Loss 2.0918e+00 (2.0801e+00)	Acc@1  84.38 ( 88.73)
Epoch: [7][250/313]	Time  0.425 ( 0.427)	Data  0.015 ( 0.019)	Loss 2.0820e+00 (2.0800e+00)	Acc@1  82.81 ( 88.68)
Epoch: [7][275/313]	Time  0.426 ( 0.426)	Data  0.016 ( 0.019)	Loss 2.0840e+00 (2.0798e+00)	Acc@1  86.72 ( 88.74)
Epoch: [7][300/313]	Time  0.445 ( 0.426)	Data  0.017 ( 0.019)	Loss 2.0703e+00 (2.0797e+00)	Acc@1  90.62 ( 88.80)
Validate: [ 0/79]	Time  0.925 ( 0.925)	Loss 2.0820e+00 (2.0820e+00)	Prompt Acc@1  88.28 ( 88.28)
Validate: [25/79]	Time  0.221 ( 0.252)	Loss 2.0820e+00 (2.0793e+00)	Prompt Acc@1  90.62 ( 88.97)
Validate: [50/79]	Time  0.226 ( 0.238)	Loss 2.0762e+00 (2.0797e+00)	Prompt Acc@1  88.28 ( 89.12)
Validate: [75/79]	Time  0.219 ( 0.233)	Loss 2.0684e+00 (2.0792e+00)	Prompt Acc@1  93.75 ( 89.34)
 * Prompt Acc@1 89.260
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Traceback (most recent call last):
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//main.py", line 150, in <module>
    main()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/.//main.py", line 144, in main
    learn.run()
  File "/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/learner.py", line 178, in run
    f.write(f"Method {self.args.method}, Prompt_size {self.args.prompt_size} -- Acc: {acc1}, best Acc: {self.best_acc1}\n")
NameError: name 'acc' is not defined. Did you mean: 'acc1'?
Running experiment on cifar10 with padding and prompt size 30
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='padding', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar10', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/padding_30_cifar10_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a airplane',
 'This is a photo of a automobile',
 'This is a photo of a bird',
 'This is a photo of a cat',
 'This is a photo of a deer',
 'This is a photo of a dog',
 'This is a photo of a frog',
 'This is a photo of a horse',
 'This is a photo of a ship',
 'This is a photo of a truck']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
("Parameters to be updated: {'prompt_learner.pad_right', "
 "'prompt_learner.pad_left', 'prompt_learner.pad_down', "
 "'prompt_learner.pad_up'}")
Number of prompt parameters:  69840
Training mode
Epoch: [0][  0/313]	Time  2.280 ( 2.280)	Data  0.728 ( 0.728)	Loss 2.1250e+00 (2.1250e+00)	Acc@1  74.22 ( 74.22)
Epoch: [0][ 25/313]	Time  0.425 ( 0.495)	Data  0.015 ( 0.043)	Loss 2.1289e+00 (2.1230e+00)	Acc@1  75.78 ( 76.95)
Epoch: [0][ 50/313]	Time  0.424 ( 0.461)	Data  0.016 ( 0.030)	Loss 2.1211e+00 (2.1191e+00)	Acc@1  76.56 ( 77.63)
Epoch: [0][ 75/313]	Time  0.425 ( 0.450)	Data  0.016 ( 0.026)	Loss 2.1191e+00 (2.1153e+00)	Acc@1  75.00 ( 78.78)
Epoch: [0][100/313]	Time  0.433 ( 0.444)	Data  0.015 ( 0.023)	Loss 2.0859e+00 (2.1102e+00)	Acc@1  89.84 ( 80.02)
Epoch: [0][125/313]	Time  0.444 ( 0.440)	Data  0.015 ( 0.022)	Loss 2.0879e+00 (2.1056e+00)	Acc@1  86.72 ( 81.05)
Epoch: [0][150/313]	Time  0.424 ( 0.438)	Data  0.015 ( 0.021)	Loss 2.0684e+00 (2.1009e+00)	Acc@1  89.84 ( 81.88)
Epoch: [0][175/313]	Time  0.436 ( 0.437)	Data  0.015 ( 0.020)	Loss 2.0781e+00 (2.0963e+00)	Acc@1  81.25 ( 82.50)
Epoch: [0][200/313]	Time  0.427 ( 0.436)	Data  0.017 ( 0.020)	Loss 2.0625e+00 (2.0920e+00)	Acc@1  83.59 ( 83.03)
Epoch: [0][225/313]	Time  0.419 ( 0.435)	Data  0.016 ( 0.020)	Loss 2.0527e+00 (2.0881e+00)	Acc@1  88.28 ( 83.50)
Epoch: [0][250/313]	Time  0.423 ( 0.434)	Data  0.015 ( 0.019)	Loss 2.0488e+00 (2.0842e+00)	Acc@1  87.50 ( 83.89)
Epoch: [0][275/313]	Time  0.424 ( 0.433)	Data  0.015 ( 0.019)	Loss 2.0332e+00 (2.0806e+00)	Acc@1  86.72 ( 84.21)
Epoch: [0][300/313]	Time  0.428 ( 0.433)	Data  0.015 ( 0.019)	Loss 2.0469e+00 (2.0773e+00)	Acc@1  86.72 ( 84.38)
Validate: [ 0/79]	Time  1.037 ( 1.037)	Loss 2.0410e+00 (2.0410e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.238 ( 0.254)	Loss 2.0176e+00 (2.0342e+00)	Prompt Acc@1  94.53 ( 86.90)
Validate: [50/79]	Time  0.221 ( 0.238)	Loss 2.0332e+00 (2.0336e+00)	Prompt Acc@1  88.28 ( 86.98)
Validate: [75/79]	Time  0.218 ( 0.233)	Loss 2.0332e+00 (2.0339e+00)	Prompt Acc@1  87.50 ( 86.71)
 * Prompt Acc@1 86.720
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.127 ( 1.127)	Data  0.687 ( 0.687)	Loss 2.0430e+00 (2.0430e+00)	Acc@1  85.16 ( 85.16)
Epoch: [1][ 25/313]	Time  0.427 ( 0.455)	Data  0.016 ( 0.043)	Loss 2.0215e+00 (2.0246e+00)	Acc@1  89.06 ( 87.68)
Epoch: [1][ 50/313]	Time  0.427 ( 0.443)	Data  0.016 ( 0.030)	Loss 2.0059e+00 (2.0167e+00)	Acc@1  82.81 ( 86.99)
Epoch: [1][ 75/313]	Time  0.429 ( 0.439)	Data  0.017 ( 0.026)	Loss 2.0000e+00 (2.0073e+00)	Acc@1  78.12 ( 86.75)
Epoch: [1][100/313]	Time  0.431 ( 0.436)	Data  0.020 ( 0.024)	Loss 1.9521e+00 (1.9965e+00)	Acc@1  93.75 ( 86.67)
Epoch: [1][125/313]	Time  0.422 ( 0.435)	Data  0.016 ( 0.023)	Loss 1.9531e+00 (1.9877e+00)	Acc@1  85.16 ( 86.68)
Epoch: [1][150/313]	Time  0.428 ( 0.433)	Data  0.015 ( 0.022)	Loss 1.9219e+00 (1.9800e+00)	Acc@1  90.62 ( 86.69)
Epoch: [1][175/313]	Time  0.443 ( 0.433)	Data  0.028 ( 0.021)	Loss 1.9346e+00 (1.9724e+00)	Acc@1  79.69 ( 86.62)
Epoch: [1][200/313]	Time  0.427 ( 0.432)	Data  0.017 ( 0.020)	Loss 1.9072e+00 (1.9659e+00)	Acc@1  86.72 ( 86.63)
Epoch: [1][225/313]	Time  0.424 ( 0.431)	Data  0.018 ( 0.020)	Loss 1.9033e+00 (1.9593e+00)	Acc@1  83.59 ( 86.60)
Epoch: [1][250/313]	Time  0.436 ( 0.431)	Data  0.022 ( 0.020)	Loss 1.8926e+00 (1.9527e+00)	Acc@1  85.94 ( 86.56)
Epoch: [1][275/313]	Time  0.429 ( 0.431)	Data  0.016 ( 0.019)	Loss 1.8760e+00 (1.9467e+00)	Acc@1  86.72 ( 86.59)
Epoch: [1][300/313]	Time  0.429 ( 0.431)	Data  0.015 ( 0.019)	Loss 1.8887e+00 (1.9413e+00)	Acc@1  85.94 ( 86.51)
Validate: [ 0/79]	Time  0.966 ( 0.966)	Loss 1.8789e+00 (1.8789e+00)	Prompt Acc@1  88.28 ( 88.28)
Validate: [25/79]	Time  0.224 ( 0.256)	Loss 1.8555e+00 (1.8759e+00)	Prompt Acc@1  92.97 ( 86.48)
Validate: [50/79]	Time  0.219 ( 0.239)	Loss 1.8604e+00 (1.8753e+00)	Prompt Acc@1  87.50 ( 86.24)
Validate: [75/79]	Time  0.221 ( 0.233)	Loss 1.8760e+00 (1.8756e+00)	Prompt Acc@1  85.16 ( 86.22)
 * Prompt Acc@1 86.340
There's no improvement for 1 epochs.
Training mode
Epoch: [2][  0/313]	Time  1.196 ( 1.196)	Data  0.765 ( 0.765)	Loss 1.8945e+00 (1.8945e+00)	Acc@1  82.81 ( 82.81)
Epoch: [2][ 25/313]	Time  0.431 ( 0.458)	Data  0.016 ( 0.047)	Loss 1.8770e+00 (1.8677e+00)	Acc@1  85.94 ( 86.15)
Epoch: [2][ 50/313]	Time  0.429 ( 0.443)	Data  0.017 ( 0.032)	Loss 1.8838e+00 (1.8654e+00)	Acc@1  82.03 ( 85.89)
Epoch: [2][ 75/313]	Time  0.423 ( 0.438)	Data  0.016 ( 0.027)	Loss 1.8691e+00 (1.8641e+00)	Acc@1  83.59 ( 85.62)
Epoch: [2][100/313]	Time  0.429 ( 0.436)	Data  0.016 ( 0.024)	Loss 1.8477e+00 (1.8597e+00)	Acc@1  89.84 ( 85.84)
Epoch: [2][125/313]	Time  0.424 ( 0.434)	Data  0.017 ( 0.023)	Loss 1.8428e+00 (1.8565e+00)	Acc@1  84.38 ( 85.96)
Epoch: [2][150/313]	Time  0.425 ( 0.434)	Data  0.016 ( 0.022)	Loss 1.8135e+00 (1.8537e+00)	Acc@1  91.41 ( 86.08)
Epoch: [2][175/313]	Time  0.435 ( 0.433)	Data  0.018 ( 0.022)	Loss 1.8438e+00 (1.8502e+00)	Acc@1  82.03 ( 86.10)
Epoch: [2][200/313]	Time  0.436 ( 0.433)	Data  0.017 ( 0.021)	Loss 1.8154e+00 (1.8478e+00)	Acc@1  89.06 ( 86.15)
Epoch: [2][225/313]	Time  0.430 ( 0.432)	Data  0.016 ( 0.021)	Loss 1.8301e+00 (1.8447e+00)	Acc@1  85.94 ( 86.27)
Epoch: [2][250/313]	Time  0.427 ( 0.432)	Data  0.017 ( 0.020)	Loss 1.8193e+00 (1.8415e+00)	Acc@1  82.81 ( 86.28)
Epoch: [2][275/313]	Time  0.440 ( 0.432)	Data  0.017 ( 0.020)	Loss 1.8086e+00 (1.8388e+00)	Acc@1  88.28 ( 86.36)
Epoch: [2][300/313]	Time  0.423 ( 0.431)	Data  0.016 ( 0.020)	Loss 1.8164e+00 (1.8364e+00)	Acc@1  85.16 ( 86.28)
Validate: [ 0/79]	Time  1.030 ( 1.030)	Loss 1.7988e+00 (1.7988e+00)	Prompt Acc@1  90.62 ( 90.62)
Validate: [25/79]	Time  0.225 ( 0.256)	Loss 1.7900e+00 (1.8059e+00)	Prompt Acc@1  88.28 ( 86.54)
Validate: [50/79]	Time  0.221 ( 0.241)	Loss 1.7881e+00 (1.8053e+00)	Prompt Acc@1  88.28 ( 86.43)
Validate: [75/79]	Time  0.220 ( 0.235)	Loss 1.8027e+00 (1.8059e+00)	Prompt Acc@1  86.72 ( 86.39)
 * Prompt Acc@1 86.450
There's no improvement for 2 epochs.
Training mode
Epoch: [3][  0/313]	Time  1.167 ( 1.167)	Data  0.753 ( 0.753)	Loss 1.8350e+00 (1.8350e+00)	Acc@1  79.69 ( 79.69)
Epoch: [3][ 25/313]	Time  0.423 ( 0.456)	Data  0.016 ( 0.045)	Loss 1.8105e+00 (1.8028e+00)	Acc@1  85.16 ( 85.88)
Epoch: [3][ 50/313]	Time  0.430 ( 0.443)	Data  0.024 ( 0.032)	Loss 1.8232e+00 (1.8005e+00)	Acc@1  82.81 ( 85.91)
Epoch: [3][ 75/313]	Time  0.427 ( 0.439)	Data  0.017 ( 0.027)	Loss 1.8086e+00 (1.8004e+00)	Acc@1  82.81 ( 85.74)
Epoch: [3][100/313]	Time  0.423 ( 0.437)	Data  0.016 ( 0.025)	Loss 1.7959e+00 (1.7970e+00)	Acc@1  85.16 ( 85.87)
Epoch: [3][125/313]	Time  0.426 ( 0.436)	Data  0.016 ( 0.023)	Loss 1.7812e+00 (1.7949e+00)	Acc@1  89.06 ( 86.05)
Epoch: [3][150/313]	Time  0.427 ( 0.435)	Data  0.018 ( 0.022)	Loss 1.7568e+00 (1.7928e+00)	Acc@1  89.84 ( 86.12)
Epoch: [3][175/313]	Time  0.425 ( 0.435)	Data  0.016 ( 0.021)	Loss 1.7930e+00 (1.7903e+00)	Acc@1  82.03 ( 86.17)
Epoch: [3][200/313]	Time  0.427 ( 0.434)	Data  0.017 ( 0.021)	Loss 1.7598e+00 (1.7885e+00)	Acc@1  88.28 ( 86.24)
Epoch: [3][225/313]	Time  0.428 ( 0.434)	Data  0.018 ( 0.020)	Loss 1.7773e+00 (1.7861e+00)	Acc@1  85.94 ( 86.42)
Epoch: [3][250/313]	Time  0.432 ( 0.434)	Data  0.016 ( 0.020)	Loss 1.7695e+00 (1.7838e+00)	Acc@1  85.16 ( 86.44)
Epoch: [3][275/313]	Time  0.436 ( 0.434)	Data  0.018 ( 0.020)	Loss 1.7627e+00 (1.7819e+00)	Acc@1  90.62 ( 86.53)
Epoch: [3][300/313]	Time  0.430 ( 0.434)	Data  0.016 ( 0.020)	Loss 1.7734e+00 (1.7803e+00)	Acc@1  83.59 ( 86.50)
Validate: [ 0/79]	Time  0.915 ( 0.915)	Loss 1.7520e+00 (1.7520e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.222 ( 0.254)	Loss 1.7471e+00 (1.7612e+00)	Prompt Acc@1  89.84 ( 86.99)
Validate: [50/79]	Time  0.234 ( 0.240)	Loss 1.7422e+00 (1.7600e+00)	Prompt Acc@1  89.06 ( 87.03)
Validate: [75/79]	Time  0.222 ( 0.234)	Loss 1.7588e+00 (1.7608e+00)	Prompt Acc@1  85.16 ( 86.88)
 * Prompt Acc@1 86.960
saved best file
Training mode
Epoch: [4][  0/313]	Time  1.280 ( 1.280)	Data  0.849 ( 0.849)	Loss 1.7891e+00 (1.7891e+00)	Acc@1  80.47 ( 80.47)
Epoch: [4][ 25/313]	Time  0.427 ( 0.464)	Data  0.017 ( 0.049)	Loss 1.7686e+00 (1.7594e+00)	Acc@1  84.38 ( 86.69)
Epoch: [4][ 50/313]	Time  0.426 ( 0.448)	Data  0.016 ( 0.033)	Loss 1.7812e+00 (1.7584e+00)	Acc@1  82.03 ( 86.34)
Epoch: [4][ 75/313]	Time  0.435 ( 0.443)	Data  0.018 ( 0.028)	Loss 1.7676e+00 (1.7585e+00)	Acc@1  83.59 ( 86.24)
Epoch: [4][100/313]	Time  0.429 ( 0.440)	Data  0.017 ( 0.025)	Loss 1.7578e+00 (1.7557e+00)	Acc@1  84.38 ( 86.36)
Epoch: [4][125/313]	Time  0.436 ( 0.438)	Data  0.024 ( 0.024)	Loss 1.7412e+00 (1.7545e+00)	Acc@1  89.84 ( 86.50)
Epoch: [4][150/313]	Time  0.435 ( 0.437)	Data  0.017 ( 0.023)	Loss 1.7197e+00 (1.7529e+00)	Acc@1  89.84 ( 86.61)
Epoch: [4][175/313]	Time  0.432 ( 0.436)	Data  0.016 ( 0.022)	Loss 1.7617e+00 (1.7510e+00)	Acc@1  82.03 ( 86.60)
Epoch: [4][200/313]	Time  0.433 ( 0.435)	Data  0.016 ( 0.021)	Loss 1.7266e+00 (1.7496e+00)	Acc@1  87.50 ( 86.65)
Epoch: [4][225/313]	Time  0.434 ( 0.435)	Data  0.016 ( 0.021)	Loss 1.7451e+00 (1.7478e+00)	Acc@1  82.81 ( 86.71)
Epoch: [4][250/313]	Time  0.439 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.7354e+00 (1.7459e+00)	Acc@1  84.38 ( 86.67)
Epoch: [4][275/313]	Time  0.428 ( 0.434)	Data  0.017 ( 0.020)	Loss 1.7324e+00 (1.7445e+00)	Acc@1  89.84 ( 86.80)
Epoch: [4][300/313]	Time  0.426 ( 0.434)	Data  0.017 ( 0.020)	Loss 1.7402e+00 (1.7434e+00)	Acc@1  82.81 ( 86.77)
Validate: [ 0/79]	Time  0.949 ( 0.949)	Loss 1.7168e+00 (1.7168e+00)	Prompt Acc@1  89.84 ( 89.84)
Validate: [25/79]	Time  0.222 ( 0.260)	Loss 1.7158e+00 (1.7293e+00)	Prompt Acc@1  91.41 ( 87.26)
Validate: [50/79]	Time  0.221 ( 0.243)	Loss 1.7090e+00 (1.7280e+00)	Prompt Acc@1  89.06 ( 87.12)
Validate: [75/79]	Time  0.220 ( 0.238)	Loss 1.7246e+00 (1.7287e+00)	Prompt Acc@1  86.72 ( 86.92)
 * Prompt Acc@1 86.970
saved best file
Training mode
Epoch: [5][  0/313]	Time  1.180 ( 1.180)	Data  0.731 ( 0.731)	Loss 1.7568e+00 (1.7568e+00)	Acc@1  81.25 ( 81.25)
Epoch: [5][ 25/313]	Time  0.425 ( 0.463)	Data  0.016 ( 0.046)	Loss 1.7422e+00 (1.7273e+00)	Acc@1  84.38 ( 86.48)
Epoch: [5][ 50/313]	Time  0.428 ( 0.447)	Data  0.016 ( 0.032)	Loss 1.7480e+00 (1.7265e+00)	Acc@1  82.81 ( 86.41)
Epoch: [5][ 75/313]	Time  0.436 ( 0.442)	Data  0.017 ( 0.027)	Loss 1.7373e+00 (1.7271e+00)	Acc@1  84.38 ( 86.32)
Epoch: [5][100/313]	Time  0.428 ( 0.439)	Data  0.016 ( 0.024)	Loss 1.7305e+00 (1.7246e+00)	Acc@1  86.72 ( 86.44)
Epoch: [5][125/313]	Time  0.431 ( 0.438)	Data  0.019 ( 0.023)	Loss 1.7139e+00 (1.7239e+00)	Acc@1  89.06 ( 86.46)
Epoch: [5][150/313]	Time  0.431 ( 0.437)	Data  0.016 ( 0.022)	Loss 1.6904e+00 (1.7227e+00)	Acc@1  90.62 ( 86.60)
Epoch: [5][175/313]	Time  0.431 ( 0.436)	Data  0.015 ( 0.021)	Loss 1.7363e+00 (1.7212e+00)	Acc@1  81.25 ( 86.63)
Epoch: [5][200/313]	Time  0.434 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.7041e+00 (1.7202e+00)	Acc@1  87.50 ( 86.70)
Epoch: [5][225/313]	Time  0.435 ( 0.435)	Data  0.015 ( 0.020)	Loss 1.7178e+00 (1.7188e+00)	Acc@1  82.03 ( 86.73)
Epoch: [5][250/313]	Time  0.434 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.7100e+00 (1.7171e+00)	Acc@1  85.16 ( 86.74)
Epoch: [5][275/313]	Time  0.433 ( 0.434)	Data  0.016 ( 0.020)	Loss 1.7051e+00 (1.7161e+00)	Acc@1  89.06 ( 86.85)
Epoch: [5][300/313]	Time  0.426 ( 0.434)	Data  0.017 ( 0.019)	Loss 1.7119e+00 (1.7154e+00)	Acc@1  85.16 ( 86.78)
Validate: [ 0/79]	Time  0.978 ( 0.978)	Loss 1.6953e+00 (1.6953e+00)	Prompt Acc@1  88.28 ( 88.28)
Validate: [25/79]	Time  0.220 ( 0.254)	Loss 1.6943e+00 (1.7055e+00)	Prompt Acc@1  89.84 ( 87.11)
Validate: [50/79]	Time  0.220 ( 0.238)	Loss 1.6797e+00 (1.7042e+00)	Prompt Acc@1  89.84 ( 86.96)
Validate: [75/79]	Time  0.219 ( 0.232)	Loss 1.7012e+00 (1.7049e+00)	Prompt Acc@1  87.50 ( 86.86)
 * Prompt Acc@1 86.900
There's no improvement for 1 epochs.
Training mode
Epoch: [6][  0/313]	Time  1.207 ( 1.207)	Data  0.782 ( 0.782)	Loss 1.7334e+00 (1.7334e+00)	Acc@1  83.59 ( 83.59)
Epoch: [6][ 25/313]	Time  0.429 ( 0.462)	Data  0.017 ( 0.047)	Loss 1.7197e+00 (1.7034e+00)	Acc@1  85.94 ( 86.84)
Epoch: [6][ 50/313]	Time  0.428 ( 0.447)	Data  0.018 ( 0.032)	Loss 1.7266e+00 (1.7031e+00)	Acc@1  82.03 ( 86.60)
Epoch: [6][ 75/313]	Time  0.430 ( 0.443)	Data  0.017 ( 0.028)	Loss 1.7158e+00 (1.7039e+00)	Acc@1  85.94 ( 86.44)
Epoch: [6][100/313]	Time  0.427 ( 0.441)	Data  0.017 ( 0.025)	Loss 1.7061e+00 (1.7017e+00)	Acc@1  85.94 ( 86.48)
Epoch: [6][125/313]	Time  0.433 ( 0.439)	Data  0.017 ( 0.024)	Loss 1.6904e+00 (1.7013e+00)	Acc@1  89.06 ( 86.51)
Epoch: [6][150/313]	Time  0.433 ( 0.438)	Data  0.018 ( 0.022)	Loss 1.6650e+00 (1.7002e+00)	Acc@1  93.75 ( 86.70)
Epoch: [6][175/313]	Time  0.430 ( 0.437)	Data  0.016 ( 0.022)	Loss 1.7197e+00 (1.6990e+00)	Acc@1  80.47 ( 86.72)
Epoch: [6][200/313]	Time  0.438 ( 0.436)	Data  0.017 ( 0.021)	Loss 1.6846e+00 (1.6982e+00)	Acc@1  88.28 ( 86.82)
Epoch: [6][225/313]	Time  0.433 ( 0.436)	Data  0.017 ( 0.021)	Loss 1.6982e+00 (1.6970e+00)	Acc@1  82.81 ( 86.86)
Epoch: [6][250/313]	Time  0.434 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6934e+00 (1.6956e+00)	Acc@1  84.38 ( 86.85)
Epoch: [6][275/313]	Time  0.437 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6836e+00 (1.6947e+00)	Acc@1  89.06 ( 86.93)
Epoch: [6][300/313]	Time  0.435 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6934e+00 (1.6942e+00)	Acc@1  86.72 ( 86.86)
Validate: [ 0/79]	Time  0.993 ( 0.993)	Loss 1.6797e+00 (1.6797e+00)	Prompt Acc@1  88.28 ( 88.28)
Validate: [25/79]	Time  0.224 ( 0.258)	Loss 1.6768e+00 (1.6870e+00)	Prompt Acc@1  89.84 ( 87.23)
Validate: [50/79]	Time  0.219 ( 0.241)	Loss 1.6602e+00 (1.6857e+00)	Prompt Acc@1  89.84 ( 87.03)
Validate: [75/79]	Time  0.220 ( 0.235)	Loss 1.6826e+00 (1.6864e+00)	Prompt Acc@1  86.72 ( 86.94)
 * Prompt Acc@1 86.990
saved best file
Training mode
Epoch: [7][  0/313]	Time  1.228 ( 1.228)	Data  0.775 ( 0.775)	Loss 1.7178e+00 (1.7178e+00)	Acc@1  82.81 ( 82.81)
Epoch: [7][ 25/313]	Time  0.433 ( 0.463)	Data  0.018 ( 0.047)	Loss 1.7031e+00 (1.6854e+00)	Acc@1  85.16 ( 86.99)
Epoch: [7][ 50/313]	Time  0.425 ( 0.448)	Data  0.016 ( 0.032)	Loss 1.7090e+00 (1.6852e+00)	Acc@1  82.03 ( 86.69)
Epoch: [7][ 75/313]	Time  0.427 ( 0.443)	Data  0.017 ( 0.027)	Loss 1.6982e+00 (1.6860e+00)	Acc@1  85.94 ( 86.61)
Epoch: [7][100/313]	Time  0.426 ( 0.440)	Data  0.017 ( 0.025)	Loss 1.6904e+00 (1.6838e+00)	Acc@1  85.94 ( 86.69)
Epoch: [7][125/313]	Time  0.432 ( 0.438)	Data  0.016 ( 0.023)	Loss 1.6729e+00 (1.6835e+00)	Acc@1  89.06 ( 86.66)
Epoch: [7][150/313]	Time  0.432 ( 0.437)	Data  0.022 ( 0.022)	Loss 1.6455e+00 (1.6825e+00)	Acc@1  93.75 ( 86.81)
Epoch: [7][175/313]	Time  0.437 ( 0.437)	Data  0.017 ( 0.021)	Loss 1.7051e+00 (1.6813e+00)	Acc@1  80.47 ( 86.84)
Epoch: [7][200/313]	Time  0.431 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.6680e+00 (1.6807e+00)	Acc@1  88.28 ( 86.91)
Epoch: [7][225/313]	Time  0.426 ( 0.436)	Data  0.017 ( 0.021)	Loss 1.6826e+00 (1.6795e+00)	Acc@1  82.81 ( 86.88)
Epoch: [7][250/313]	Time  0.424 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6768e+00 (1.6782e+00)	Acc@1  82.81 ( 86.85)
Epoch: [7][275/313]	Time  0.432 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6680e+00 (1.6774e+00)	Acc@1  88.28 ( 86.95)
Epoch: [7][300/313]	Time  0.442 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6758e+00 (1.6770e+00)	Acc@1  86.72 ( 86.90)
Validate: [ 0/79]	Time  0.930 ( 0.930)	Loss 1.6650e+00 (1.6650e+00)	Prompt Acc@1  89.06 ( 89.06)
Validate: [25/79]	Time  0.223 ( 0.253)	Loss 1.6611e+00 (1.6713e+00)	Prompt Acc@1  88.28 ( 87.35)
Validate: [50/79]	Time  0.221 ( 0.238)	Loss 1.6445e+00 (1.6701e+00)	Prompt Acc@1  91.41 ( 87.19)
Validate: [75/79]	Time  0.222 ( 0.233)	Loss 1.6650e+00 (1.6710e+00)	Prompt Acc@1  88.28 ( 87.07)
 * Prompt Acc@1 87.130
saved best file
Training mode
Epoch: [8][  0/313]	Time  1.213 ( 1.213)	Data  0.792 ( 0.792)	Loss 1.7051e+00 (1.7051e+00)	Acc@1  82.03 ( 82.03)
Epoch: [8][ 25/313]	Time  0.435 ( 0.462)	Data  0.016 ( 0.047)	Loss 1.6875e+00 (1.6700e+00)	Acc@1  85.94 ( 87.17)
Epoch: [8][ 50/313]	Time  0.435 ( 0.446)	Data  0.021 ( 0.032)	Loss 1.6953e+00 (1.6697e+00)	Acc@1  81.25 ( 86.75)
Epoch: [8][ 75/313]	Time  0.432 ( 0.441)	Data  0.016 ( 0.027)	Loss 1.6816e+00 (1.6705e+00)	Acc@1  85.16 ( 86.67)
Epoch: [8][100/313]	Time  0.431 ( 0.439)	Data  0.016 ( 0.025)	Loss 1.6758e+00 (1.6684e+00)	Acc@1  86.72 ( 86.74)
Epoch: [8][125/313]	Time  0.444 ( 0.437)	Data  0.016 ( 0.023)	Loss 1.6602e+00 (1.6683e+00)	Acc@1  87.50 ( 86.70)
Epoch: [8][150/313]	Time  0.446 ( 0.436)	Data  0.018 ( 0.022)	Loss 1.6299e+00 (1.6674e+00)	Acc@1  93.75 ( 86.86)
Epoch: [8][175/313]	Time  0.427 ( 0.436)	Data  0.016 ( 0.022)	Loss 1.6895e+00 (1.6663e+00)	Acc@1  82.03 ( 86.91)
Epoch: [8][200/313]	Time  0.430 ( 0.435)	Data  0.016 ( 0.021)	Loss 1.6543e+00 (1.6657e+00)	Acc@1  88.28 ( 86.97)
Epoch: [8][225/313]	Time  0.434 ( 0.435)	Data  0.022 ( 0.021)	Loss 1.6689e+00 (1.6647e+00)	Acc@1  82.81 ( 86.97)
Epoch: [8][250/313]	Time  0.431 ( 0.435)	Data  0.017 ( 0.021)	Loss 1.6631e+00 (1.6635e+00)	Acc@1  83.59 ( 86.95)
Epoch: [8][275/313]	Time  0.435 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6553e+00 (1.6627e+00)	Acc@1  87.50 ( 87.03)
Epoch: [8][300/313]	Time  0.429 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6621e+00 (1.6625e+00)	Acc@1  89.06 ( 87.00)
Validate: [ 0/79]	Time  0.899 ( 0.899)	Loss 1.6562e+00 (1.6562e+00)	Prompt Acc@1  89.06 ( 89.06)
Validate: [25/79]	Time  0.221 ( 0.255)	Loss 1.6475e+00 (1.6587e+00)	Prompt Acc@1  88.28 ( 87.50)
Validate: [50/79]	Time  0.218 ( 0.239)	Loss 1.6299e+00 (1.6575e+00)	Prompt Acc@1  91.41 ( 87.24)
Validate: [75/79]	Time  0.221 ( 0.233)	Loss 1.6523e+00 (1.6585e+00)	Prompt Acc@1  89.06 ( 87.13)
 * Prompt Acc@1 87.210
saved best file
Training mode
Epoch: [9][  0/313]	Time  1.176 ( 1.176)	Data  0.745 ( 0.745)	Loss 1.6943e+00 (1.6943e+00)	Acc@1  81.25 ( 81.25)
Epoch: [9][ 25/313]	Time  0.429 ( 0.460)	Data  0.017 ( 0.045)	Loss 1.6758e+00 (1.6575e+00)	Acc@1  84.38 ( 87.29)
Epoch: [9][ 50/313]	Time  0.425 ( 0.446)	Data  0.016 ( 0.031)	Loss 1.6846e+00 (1.6572e+00)	Acc@1  81.25 ( 86.80)
Epoch: [9][ 75/313]	Time  0.433 ( 0.442)	Data  0.015 ( 0.027)	Loss 1.6689e+00 (1.6580e+00)	Acc@1  85.16 ( 86.80)
Epoch: [9][100/313]	Time  0.444 ( 0.440)	Data  0.016 ( 0.024)	Loss 1.6641e+00 (1.6560e+00)	Acc@1  86.72 ( 86.77)
Epoch: [9][125/313]	Time  0.431 ( 0.438)	Data  0.022 ( 0.023)	Loss 1.6514e+00 (1.6561e+00)	Acc@1  87.50 ( 86.76)
Epoch: [9][150/313]	Time  0.434 ( 0.437)	Data  0.017 ( 0.022)	Loss 1.6172e+00 (1.6553e+00)	Acc@1  94.53 ( 86.91)
Epoch: [9][175/313]	Time  0.431 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.6777e+00 (1.6542e+00)	Acc@1  81.25 ( 86.95)
Epoch: [9][200/313]	Time  0.429 ( 0.435)	Data  0.016 ( 0.021)	Loss 1.6426e+00 (1.6537e+00)	Acc@1  87.50 ( 87.02)
Epoch: [9][225/313]	Time  0.433 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6572e+00 (1.6527e+00)	Acc@1  82.81 ( 87.03)
Epoch: [9][250/313]	Time  0.438 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6533e+00 (1.6515e+00)	Acc@1  83.59 ( 87.03)
Epoch: [9][275/313]	Time  0.430 ( 0.434)	Data  0.016 ( 0.020)	Loss 1.6475e+00 (1.6509e+00)	Acc@1  87.50 ( 87.11)
Epoch: [9][300/313]	Time  0.433 ( 0.434)	Data  0.016 ( 0.019)	Loss 1.6514e+00 (1.6508e+00)	Acc@1  88.28 ( 87.07)
Validate: [ 0/79]	Time  0.934 ( 0.934)	Loss 1.6484e+00 (1.6484e+00)	Prompt Acc@1  89.06 ( 89.06)
Validate: [25/79]	Time  0.221 ( 0.254)	Loss 1.6377e+00 (1.6480e+00)	Prompt Acc@1  89.06 ( 87.47)
Validate: [50/79]	Time  0.226 ( 0.239)	Loss 1.6191e+00 (1.6468e+00)	Prompt Acc@1  91.41 ( 87.18)
Validate: [75/79]	Time  0.220 ( 0.233)	Loss 1.6426e+00 (1.6479e+00)	Prompt Acc@1  89.06 ( 87.04)
 * Prompt Acc@1 87.120
There's no improvement for 1 epochs.
Training mode
Epoch: [10][  0/313]	Time  1.222 ( 1.222)	Data  0.774 ( 0.774)	Loss 1.6855e+00 (1.6855e+00)	Acc@1  80.47 ( 80.47)
Epoch: [10][ 25/313]	Time  0.435 ( 0.464)	Data  0.016 ( 0.047)	Loss 1.6650e+00 (1.6466e+00)	Acc@1  85.94 ( 87.47)
Epoch: [10][ 50/313]	Time  0.432 ( 0.449)	Data  0.017 ( 0.033)	Loss 1.6738e+00 (1.6464e+00)	Acc@1  82.03 ( 86.95)
Epoch: [10][ 75/313]	Time  0.424 ( 0.444)	Data  0.016 ( 0.028)	Loss 1.6572e+00 (1.6472e+00)	Acc@1  85.16 ( 86.99)
Epoch: [10][100/313]	Time  0.426 ( 0.440)	Data  0.017 ( 0.025)	Loss 1.6543e+00 (1.6454e+00)	Acc@1  87.50 ( 86.91)
Epoch: [10][125/313]	Time  0.430 ( 0.438)	Data  0.016 ( 0.023)	Loss 1.6426e+00 (1.6456e+00)	Acc@1  87.50 ( 86.94)
Epoch: [10][150/313]	Time  0.445 ( 0.437)	Data  0.017 ( 0.022)	Loss 1.6074e+00 (1.6449e+00)	Acc@1  94.53 ( 87.07)
Epoch: [10][175/313]	Time  0.434 ( 0.436)	Data  0.017 ( 0.021)	Loss 1.6660e+00 (1.6439e+00)	Acc@1  80.47 ( 87.14)
Epoch: [10][200/313]	Time  0.436 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.6338e+00 (1.6434e+00)	Acc@1  89.84 ( 87.22)
Epoch: [10][225/313]	Time  0.431 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6475e+00 (1.6425e+00)	Acc@1  82.81 ( 87.23)
Epoch: [10][250/313]	Time  0.437 ( 0.435)	Data  0.027 ( 0.020)	Loss 1.6455e+00 (1.6415e+00)	Acc@1  84.38 ( 87.21)
Epoch: [10][275/313]	Time  0.426 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6396e+00 (1.6409e+00)	Acc@1  87.50 ( 87.30)
Epoch: [10][300/313]	Time  0.431 ( 0.434)	Data  0.016 ( 0.019)	Loss 1.6436e+00 (1.6408e+00)	Acc@1  85.94 ( 87.24)
Validate: [ 0/79]	Time  0.944 ( 0.944)	Loss 1.6406e+00 (1.6406e+00)	Prompt Acc@1  87.50 ( 87.50)
Validate: [25/79]	Time  0.222 ( 0.258)	Loss 1.6289e+00 (1.6391e+00)	Prompt Acc@1  88.28 ( 87.44)
Validate: [50/79]	Time  0.220 ( 0.240)	Loss 1.6113e+00 (1.6378e+00)	Prompt Acc@1  91.41 ( 87.13)
Validate: [75/79]	Time  0.222 ( 0.234)	Loss 1.6338e+00 (1.6390e+00)	Prompt Acc@1  89.06 ( 87.08)
 * Prompt Acc@1 87.150
There's no improvement for 2 epochs.
Training mode
Epoch: [11][  0/313]	Time  1.204 ( 1.204)	Data  0.781 ( 0.781)	Loss 1.6758e+00 (1.6758e+00)	Acc@1  81.25 ( 81.25)
Epoch: [11][ 25/313]	Time  0.423 ( 0.461)	Data  0.016 ( 0.047)	Loss 1.6562e+00 (1.6372e+00)	Acc@1  84.38 ( 87.62)
Epoch: [11][ 50/313]	Time  0.430 ( 0.448)	Data  0.016 ( 0.032)	Loss 1.6660e+00 (1.6374e+00)	Acc@1  81.25 ( 87.07)
Epoch: [11][ 75/313]	Time  0.427 ( 0.442)	Data  0.017 ( 0.027)	Loss 1.6475e+00 (1.6382e+00)	Acc@1  85.94 ( 87.07)
Epoch: [11][100/313]	Time  0.434 ( 0.440)	Data  0.017 ( 0.025)	Loss 1.6465e+00 (1.6366e+00)	Acc@1  87.50 ( 86.99)
Epoch: [11][125/313]	Time  0.428 ( 0.439)	Data  0.018 ( 0.024)	Loss 1.6348e+00 (1.6368e+00)	Acc@1  88.28 ( 86.96)
Epoch: [11][150/313]	Time  0.441 ( 0.438)	Data  0.017 ( 0.022)	Loss 1.5996e+00 (1.6362e+00)	Acc@1  94.53 ( 87.11)
Epoch: [11][175/313]	Time  0.427 ( 0.438)	Data  0.016 ( 0.022)	Loss 1.6572e+00 (1.6352e+00)	Acc@1  82.03 ( 87.18)
Epoch: [11][200/313]	Time  0.425 ( 0.437)	Data  0.016 ( 0.021)	Loss 1.6260e+00 (1.6347e+00)	Acc@1  89.06 ( 87.29)
Epoch: [11][225/313]	Time  0.438 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.6406e+00 (1.6340e+00)	Acc@1  84.38 ( 87.29)
Epoch: [11][250/313]	Time  0.427 ( 0.436)	Data  0.017 ( 0.020)	Loss 1.6377e+00 (1.6330e+00)	Acc@1  83.59 ( 87.28)
Epoch: [11][275/313]	Time  0.428 ( 0.436)	Data  0.018 ( 0.020)	Loss 1.6328e+00 (1.6324e+00)	Acc@1  87.50 ( 87.38)
Epoch: [11][300/313]	Time  0.426 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6367e+00 (1.6324e+00)	Acc@1  85.94 ( 87.30)
Validate: [ 0/79]	Time  0.971 ( 0.971)	Loss 1.6357e+00 (1.6357e+00)	Prompt Acc@1  86.72 ( 86.72)
Validate: [25/79]	Time  0.220 ( 0.254)	Loss 1.6230e+00 (1.6324e+00)	Prompt Acc@1  87.50 ( 87.20)
Validate: [50/79]	Time  0.219 ( 0.238)	Loss 1.6064e+00 (1.6311e+00)	Prompt Acc@1  92.19 ( 86.99)
Validate: [75/79]	Time  0.221 ( 0.233)	Loss 1.6270e+00 (1.6322e+00)	Prompt Acc@1  88.28 ( 87.03)
 * Prompt Acc@1 87.100
There's no improvement for 3 epochs.
Training mode
Epoch: [12][  0/313]	Time  1.203 ( 1.203)	Data  0.770 ( 0.770)	Loss 1.6689e+00 (1.6689e+00)	Acc@1  80.47 ( 80.47)
Epoch: [12][ 25/313]	Time  0.433 ( 0.462)	Data  0.017 ( 0.046)	Loss 1.6504e+00 (1.6300e+00)	Acc@1  84.38 ( 87.59)
Epoch: [12][ 50/313]	Time  0.436 ( 0.447)	Data  0.016 ( 0.032)	Loss 1.6592e+00 (1.6302e+00)	Acc@1  82.03 ( 87.24)
Epoch: [12][ 75/313]	Time  0.427 ( 0.442)	Data  0.018 ( 0.027)	Loss 1.6387e+00 (1.6309e+00)	Acc@1  85.94 ( 87.19)
Epoch: [12][100/313]	Time  0.429 ( 0.439)	Data  0.017 ( 0.024)	Loss 1.6387e+00 (1.6293e+00)	Acc@1  87.50 ( 87.06)
Epoch: [12][125/313]	Time  0.425 ( 0.438)	Data  0.016 ( 0.023)	Loss 1.6279e+00 (1.6295e+00)	Acc@1  88.28 ( 86.99)
Epoch: [12][150/313]	Time  0.434 ( 0.437)	Data  0.018 ( 0.022)	Loss 1.5947e+00 (1.6290e+00)	Acc@1  94.53 ( 87.16)
Epoch: [12][175/313]	Time  0.438 ( 0.436)	Data  0.018 ( 0.021)	Loss 1.6504e+00 (1.6281e+00)	Acc@1  82.03 ( 87.26)
Epoch: [12][200/313]	Time  0.436 ( 0.435)	Data  0.017 ( 0.021)	Loss 1.6201e+00 (1.6276e+00)	Acc@1  88.28 ( 87.37)
Epoch: [12][225/313]	Time  0.426 ( 0.435)	Data  0.017 ( 0.021)	Loss 1.6348e+00 (1.6269e+00)	Acc@1  85.16 ( 87.37)
Epoch: [12][250/313]	Time  0.433 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6289e+00 (1.6260e+00)	Acc@1  85.16 ( 87.37)
Epoch: [12][275/313]	Time  0.431 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6270e+00 (1.6255e+00)	Acc@1  88.28 ( 87.45)
Epoch: [12][300/313]	Time  0.428 ( 0.434)	Data  0.015 ( 0.020)	Loss 1.6318e+00 (1.6255e+00)	Acc@1  85.94 ( 87.38)
Validate: [ 0/79]	Time  0.897 ( 0.897)	Loss 1.6309e+00 (1.6309e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.221 ( 0.252)	Loss 1.6182e+00 (1.6270e+00)	Prompt Acc@1  86.72 ( 87.14)
Validate: [50/79]	Time  0.221 ( 0.237)	Loss 1.6016e+00 (1.6256e+00)	Prompt Acc@1  92.19 ( 87.01)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 1.6211e+00 (1.6267e+00)	Prompt Acc@1  87.50 ( 86.98)
 * Prompt Acc@1 87.040
There's no improvement for 4 epochs.
Training mode
Epoch: [13][  0/313]	Time  1.178 ( 1.178)	Data  0.739 ( 0.739)	Loss 1.6631e+00 (1.6631e+00)	Acc@1  80.47 ( 80.47)
Epoch: [13][ 25/313]	Time  0.430 ( 0.460)	Data  0.016 ( 0.045)	Loss 1.6465e+00 (1.6240e+00)	Acc@1  84.38 ( 87.35)
Epoch: [13][ 50/313]	Time  0.431 ( 0.446)	Data  0.017 ( 0.031)	Loss 1.6543e+00 (1.6242e+00)	Acc@1  82.03 ( 87.09)
Epoch: [13][ 75/313]	Time  0.436 ( 0.441)	Data  0.016 ( 0.027)	Loss 1.6328e+00 (1.6249e+00)	Acc@1  86.72 ( 87.15)
Epoch: [13][100/313]	Time  0.434 ( 0.439)	Data  0.016 ( 0.024)	Loss 1.6318e+00 (1.6234e+00)	Acc@1  87.50 ( 87.06)
Epoch: [13][125/313]	Time  0.432 ( 0.437)	Data  0.017 ( 0.023)	Loss 1.6221e+00 (1.6237e+00)	Acc@1  88.28 ( 87.05)
Epoch: [13][150/313]	Time  0.429 ( 0.436)	Data  0.017 ( 0.022)	Loss 1.5898e+00 (1.6233e+00)	Acc@1  94.53 ( 87.24)
Epoch: [13][175/313]	Time  0.436 ( 0.435)	Data  0.024 ( 0.021)	Loss 1.6455e+00 (1.6224e+00)	Acc@1  81.25 ( 87.34)
Epoch: [13][200/313]	Time  0.431 ( 0.435)	Data  0.015 ( 0.021)	Loss 1.6152e+00 (1.6219e+00)	Acc@1  88.28 ( 87.44)
Epoch: [13][225/313]	Time  0.435 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6309e+00 (1.6213e+00)	Acc@1  85.16 ( 87.42)
Epoch: [13][250/313]	Time  0.434 ( 0.434)	Data  0.016 ( 0.020)	Loss 1.6230e+00 (1.6205e+00)	Acc@1  85.94 ( 87.43)
Epoch: [13][275/313]	Time  0.426 ( 0.434)	Data  0.017 ( 0.020)	Loss 1.6221e+00 (1.6201e+00)	Acc@1  88.28 ( 87.50)
Epoch: [13][300/313]	Time  0.427 ( 0.434)	Data  0.016 ( 0.019)	Loss 1.6279e+00 (1.6201e+00)	Acc@1  85.16 ( 87.45)
Validate: [ 0/79]	Time  1.166 ( 1.166)	Loss 1.6270e+00 (1.6270e+00)	Prompt Acc@1  85.94 ( 85.94)
Validate: [25/79]	Time  0.222 ( 0.263)	Loss 1.6143e+00 (1.6226e+00)	Prompt Acc@1  86.72 ( 87.47)
Validate: [50/79]	Time  0.221 ( 0.245)	Loss 1.5977e+00 (1.6211e+00)	Prompt Acc@1  91.41 ( 87.25)
Validate: [75/79]	Time  0.220 ( 0.238)	Loss 1.6162e+00 (1.6221e+00)	Prompt Acc@1  87.50 ( 87.14)
 * Prompt Acc@1 87.210
There's no improvement for 5 epochs.
Training mode
Epoch: [14][  0/313]	Time  1.203 ( 1.203)	Data  0.755 ( 0.755)	Loss 1.6582e+00 (1.6582e+00)	Acc@1  81.25 ( 81.25)
Epoch: [14][ 25/313]	Time  0.435 ( 0.462)	Data  0.015 ( 0.046)	Loss 1.6436e+00 (1.6193e+00)	Acc@1  85.16 ( 87.74)
Epoch: [14][ 50/313]	Time  0.427 ( 0.446)	Data  0.016 ( 0.031)	Loss 1.6494e+00 (1.6194e+00)	Acc@1  81.25 ( 87.42)
Epoch: [14][ 75/313]	Time  0.427 ( 0.441)	Data  0.016 ( 0.027)	Loss 1.6289e+00 (1.6202e+00)	Acc@1  85.94 ( 87.38)
Epoch: [14][100/313]	Time  0.427 ( 0.438)	Data  0.017 ( 0.024)	Loss 1.6260e+00 (1.6187e+00)	Acc@1  87.50 ( 87.22)
Epoch: [14][125/313]	Time  0.430 ( 0.437)	Data  0.015 ( 0.023)	Loss 1.6182e+00 (1.6191e+00)	Acc@1  87.50 ( 87.19)
Epoch: [14][150/313]	Time  0.425 ( 0.436)	Data  0.017 ( 0.022)	Loss 1.5869e+00 (1.6188e+00)	Acc@1  93.75 ( 87.32)
Epoch: [14][175/313]	Time  0.427 ( 0.435)	Data  0.017 ( 0.021)	Loss 1.6426e+00 (1.6179e+00)	Acc@1  80.47 ( 87.40)
Epoch: [14][200/313]	Time  0.433 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6113e+00 (1.6175e+00)	Acc@1  88.28 ( 87.51)
Epoch: [14][225/313]	Time  0.434 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6270e+00 (1.6170e+00)	Acc@1  84.38 ( 87.50)
Epoch: [14][250/313]	Time  0.427 ( 0.434)	Data  0.018 ( 0.020)	Loss 1.6182e+00 (1.6161e+00)	Acc@1  85.94 ( 87.52)
Epoch: [14][275/313]	Time  0.429 ( 0.434)	Data  0.017 ( 0.020)	Loss 1.6162e+00 (1.6158e+00)	Acc@1  87.50 ( 87.57)
Epoch: [14][300/313]	Time  0.429 ( 0.434)	Data  0.016 ( 0.019)	Loss 1.6250e+00 (1.6159e+00)	Acc@1  85.94 ( 87.53)
Validate: [ 0/79]	Time  0.967 ( 0.967)	Loss 1.6230e+00 (1.6230e+00)	Prompt Acc@1  85.16 ( 85.16)
Validate: [25/79]	Time  0.221 ( 0.258)	Loss 1.6113e+00 (1.6188e+00)	Prompt Acc@1  86.72 ( 87.47)
Validate: [50/79]	Time  0.224 ( 0.240)	Loss 1.5947e+00 (1.6171e+00)	Prompt Acc@1  89.84 ( 87.22)
Validate: [75/79]	Time  0.221 ( 0.234)	Loss 1.6113e+00 (1.6181e+00)	Prompt Acc@1  87.50 ( 87.10)
 * Prompt Acc@1 87.190
There's no improvement for 6 epochs.
Training mode
Epoch: [15][  0/313]	Time  1.134 ( 1.134)	Data  0.701 ( 0.701)	Loss 1.6523e+00 (1.6523e+00)	Acc@1  82.03 ( 82.03)
Epoch: [15][ 25/313]	Time  0.440 ( 0.460)	Data  0.024 ( 0.044)	Loss 1.6416e+00 (1.6153e+00)	Acc@1  85.94 ( 87.89)
Epoch: [15][ 50/313]	Time  0.436 ( 0.446)	Data  0.018 ( 0.031)	Loss 1.6445e+00 (1.6157e+00)	Acc@1  81.25 ( 87.58)
Epoch: [15][ 75/313]	Time  0.429 ( 0.442)	Data  0.017 ( 0.027)	Loss 1.6260e+00 (1.6166e+00)	Acc@1  85.94 ( 87.51)
Epoch: [15][100/313]	Time  0.422 ( 0.440)	Data  0.015 ( 0.024)	Loss 1.6221e+00 (1.6151e+00)	Acc@1  88.28 ( 87.38)
Epoch: [15][125/313]	Time  0.429 ( 0.438)	Data  0.016 ( 0.023)	Loss 1.6162e+00 (1.6156e+00)	Acc@1  87.50 ( 87.32)
Epoch: [15][150/313]	Time  0.433 ( 0.437)	Data  0.017 ( 0.022)	Loss 1.5840e+00 (1.6154e+00)	Acc@1  93.75 ( 87.45)
Epoch: [15][175/313]	Time  0.430 ( 0.436)	Data  0.020 ( 0.021)	Loss 1.6387e+00 (1.6145e+00)	Acc@1  81.25 ( 87.52)
Epoch: [15][200/313]	Time  0.423 ( 0.436)	Data  0.016 ( 0.021)	Loss 1.6094e+00 (1.6141e+00)	Acc@1  88.28 ( 87.61)
Epoch: [15][225/313]	Time  0.435 ( 0.435)	Data  0.016 ( 0.020)	Loss 1.6230e+00 (1.6136e+00)	Acc@1  84.38 ( 87.59)
Epoch: [15][250/313]	Time  0.427 ( 0.435)	Data  0.017 ( 0.020)	Loss 1.6152e+00 (1.6128e+00)	Acc@1  85.16 ( 87.62)
Epoch: [15][275/313]	Time  0.428 ( 0.434)	Data  0.015 ( 0.020)	Loss 1.6123e+00 (1.6125e+00)	Acc@1  88.28 ( 87.66)
Epoch: [15][300/313]	Time  0.429 ( 0.434)	Data  0.017 ( 0.019)	Loss 1.6221e+00 (1.6126e+00)	Acc@1  85.94 ( 87.63)
Validate: [ 0/79]	Time  0.941 ( 0.941)	Loss 1.6211e+00 (1.6211e+00)	Prompt Acc@1  84.38 ( 84.38)
Validate: [25/79]	Time  0.224 ( 0.255)	Loss 1.6094e+00 (1.6163e+00)	Prompt Acc@1  86.72 ( 87.32)
Validate: [50/79]	Time  0.223 ( 0.240)	Loss 1.5928e+00 (1.6145e+00)	Prompt Acc@1  89.06 ( 87.07)
Validate: [75/79]	Time  0.221 ( 0.234)	Loss 1.6084e+00 (1.6154e+00)	Prompt Acc@1  87.50 ( 87.01)
 * Prompt Acc@1 87.090
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Validate: [ 0/79]	Time  0.960 ( 0.960)	Loss 1.6211e+00 (1.6211e+00)	Prompt Acc@1  84.38 ( 84.38)
Validate: [25/79]	Time  0.223 ( 0.252)	Loss 1.6094e+00 (1.6163e+00)	Prompt Acc@1  86.72 ( 87.32)
Validate: [50/79]	Time  0.220 ( 0.238)	Loss 1.5928e+00 (1.6145e+00)	Prompt Acc@1  89.06 ( 87.07)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 1.6084e+00 (1.6154e+00)	Prompt Acc@1  87.50 ( 87.01)
 * Prompt Acc@1 87.090
Validate: [ 0/79]	Time  0.963 ( 0.963)	Loss 1.6074e+00 (1.6074e+00)	Prompt Acc@1  84.38 ( 84.38)
Validate: [25/79]	Time  0.221 ( 0.254)	Loss 1.6309e+00 (1.6131e+00)	Prompt Acc@1  86.72 ( 86.81)
Validate: [50/79]	Time  0.222 ( 0.239)	Loss 1.6211e+00 (1.6164e+00)	Prompt Acc@1  83.59 ( 86.69)
Validate: [75/79]	Time  0.220 ( 0.233)	Loss 1.5908e+00 (1.6141e+00)	Prompt Acc@1  89.06 ( 86.93)
 * Prompt Acc@1 86.920
Running experiment on cifar100 with fixed_patch and prompt size 1
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='fixed_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/fixed_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to /scratch/lcur0649/cifar-100-python.tar.gz
  0%|          | 0/169001437 [00:00<?, ?it/s]  0%|          | 65536/169001437 [00:00<08:02, 350250.84it/s]  0%|          | 131072/169001437 [00:00<08:14, 341516.12it/s]  0%|          | 360448/169001437 [00:00<03:00, 934694.72it/s]  0%|          | 720896/169001437 [00:00<01:36, 1742955.49it/s]  1%|          | 1507328/169001437 [00:00<00:46, 3589221.10it/s]  2%|▏         | 2719744/169001437 [00:00<00:27, 6157541.76it/s]  3%|▎         | 4620288/169001437 [00:00<00:16, 10019723.40it/s]  4%|▍         | 6553600/169001437 [00:00<00:12, 12810599.74it/s]  5%|▌         | 8617984/169001437 [00:01<00:10, 15149494.82it/s]  6%|▌         | 10223616/169001437 [00:01<00:10, 15307329.08it/s]  7%|▋         | 11894784/169001437 [00:01<00:09, 15721874.64it/s]  8%|▊         | 13926400/169001437 [00:01<00:09, 17086183.37it/s] 10%|▉         | 16121856/169001437 [00:01<00:08, 18461097.40it/s] 11%|█         | 18415616/169001437 [00:01<00:07, 19786842.30it/s] 12%|█▏        | 20807680/169001437 [00:01<00:07, 20969691.89it/s] 14%|█▍        | 23330816/169001437 [00:01<00:06, 22231705.94it/s] 15%|█▌        | 25853952/169001437 [00:01<00:06, 23043113.35it/s] 17%|█▋        | 28442624/169001437 [00:01<00:05, 23878347.76it/s] 19%|█▊        | 31293440/169001437 [00:02<00:05, 25248786.49it/s] 20%|██        | 34144256/169001437 [00:02<00:05, 25531365.81it/s] 22%|██▏       | 37093376/169001437 [00:02<00:05, 23579713.37it/s] 24%|██▍       | 40140800/169001437 [00:02<00:05, 25389955.99it/s] 26%|██▌       | 43286528/169001437 [00:02<00:04, 27031176.81it/s] 28%|██▊       | 46497792/169001437 [00:02<00:04, 28470923.27it/s] 29%|██▉       | 49741824/169001437 [00:02<00:04, 29559211.16it/s] 31%|███▏      | 52920320/169001437 [00:02<00:03, 30199914.38it/s] 33%|███▎      | 55967744/169001437 [00:03<00:04, 23692701.12it/s] 35%|███▍      | 58851328/169001437 [00:03<00:04, 24954624.45it/s] 36%|███▋      | 61538304/169001437 [00:03<00:05, 20187495.18it/s] 38%|███▊      | 63832064/169001437 [00:03<00:05, 19610329.25it/s] 39%|███▉      | 65994752/169001437 [00:03<00:06, 15959458.31it/s] 40%|████      | 67829760/169001437 [00:03<00:06, 16059886.35it/s] 41%|████      | 69599232/169001437 [00:03<00:07, 13448938.12it/s] 42%|████▏     | 71106560/169001437 [00:04<00:08, 12097188.54it/s] 43%|████▎     | 72646656/169001437 [00:04<00:07, 12774975.90it/s] 44%|████▍     | 74121216/169001437 [00:04<00:07, 13184359.38it/s] 45%|████▍     | 75661312/169001437 [00:04<00:06, 13701510.14it/s] 46%|████▌     | 77266944/169001437 [00:04<00:06, 14297045.42it/s] 47%|████▋     | 78872576/169001437 [00:04<00:06, 14674794.25it/s] 48%|████▊     | 80510976/169001437 [00:04<00:05, 15141751.88it/s] 49%|████▊     | 82083840/169001437 [00:04<00:05, 15229178.64it/s] 50%|████▉     | 83689472/169001437 [00:04<00:05, 15432151.43it/s] 50%|█████     | 85327872/169001437 [00:05<00:05, 15696472.24it/s] 51%|█████▏    | 86999040/169001437 [00:05<00:05, 15942293.65it/s] 52%|█████▏    | 88604672/169001437 [00:05<00:05, 15930354.89it/s] 53%|█████▎    | 90275840/169001437 [00:05<00:04, 16092684.42it/s] 54%|█████▍    | 91914240/169001437 [00:05<00:04, 15891479.93it/s] 55%|█████▌    | 93585408/169001437 [00:05<00:04, 16084392.36it/s] 56%|█████▋    | 95289344/169001437 [00:05<00:04, 16362304.85it/s] 57%|█████▋    | 96993280/169001437 [00:05<00:04, 16403626.32it/s] 58%|█████▊    | 98664448/169001437 [00:05<00:04, 16491319.91it/s] 59%|█████▉    | 100368384/169001437 [00:05<00:04, 16557369.48it/s] 60%|██████    | 102039552/169001437 [00:06<00:04, 16478644.23it/s] 61%|██████▏   | 103776256/169001437 [00:06<00:03, 16725387.08it/s] 62%|██████▏   | 105512960/169001437 [00:06<00:03, 16686984.95it/s] 63%|██████▎   | 107249664/169001437 [00:06<00:03, 16804288.03it/s] 64%|██████▍   | 108953600/169001437 [00:06<00:04, 14864356.78it/s] 66%|██████▌   | 110985216/169001437 [00:06<00:03, 16234290.42it/s] 67%|██████▋   | 112656384/169001437 [00:06<00:03, 14727500.46it/s] 68%|██████▊   | 114196480/169001437 [00:06<00:03, 13886364.42it/s] 68%|██████▊   | 115638272/169001437 [00:07<00:03, 13650217.19it/s] 69%|██████▉   | 117047296/169001437 [00:07<00:03, 13588841.66it/s] 70%|███████   | 118423552/169001437 [00:07<00:03, 13100334.49it/s] 71%|███████   | 119767040/169001437 [00:07<00:03, 12961841.21it/s] 72%|███████▏  | 121077760/169001437 [00:07<00:03, 12925740.81it/s] 72%|███████▏  | 122388480/169001437 [00:07<00:03, 12910170.82it/s] 73%|███████▎  | 123699200/169001437 [00:07<00:03, 12904009.38it/s] 74%|███████▍  | 125009920/169001437 [00:07<00:03, 12923183.15it/s] 75%|███████▍  | 126320640/169001437 [00:07<00:03, 12909443.64it/s] 76%|███████▌  | 127664128/169001437 [00:07<00:03, 12989977.05it/s] 76%|███████▋  | 129040384/169001437 [00:08<00:03, 13075447.96it/s] 77%|███████▋  | 130351104/169001437 [00:08<00:03, 10915017.02it/s] 78%|███████▊  | 132120576/169001437 [00:08<00:02, 12569182.38it/s] 79%|███████▉  | 133464064/169001437 [00:08<00:03, 11609202.09it/s] 80%|███████▉  | 134709248/169001437 [00:08<00:03, 9204486.93it/s]  80%|████████  | 135856128/169001437 [00:08<00:03, 9660637.89it/s] 81%|████████  | 136937472/169001437 [00:08<00:03, 8580493.41it/s] 82%|████████▏ | 137887744/169001437 [00:09<00:03, 8188279.98it/s] 82%|████████▏ | 138772480/169001437 [00:09<00:03, 7846188.99it/s] 83%|████████▎ | 139591680/169001437 [00:09<00:03, 7533454.18it/s] 83%|████████▎ | 140378112/169001437 [00:09<00:03, 7385709.04it/s] 84%|████████▎ | 141131776/169001437 [00:09<00:03, 7323682.10it/s] 84%|████████▍ | 141885440/169001437 [00:09<00:03, 7287445.58it/s] 84%|████████▍ | 142639104/169001437 [00:09<00:03, 7292181.70it/s] 85%|████████▍ | 143392768/169001437 [00:09<00:03, 7263776.34it/s] 85%|████████▌ | 144146432/169001437 [00:09<00:03, 7291344.22it/s] 86%|████████▌ | 144900096/169001437 [00:10<00:03, 7338825.26it/s] 86%|████████▌ | 145653760/169001437 [00:10<00:03, 7370953.01it/s] 87%|████████▋ | 146407424/169001437 [00:10<00:03, 7412885.60it/s] 87%|████████▋ | 147161088/169001437 [00:10<00:02, 7419656.26it/s] 88%|████████▊ | 147947520/169001437 [00:10<00:02, 7443845.36it/s] 88%|████████▊ | 148733952/169001437 [00:10<00:02, 7535202.92it/s] 88%|████████▊ | 149520384/169001437 [00:10<00:02, 7549627.88it/s] 89%|████████▉ | 150306816/169001437 [00:10<00:02, 7581129.94it/s] 89%|████████▉ | 151093248/169001437 [00:10<00:02, 7632451.85it/s] 90%|████████▉ | 151879680/169001437 [00:10<00:02, 7642204.50it/s] 90%|█████████ | 152666112/169001437 [00:11<00:02, 7676792.07it/s] 91%|█████████ | 153452544/169001437 [00:11<00:02, 7694630.65it/s] 91%|█████████▏| 154271744/169001437 [00:11<00:01, 7764383.47it/s] 92%|█████████▏| 155058176/169001437 [00:11<00:01, 7772078.01it/s] 92%|█████████▏| 155877376/169001437 [00:11<00:01, 7801450.10it/s] 93%|█████████▎| 156663808/169001437 [00:11<00:01, 7774567.98it/s] 93%|█████████▎| 157483008/169001437 [00:11<00:01, 7812943.27it/s] 94%|█████████▎| 158302208/169001437 [00:11<00:01, 7862168.52it/s] 94%|█████████▍| 159121408/169001437 [00:11<00:01, 7862861.87it/s] 95%|█████████▍| 159940608/169001437 [00:12<00:01, 7919765.27it/s] 95%|█████████▌| 160792576/169001437 [00:12<00:01, 7992622.27it/s] 96%|█████████▌| 161611776/169001437 [00:12<00:00, 8046236.64it/s] 96%|█████████▌| 162430976/169001437 [00:12<00:00, 8079354.79it/s] 97%|█████████▋| 163250176/169001437 [00:12<00:00, 6268218.62it/s] 97%|█████████▋| 164397056/169001437 [00:12<00:00, 6522528.11it/s] 98%|█████████▊| 165347328/169001437 [00:12<00:00, 7191253.63it/s] 98%|█████████▊| 166133760/169001437 [00:12<00:00, 6000122.95it/s] 99%|█████████▊| 166821888/169001437 [00:13<00:00, 5380981.09it/s] 99%|█████████▉| 167411712/169001437 [00:13<00:00, 5097003.18it/s] 99%|█████████▉| 167968768/169001437 [00:13<00:00, 4842209.35it/s]100%|█████████▉| 168493056/169001437 [00:13<00:00, 4689289.65it/s]100%|█████████▉| 168984576/169001437 [00:13<00:00, 4628985.84it/s]100%|██████████| 169001437/169001437 [00:13<00:00, 12386889.46it/s]
Extracting /scratch/lcur0649/cifar-100-python.tar.gz to /scratch/lcur0649
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.patch'}"
Number of prompt parameters:  3
Training mode
Epoch: [0][  0/313]	Time  2.256 ( 2.256)	Data  0.798 ( 0.798)	Loss 4.3516e+00 (4.3516e+00)	Acc@1  61.72 ( 61.72)
Epoch: [0][ 25/313]	Time  0.407 ( 0.485)	Data  0.016 ( 0.048)	Loss 4.3320e+00 (4.3428e+00)	Acc@1  65.62 ( 63.58)
Epoch: [0][ 50/313]	Time  0.418 ( 0.450)	Data  0.015 ( 0.033)	Loss 4.3594e+00 (4.3436e+00)	Acc@1  60.16 ( 63.45)
Epoch: [0][ 75/313]	Time  0.412 ( 0.438)	Data  0.017 ( 0.028)	Loss 4.3320e+00 (4.3437e+00)	Acc@1  67.19 ( 63.55)
Epoch: [0][100/313]	Time  0.422 ( 0.432)	Data  0.016 ( 0.025)	Loss 4.3320e+00 (4.3439e+00)	Acc@1  66.41 ( 63.42)
Epoch: [0][125/313]	Time  0.411 ( 0.428)	Data  0.016 ( 0.023)	Loss 4.3477e+00 (4.3439e+00)	Acc@1  60.16 ( 63.54)
Epoch: [0][150/313]	Time  0.415 ( 0.426)	Data  0.016 ( 0.022)	Loss 4.3281e+00 (4.3432e+00)	Acc@1  61.72 ( 63.72)
Epoch: [0][175/313]	Time  0.410 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3320e+00 (4.3437e+00)	Acc@1  69.53 ( 63.42)
Epoch: [0][200/313]	Time  0.415 ( 0.423)	Data  0.016 ( 0.021)	Loss 4.3477e+00 (4.3432e+00)	Acc@1  63.28 ( 63.53)
Epoch: [0][225/313]	Time  0.418 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3516e+00 (4.3431e+00)	Acc@1  68.75 ( 63.59)
Epoch: [0][250/313]	Time  0.414 ( 0.421)	Data  0.016 ( 0.020)	Loss 4.3438e+00 (4.3433e+00)	Acc@1  67.97 ( 63.64)
Epoch: [0][275/313]	Time  0.417 ( 0.421)	Data  0.015 ( 0.020)	Loss 4.3359e+00 (4.3435e+00)	Acc@1  61.72 ( 63.59)
Epoch: [0][300/313]	Time  0.411 ( 0.421)	Data  0.016 ( 0.019)	Loss 4.3633e+00 (4.3436e+00)	Acc@1  54.69 ( 63.58)
Validate: [ 0/79]	Time  0.930 ( 0.930)	Loss 4.3555e+00 (4.3555e+00)	Prompt Acc@1  58.59 ( 58.59)
Validate: [25/79]	Time  0.218 ( 0.253)	Loss 4.3320e+00 (4.3442e+00)	Prompt Acc@1  67.19 ( 62.92)
Validate: [50/79]	Time  0.219 ( 0.237)	Loss 4.3516e+00 (4.3453e+00)	Prompt Acc@1  53.91 ( 63.07)
Validate: [75/79]	Time  0.221 ( 0.231)	Loss 4.3633e+00 (4.3448e+00)	Prompt Acc@1  64.06 ( 63.04)
 * Prompt Acc@1 63.070
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.222 ( 1.222)	Data  0.793 ( 0.793)	Loss 4.3516e+00 (4.3516e+00)	Acc@1  61.72 ( 61.72)
Epoch: [1][ 25/313]	Time  0.411 ( 0.448)	Data  0.016 ( 0.047)	Loss 4.3320e+00 (4.3428e+00)	Acc@1  66.41 ( 63.58)
Epoch: [1][ 50/313]	Time  0.412 ( 0.432)	Data  0.016 ( 0.032)	Loss 4.3594e+00 (4.3436e+00)	Acc@1  60.16 ( 63.48)
Epoch: [1][ 75/313]	Time  0.415 ( 0.427)	Data  0.015 ( 0.027)	Loss 4.3320e+00 (4.3437e+00)	Acc@1  67.97 ( 63.58)
Epoch: [1][100/313]	Time  0.420 ( 0.424)	Data  0.019 ( 0.025)	Loss 4.3320e+00 (4.3438e+00)	Acc@1  66.41 ( 63.47)
Epoch: [1][125/313]	Time  0.414 ( 0.423)	Data  0.017 ( 0.023)	Loss 4.3477e+00 (4.3439e+00)	Acc@1  60.16 ( 63.58)
Epoch: [1][150/313]	Time  0.417 ( 0.422)	Data  0.016 ( 0.022)	Loss 4.3281e+00 (4.3432e+00)	Acc@1  61.72 ( 63.76)
Epoch: [1][175/313]	Time  0.418 ( 0.422)	Data  0.017 ( 0.022)	Loss 4.3320e+00 (4.3437e+00)	Acc@1  69.53 ( 63.46)
Epoch: [1][200/313]	Time  0.415 ( 0.421)	Data  0.016 ( 0.021)	Loss 4.3477e+00 (4.3432e+00)	Acc@1  64.06 ( 63.56)
Epoch: [1][225/313]	Time  0.422 ( 0.421)	Data  0.016 ( 0.021)	Loss 4.3516e+00 (4.3432e+00)	Acc@1  68.75 ( 63.62)
Epoch: [1][250/313]	Time  0.413 ( 0.420)	Data  0.017 ( 0.020)	Loss 4.3438e+00 (4.3433e+00)	Acc@1  67.19 ( 63.66)
Epoch: [1][275/313]	Time  0.415 ( 0.420)	Data  0.016 ( 0.020)	Loss 4.3359e+00 (4.3435e+00)	Acc@1  60.94 ( 63.62)
Epoch: [1][300/313]	Time  0.426 ( 0.419)	Data  0.017 ( 0.020)	Loss 4.3633e+00 (4.3436e+00)	Acc@1  54.69 ( 63.61)
Validate: [ 0/79]	Time  0.921 ( 0.921)	Loss 4.3516e+00 (4.3516e+00)	Prompt Acc@1  58.59 ( 58.59)
Validate: [25/79]	Time  0.220 ( 0.251)	Loss 4.3320e+00 (4.3441e+00)	Prompt Acc@1  67.19 ( 62.98)
Validate: [50/79]	Time  0.219 ( 0.236)	Loss 4.3516e+00 (4.3451e+00)	Prompt Acc@1  54.69 ( 63.19)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 4.3633e+00 (4.3446e+00)	Prompt Acc@1  64.84 ( 63.18)
 * Prompt Acc@1 63.190
saved best file
Training mode
Epoch: [2][  0/313]	Time  1.172 ( 1.172)	Data  0.764 ( 0.764)	Loss 4.3516e+00 (4.3516e+00)	Acc@1  61.72 ( 61.72)
Epoch: [2][ 25/313]	Time  0.410 ( 0.446)	Data  0.015 ( 0.046)	Loss 4.3320e+00 (4.3428e+00)	Acc@1  66.41 ( 63.61)
Epoch: [2][ 50/313]	Time  0.410 ( 0.432)	Data  0.016 ( 0.032)	Loss 4.3594e+00 (4.3436e+00)	Acc@1  60.16 ( 63.47)
Epoch: [2][ 75/313]	Time  0.416 ( 0.427)	Data  0.016 ( 0.027)	Loss 4.3320e+00 (4.3437e+00)	Acc@1  67.19 ( 63.61)
Epoch: [2][100/313]	Time  0.416 ( 0.424)	Data  0.016 ( 0.024)	Loss 4.3320e+00 (4.3438e+00)	Acc@1  66.41 ( 63.47)
Epoch: [2][125/313]	Time  0.415 ( 0.422)	Data  0.017 ( 0.023)	Loss 4.3477e+00 (4.3438e+00)	Acc@1  60.16 ( 63.60)
Epoch: [2][150/313]	Time  0.412 ( 0.421)	Data  0.016 ( 0.022)	Loss 4.3281e+00 (4.3430e+00)	Acc@1  61.72 ( 63.78)
Epoch: [2][175/313]	Time  0.411 ( 0.421)	Data  0.017 ( 0.021)	Loss 4.3281e+00 (4.3434e+00)	Acc@1  70.31 ( 63.49)
Epoch: [2][200/313]	Time  0.413 ( 0.420)	Data  0.016 ( 0.020)	Loss 4.3477e+00 (4.3428e+00)	Acc@1  64.06 ( 63.63)
Epoch: [2][225/313]	Time  0.418 ( 0.420)	Data  0.018 ( 0.020)	Loss 4.3516e+00 (4.3427e+00)	Acc@1  67.19 ( 63.66)
Epoch: [2][250/313]	Time  0.410 ( 0.420)	Data  0.017 ( 0.020)	Loss 4.3438e+00 (4.3426e+00)	Acc@1  65.62 ( 63.67)
Epoch: [2][275/313]	Time  0.417 ( 0.420)	Data  0.018 ( 0.020)	Loss 4.3320e+00 (4.3427e+00)	Acc@1  60.94 ( 63.67)
Epoch: [2][300/313]	Time  0.411 ( 0.419)	Data  0.016 ( 0.020)	Loss 4.3594e+00 (4.3424e+00)	Acc@1  53.91 ( 63.75)
Validate: [ 0/79]	Time  1.001 ( 1.001)	Loss 4.3438e+00 (4.3438e+00)	Prompt Acc@1  61.72 ( 61.72)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3242e+00 (4.3364e+00)	Prompt Acc@1  67.19 ( 63.91)
Validate: [50/79]	Time  0.218 ( 0.237)	Loss 4.3516e+00 (4.3379e+00)	Prompt Acc@1  56.25 ( 63.92)
Validate: [75/79]	Time  0.221 ( 0.232)	Loss 4.3594e+00 (4.3375e+00)	Prompt Acc@1  60.94 ( 63.76)
 * Prompt Acc@1 63.830
saved best file
Training mode
Epoch: [3][  0/313]	Time  1.198 ( 1.198)	Data  0.787 ( 0.787)	Loss 4.3477e+00 (4.3477e+00)	Acc@1  61.72 ( 61.72)
Epoch: [3][ 25/313]	Time  0.417 ( 0.445)	Data  0.017 ( 0.046)	Loss 4.3242e+00 (4.3356e+00)	Acc@1  66.41 ( 64.54)
Epoch: [3][ 50/313]	Time  0.412 ( 0.430)	Data  0.016 ( 0.032)	Loss 4.3477e+00 (4.3358e+00)	Acc@1  60.16 ( 64.41)
Epoch: [3][ 75/313]	Time  0.418 ( 0.426)	Data  0.016 ( 0.027)	Loss 4.3242e+00 (4.3353e+00)	Acc@1  67.19 ( 64.61)
Epoch: [3][100/313]	Time  0.419 ( 0.424)	Data  0.016 ( 0.024)	Loss 4.3281e+00 (4.3347e+00)	Acc@1  64.06 ( 64.54)
Epoch: [3][125/313]	Time  0.412 ( 0.424)	Data  0.015 ( 0.023)	Loss 4.3398e+00 (4.3343e+00)	Acc@1  61.72 ( 64.56)
Epoch: [3][150/313]	Time  0.413 ( 0.423)	Data  0.015 ( 0.022)	Loss 4.3164e+00 (4.3334e+00)	Acc@1  64.84 ( 64.74)
Epoch: [3][175/313]	Time  0.427 ( 0.422)	Data  0.016 ( 0.021)	Loss 4.3164e+00 (4.3336e+00)	Acc@1  70.31 ( 64.47)
Epoch: [3][200/313]	Time  0.415 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3359e+00 (4.3330e+00)	Acc@1  62.50 ( 64.56)
Epoch: [3][225/313]	Time  0.414 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3398e+00 (4.3327e+00)	Acc@1  64.06 ( 64.58)
Epoch: [3][250/313]	Time  0.421 ( 0.421)	Data  0.017 ( 0.020)	Loss 4.3320e+00 (4.3326e+00)	Acc@1  68.75 ( 64.55)
Epoch: [3][275/313]	Time  0.419 ( 0.421)	Data  0.017 ( 0.020)	Loss 4.3203e+00 (4.3327e+00)	Acc@1  64.06 ( 64.47)
Epoch: [3][300/313]	Time  0.426 ( 0.421)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3325e+00)	Acc@1  53.91 ( 64.52)
Validate: [ 0/79]	Time  0.950 ( 0.950)	Loss 4.3398e+00 (4.3398e+00)	Prompt Acc@1  60.16 ( 60.16)
Validate: [25/79]	Time  0.221 ( 0.254)	Loss 4.3203e+00 (4.3302e+00)	Prompt Acc@1  62.50 ( 64.06)
Validate: [50/79]	Time  0.221 ( 0.240)	Loss 4.3438e+00 (4.3316e+00)	Prompt Acc@1  54.69 ( 63.77)
Validate: [75/79]	Time  0.221 ( 0.236)	Loss 4.3516e+00 (4.3313e+00)	Prompt Acc@1  61.72 ( 63.64)
 * Prompt Acc@1 63.660
There's no improvement for 1 epochs.
Training mode
Epoch: [4][  0/313]	Time  1.185 ( 1.185)	Data  0.751 ( 0.751)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  62.50 ( 62.50)
Epoch: [4][ 25/313]	Time  0.425 ( 0.459)	Data  0.017 ( 0.053)	Loss 4.3203e+00 (4.3293e+00)	Acc@1  67.97 ( 64.72)
Epoch: [4][ 50/313]	Time  0.422 ( 0.441)	Data  0.018 ( 0.035)	Loss 4.3438e+00 (4.3303e+00)	Acc@1  60.16 ( 64.48)
Epoch: [4][ 75/313]	Time  0.418 ( 0.433)	Data  0.016 ( 0.029)	Loss 4.3203e+00 (4.3304e+00)	Acc@1  67.97 ( 64.66)
Epoch: [4][100/313]	Time  0.416 ( 0.430)	Data  0.017 ( 0.026)	Loss 4.3242e+00 (4.3303e+00)	Acc@1  64.84 ( 64.69)
Epoch: [4][125/313]	Time  0.421 ( 0.428)	Data  0.018 ( 0.024)	Loss 4.3398e+00 (4.3302e+00)	Acc@1  61.72 ( 64.78)
Epoch: [4][150/313]	Time  0.430 ( 0.427)	Data  0.018 ( 0.023)	Loss 4.3164e+00 (4.3295e+00)	Acc@1  63.28 ( 64.91)
Epoch: [4][175/313]	Time  0.423 ( 0.426)	Data  0.018 ( 0.022)	Loss 4.3164e+00 (4.3301e+00)	Acc@1  70.31 ( 64.64)
Epoch: [4][200/313]	Time  0.413 ( 0.425)	Data  0.016 ( 0.022)	Loss 4.3359e+00 (4.3296e+00)	Acc@1  61.72 ( 64.69)
Epoch: [4][225/313]	Time  0.422 ( 0.425)	Data  0.018 ( 0.021)	Loss 4.3398e+00 (4.3296e+00)	Acc@1  63.28 ( 64.70)
Epoch: [4][250/313]	Time  0.424 ( 0.424)	Data  0.018 ( 0.021)	Loss 4.3281e+00 (4.3297e+00)	Acc@1  67.97 ( 64.68)
Epoch: [4][275/313]	Time  0.427 ( 0.424)	Data  0.018 ( 0.020)	Loss 4.3164e+00 (4.3299e+00)	Acc@1  66.41 ( 64.61)
Epoch: [4][300/313]	Time  0.417 ( 0.424)	Data  0.016 ( 0.020)	Loss 4.3516e+00 (4.3299e+00)	Acc@1  54.69 ( 64.66)
Validate: [ 0/79]	Time  0.965 ( 0.965)	Loss 4.3398e+00 (4.3398e+00)	Prompt Acc@1  61.72 ( 61.72)
Validate: [25/79]	Time  0.220 ( 0.254)	Loss 4.3164e+00 (4.3289e+00)	Prompt Acc@1  63.28 ( 64.30)
Validate: [50/79]	Time  0.218 ( 0.238)	Loss 4.3438e+00 (4.3307e+00)	Prompt Acc@1  54.69 ( 64.09)
Validate: [75/79]	Time  0.218 ( 0.232)	Loss 4.3516e+00 (4.3302e+00)	Prompt Acc@1  60.94 ( 63.80)
 * Prompt Acc@1 63.830
There's no improvement for 2 epochs.
Training mode
Epoch: [5][  0/313]	Time  1.200 ( 1.200)	Data  0.781 ( 0.781)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  62.50 ( 62.50)
Epoch: [5][ 25/313]	Time  0.415 ( 0.449)	Data  0.017 ( 0.046)	Loss 4.3203e+00 (4.3284e+00)	Acc@1  67.97 ( 65.11)
Epoch: [5][ 50/313]	Time  0.421 ( 0.434)	Data  0.017 ( 0.032)	Loss 4.3438e+00 (4.3296e+00)	Acc@1  60.94 ( 64.77)
Epoch: [5][ 75/313]	Time  0.416 ( 0.429)	Data  0.017 ( 0.027)	Loss 4.3203e+00 (4.3297e+00)	Acc@1  67.97 ( 64.90)
Epoch: [5][100/313]	Time  0.422 ( 0.427)	Data  0.016 ( 0.025)	Loss 4.3242e+00 (4.3296e+00)	Acc@1  63.28 ( 64.89)
Epoch: [5][125/313]	Time  0.421 ( 0.426)	Data  0.016 ( 0.023)	Loss 4.3398e+00 (4.3295e+00)	Acc@1  60.94 ( 64.92)
Epoch: [5][150/313]	Time  0.417 ( 0.425)	Data  0.017 ( 0.022)	Loss 4.3164e+00 (4.3287e+00)	Acc@1  62.50 ( 64.99)
Epoch: [5][175/313]	Time  0.420 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3293e+00)	Acc@1  70.31 ( 64.72)
Epoch: [5][200/313]	Time  0.415 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3359e+00 (4.3289e+00)	Acc@1  61.72 ( 64.75)
Epoch: [5][225/313]	Time  0.414 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3398e+00 (4.3289e+00)	Acc@1  63.28 ( 64.76)
Epoch: [5][250/313]	Time  0.414 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3290e+00)	Acc@1  67.97 ( 64.73)
Epoch: [5][275/313]	Time  0.421 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3164e+00 (4.3292e+00)	Acc@1  66.41 ( 64.65)
Epoch: [5][300/313]	Time  0.423 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3292e+00)	Acc@1  54.69 ( 64.68)
Validate: [ 0/79]	Time  0.924 ( 0.924)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.253)	Loss 4.3164e+00 (4.3281e+00)	Prompt Acc@1  63.28 ( 64.54)
Validate: [50/79]	Time  0.219 ( 0.237)	Loss 4.3438e+00 (4.3300e+00)	Prompt Acc@1  54.69 ( 64.38)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 4.3477e+00 (4.3296e+00)	Prompt Acc@1  61.72 ( 63.95)
 * Prompt Acc@1 63.980
saved best file
Training mode
Epoch: [6][  0/313]	Time  1.146 ( 1.146)	Data  0.744 ( 0.744)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  62.50 ( 62.50)
Epoch: [6][ 25/313]	Time  0.422 ( 0.449)	Data  0.016 ( 0.045)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  68.75 ( 65.14)
Epoch: [6][ 50/313]	Time  0.422 ( 0.435)	Data  0.024 ( 0.032)	Loss 4.3438e+00 (4.3290e+00)	Acc@1  60.94 ( 64.86)
Epoch: [6][ 75/313]	Time  0.415 ( 0.430)	Data  0.016 ( 0.027)	Loss 4.3203e+00 (4.3292e+00)	Acc@1  68.75 ( 64.99)
Epoch: [6][100/313]	Time  0.421 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3291e+00)	Acc@1  62.50 ( 64.95)
Epoch: [6][125/313]	Time  0.423 ( 0.426)	Data  0.016 ( 0.023)	Loss 4.3398e+00 (4.3290e+00)	Acc@1  61.72 ( 64.97)
Epoch: [6][150/313]	Time  0.422 ( 0.425)	Data  0.018 ( 0.022)	Loss 4.3164e+00 (4.3283e+00)	Acc@1  61.72 ( 65.02)
Epoch: [6][175/313]	Time  0.414 ( 0.424)	Data  0.016 ( 0.021)	Loss 4.3164e+00 (4.3288e+00)	Acc@1  69.53 ( 64.74)
Epoch: [6][200/313]	Time  0.416 ( 0.423)	Data  0.017 ( 0.021)	Loss 4.3359e+00 (4.3285e+00)	Acc@1  62.50 ( 64.77)
Epoch: [6][225/313]	Time  0.425 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3398e+00 (4.3284e+00)	Acc@1  64.06 ( 64.80)
Epoch: [6][250/313]	Time  0.418 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3285e+00)	Acc@1  67.19 ( 64.75)
Epoch: [6][275/313]	Time  0.415 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3164e+00 (4.3288e+00)	Acc@1  67.19 ( 64.67)
Epoch: [6][300/313]	Time  0.420 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3516e+00 (4.3288e+00)	Acc@1  55.47 ( 64.70)
Validate: [ 0/79]	Time  1.000 ( 1.000)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  64.06 ( 64.06)
Validate: [25/79]	Time  0.224 ( 0.266)	Loss 4.3164e+00 (4.3277e+00)	Prompt Acc@1  63.28 ( 64.81)
Validate: [50/79]	Time  0.219 ( 0.244)	Loss 4.3438e+00 (4.3294e+00)	Prompt Acc@1  53.91 ( 64.46)
Validate: [75/79]	Time  0.220 ( 0.236)	Loss 4.3477e+00 (4.3291e+00)	Prompt Acc@1  62.50 ( 63.99)
 * Prompt Acc@1 64.030
saved best file
Training mode
Epoch: [7][  0/313]	Time  1.164 ( 1.164)	Data  0.738 ( 0.738)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  61.72 ( 61.72)
Epoch: [7][ 25/313]	Time  0.416 ( 0.449)	Data  0.017 ( 0.045)	Loss 4.3203e+00 (4.3271e+00)	Acc@1  67.19 ( 65.02)
Epoch: [7][ 50/313]	Time  0.412 ( 0.433)	Data  0.016 ( 0.031)	Loss 4.3438e+00 (4.3284e+00)	Acc@1  60.94 ( 64.74)
Epoch: [7][ 75/313]	Time  0.420 ( 0.429)	Data  0.017 ( 0.027)	Loss 4.3203e+00 (4.3286e+00)	Acc@1  66.41 ( 64.87)
Epoch: [7][100/313]	Time  0.425 ( 0.426)	Data  0.018 ( 0.024)	Loss 4.3242e+00 (4.3287e+00)	Acc@1  62.50 ( 64.82)
Epoch: [7][125/313]	Time  0.412 ( 0.425)	Data  0.016 ( 0.022)	Loss 4.3398e+00 (4.3286e+00)	Acc@1  61.72 ( 64.86)
Epoch: [7][150/313]	Time  0.421 ( 0.424)	Data  0.025 ( 0.021)	Loss 4.3125e+00 (4.3279e+00)	Acc@1  61.72 ( 64.92)
Epoch: [7][175/313]	Time  0.413 ( 0.423)	Data  0.015 ( 0.021)	Loss 4.3164e+00 (4.3285e+00)	Acc@1  70.31 ( 64.65)
Epoch: [7][200/313]	Time  0.412 ( 0.423)	Data  0.015 ( 0.020)	Loss 4.3359e+00 (4.3281e+00)	Acc@1  62.50 ( 64.68)
Epoch: [7][225/313]	Time  0.417 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3398e+00 (4.3281e+00)	Acc@1  64.06 ( 64.72)
Epoch: [7][250/313]	Time  0.415 ( 0.422)	Data  0.015 ( 0.020)	Loss 4.3281e+00 (4.3282e+00)	Acc@1  67.19 ( 64.68)
Epoch: [7][275/313]	Time  0.415 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3164e+00 (4.3285e+00)	Acc@1  67.19 ( 64.59)
Epoch: [7][300/313]	Time  0.422 ( 0.421)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3285e+00)	Acc@1  54.69 ( 64.64)
Validate: [ 0/79]	Time  0.984 ( 0.984)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  64.06 ( 64.06)
Validate: [25/79]	Time  0.220 ( 0.255)	Loss 4.3164e+00 (4.3275e+00)	Prompt Acc@1  62.50 ( 64.81)
Validate: [50/79]	Time  0.221 ( 0.238)	Loss 4.3438e+00 (4.3293e+00)	Prompt Acc@1  54.69 ( 64.54)
Validate: [75/79]	Time  0.218 ( 0.232)	Loss 4.3477e+00 (4.3289e+00)	Prompt Acc@1  62.50 ( 63.97)
 * Prompt Acc@1 64.010
There's no improvement for 1 epochs.
Training mode
Epoch: [8][  0/313]	Time  1.175 ( 1.175)	Data  0.749 ( 0.749)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  61.72 ( 61.72)
Epoch: [8][ 25/313]	Time  0.422 ( 0.450)	Data  0.017 ( 0.046)	Loss 4.3203e+00 (4.3269e+00)	Acc@1  67.19 ( 65.05)
Epoch: [8][ 50/313]	Time  0.414 ( 0.434)	Data  0.015 ( 0.031)	Loss 4.3438e+00 (4.3282e+00)	Acc@1  60.94 ( 64.74)
Epoch: [8][ 75/313]	Time  0.417 ( 0.430)	Data  0.017 ( 0.027)	Loss 4.3203e+00 (4.3284e+00)	Acc@1  65.62 ( 64.90)
Epoch: [8][100/313]	Time  0.415 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3284e+00)	Acc@1  63.28 ( 64.84)
Epoch: [8][125/313]	Time  0.431 ( 0.426)	Data  0.021 ( 0.023)	Loss 4.3398e+00 (4.3284e+00)	Acc@1  61.72 ( 64.88)
Epoch: [8][150/313]	Time  0.420 ( 0.425)	Data  0.018 ( 0.022)	Loss 4.3125e+00 (4.3277e+00)	Acc@1  62.50 ( 64.92)
Epoch: [8][175/313]	Time  0.419 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3283e+00)	Acc@1  70.31 ( 64.64)
Epoch: [8][200/313]	Time  0.421 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3359e+00 (4.3280e+00)	Acc@1  62.50 ( 64.68)
Epoch: [8][225/313]	Time  0.419 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  64.06 ( 64.73)
Epoch: [8][250/313]	Time  0.415 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  67.19 ( 64.69)
Epoch: [8][275/313]	Time  0.417 ( 0.423)	Data  0.015 ( 0.020)	Loss 4.3164e+00 (4.3284e+00)	Acc@1  67.19 ( 64.60)
Epoch: [8][300/313]	Time  0.419 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3284e+00)	Acc@1  54.69 ( 64.64)
Validate: [ 0/79]	Time  0.953 ( 0.953)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.220 ( 0.251)	Loss 4.3164e+00 (4.3274e+00)	Prompt Acc@1  62.50 ( 64.90)
Validate: [50/79]	Time  0.220 ( 0.235)	Loss 4.3438e+00 (4.3292e+00)	Prompt Acc@1  53.91 ( 64.57)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 4.3477e+00 (4.3289e+00)	Prompt Acc@1  62.50 ( 64.00)
 * Prompt Acc@1 64.040
saved best file
Training mode
Epoch: [9][  0/313]	Time  1.139 ( 1.139)	Data  0.709 ( 0.709)	Loss 4.3438e+00 (4.3438e+00)	Acc@1  61.72 ( 61.72)
Epoch: [9][ 25/313]	Time  0.425 ( 0.450)	Data  0.017 ( 0.045)	Loss 4.3203e+00 (4.3269e+00)	Acc@1  67.19 ( 65.05)
Epoch: [9][ 50/313]	Time  0.415 ( 0.434)	Data  0.016 ( 0.031)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  60.94 ( 64.71)
Epoch: [9][ 75/313]	Time  0.412 ( 0.429)	Data  0.015 ( 0.026)	Loss 4.3203e+00 (4.3282e+00)	Acc@1  65.62 ( 64.84)
Epoch: [9][100/313]	Time  0.415 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3283e+00)	Acc@1  63.28 ( 64.81)
Epoch: [9][125/313]	Time  0.414 ( 0.425)	Data  0.016 ( 0.022)	Loss 4.3398e+00 (4.3282e+00)	Acc@1  61.72 ( 64.84)
Epoch: [9][150/313]	Time  0.417 ( 0.424)	Data  0.017 ( 0.022)	Loss 4.3125e+00 (4.3275e+00)	Acc@1  63.28 ( 64.87)
Epoch: [9][175/313]	Time  0.421 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3281e+00)	Acc@1  70.31 ( 64.59)
Epoch: [9][200/313]	Time  0.421 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3359e+00 (4.3279e+00)	Acc@1  62.50 ( 64.65)
Epoch: [9][225/313]	Time  0.424 ( 0.423)	Data  0.018 ( 0.020)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  64.06 ( 64.70)
Epoch: [9][250/313]	Time  0.416 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3279e+00)	Acc@1  67.19 ( 64.67)
Epoch: [9][275/313]	Time  0.418 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3164e+00 (4.3282e+00)	Acc@1  67.97 ( 64.58)
Epoch: [9][300/313]	Time  0.419 ( 0.423)	Data  0.015 ( 0.019)	Loss 4.3516e+00 (4.3282e+00)	Acc@1  54.69 ( 64.62)
Validate: [ 0/79]	Time  0.990 ( 0.990)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3164e+00 (4.3274e+00)	Prompt Acc@1  62.50 ( 64.90)
Validate: [50/79]	Time  0.218 ( 0.237)	Loss 4.3438e+00 (4.3291e+00)	Prompt Acc@1  53.91 ( 64.57)
Validate: [75/79]	Time  0.223 ( 0.232)	Loss 4.3477e+00 (4.3287e+00)	Prompt Acc@1  62.50 ( 64.03)
 * Prompt Acc@1 64.060
saved best file
Training mode
Epoch: [10][  0/313]	Time  1.218 ( 1.218)	Data  0.805 ( 0.805)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [10][ 25/313]	Time  0.447 ( 0.453)	Data  0.034 ( 0.048)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.11)
Epoch: [10][ 50/313]	Time  0.418 ( 0.438)	Data  0.016 ( 0.033)	Loss 4.3398e+00 (4.3279e+00)	Acc@1  60.94 ( 64.74)
Epoch: [10][ 75/313]	Time  0.417 ( 0.432)	Data  0.017 ( 0.028)	Loss 4.3203e+00 (4.3282e+00)	Acc@1  65.62 ( 64.86)
Epoch: [10][100/313]	Time  0.421 ( 0.429)	Data  0.017 ( 0.025)	Loss 4.3242e+00 (4.3283e+00)	Acc@1  62.50 ( 64.81)
Epoch: [10][125/313]	Time  0.418 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3398e+00 (4.3282e+00)	Acc@1  61.72 ( 64.83)
Epoch: [10][150/313]	Time  0.432 ( 0.426)	Data  0.017 ( 0.022)	Loss 4.3125e+00 (4.3276e+00)	Acc@1  64.06 ( 64.86)
Epoch: [10][175/313]	Time  0.419 ( 0.425)	Data  0.015 ( 0.022)	Loss 4.3164e+00 (4.3282e+00)	Acc@1  69.53 ( 64.59)
Epoch: [10][200/313]	Time  0.415 ( 0.424)	Data  0.016 ( 0.021)	Loss 4.3359e+00 (4.3279e+00)	Acc@1  62.50 ( 64.63)
Epoch: [10][225/313]	Time  0.442 ( 0.424)	Data  0.016 ( 0.021)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  64.84 ( 64.70)
Epoch: [10][250/313]	Time  0.415 ( 0.424)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3279e+00)	Acc@1  67.19 ( 64.67)
Epoch: [10][275/313]	Time  0.426 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3164e+00 (4.3282e+00)	Acc@1  67.97 ( 64.57)
Epoch: [10][300/313]	Time  0.414 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3516e+00 (4.3282e+00)	Acc@1  54.69 ( 64.60)
Validate: [ 0/79]	Time  1.065 ( 1.065)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.260 ( 0.263)	Loss 4.3164e+00 (4.3274e+00)	Prompt Acc@1  62.50 ( 64.87)
Validate: [50/79]	Time  0.220 ( 0.244)	Loss 4.3438e+00 (4.3291e+00)	Prompt Acc@1  54.69 ( 64.61)
Validate: [75/79]	Time  0.217 ( 0.237)	Loss 4.3477e+00 (4.3288e+00)	Prompt Acc@1  62.50 ( 64.09)
 * Prompt Acc@1 64.120
saved best file
Training mode
Epoch: [11][  0/313]	Time  1.139 ( 1.139)	Data  0.712 ( 0.712)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [11][ 25/313]	Time  0.420 ( 0.450)	Data  0.022 ( 0.045)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.14)
Epoch: [11][ 50/313]	Time  0.413 ( 0.434)	Data  0.016 ( 0.031)	Loss 4.3398e+00 (4.3277e+00)	Acc@1  60.94 ( 64.75)
Epoch: [11][ 75/313]	Time  0.419 ( 0.429)	Data  0.017 ( 0.026)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  66.41 ( 64.87)
Epoch: [11][100/313]	Time  0.414 ( 0.427)	Data  0.016 ( 0.024)	Loss 4.3242e+00 (4.3281e+00)	Acc@1  62.50 ( 64.84)
Epoch: [11][125/313]	Time  0.414 ( 0.426)	Data  0.017 ( 0.023)	Loss 4.3398e+00 (4.3281e+00)	Acc@1  61.72 ( 64.83)
Epoch: [11][150/313]	Time  0.416 ( 0.424)	Data  0.017 ( 0.022)	Loss 4.3125e+00 (4.3274e+00)	Acc@1  64.06 ( 64.86)
Epoch: [11][175/313]	Time  0.418 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3281e+00)	Acc@1  69.53 ( 64.61)
Epoch: [11][200/313]	Time  0.426 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3359e+00 (4.3278e+00)	Acc@1  62.50 ( 64.65)
Epoch: [11][225/313]	Time  0.418 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3398e+00 (4.3277e+00)	Acc@1  66.41 ( 64.73)
Epoch: [11][250/313]	Time  0.413 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3278e+00)	Acc@1  66.41 ( 64.68)
Epoch: [11][275/313]	Time  0.415 ( 0.422)	Data  0.018 ( 0.019)	Loss 4.3164e+00 (4.3281e+00)	Acc@1  67.97 ( 64.59)
Epoch: [11][300/313]	Time  0.420 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3281e+00)	Acc@1  54.69 ( 64.63)
Validate: [ 0/79]	Time  0.920 ( 0.920)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.218 ( 0.251)	Loss 4.3164e+00 (4.3274e+00)	Prompt Acc@1  62.50 ( 64.84)
Validate: [50/79]	Time  0.221 ( 0.236)	Loss 4.3438e+00 (4.3289e+00)	Prompt Acc@1  53.91 ( 64.61)
Validate: [75/79]	Time  0.218 ( 0.232)	Loss 4.3477e+00 (4.3286e+00)	Prompt Acc@1  62.50 ( 64.10)
 * Prompt Acc@1 64.140
saved best file
Training mode
Epoch: [12][  0/313]	Time  1.165 ( 1.165)	Data  0.752 ( 0.752)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [12][ 25/313]	Time  0.415 ( 0.451)	Data  0.017 ( 0.046)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.17)
Epoch: [12][ 50/313]	Time  0.423 ( 0.436)	Data  0.017 ( 0.031)	Loss 4.3398e+00 (4.3277e+00)	Acc@1  60.94 ( 64.78)
Epoch: [12][ 75/313]	Time  0.419 ( 0.431)	Data  0.017 ( 0.027)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  66.41 ( 64.87)
Epoch: [12][100/313]	Time  0.421 ( 0.429)	Data  0.016 ( 0.025)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.83)
Epoch: [12][125/313]	Time  0.415 ( 0.427)	Data  0.017 ( 0.023)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  61.72 ( 64.82)
Epoch: [12][150/313]	Time  0.422 ( 0.426)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.85)
Epoch: [12][175/313]	Time  0.417 ( 0.425)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  69.53 ( 64.61)
Epoch: [12][200/313]	Time  0.420 ( 0.424)	Data  0.015 ( 0.021)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 64.67)
Epoch: [12][225/313]	Time  0.422 ( 0.424)	Data  0.017 ( 0.020)	Loss 4.3359e+00 (4.3276e+00)	Acc@1  65.62 ( 64.73)
Epoch: [12][250/313]	Time  0.419 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.68)
Epoch: [12][275/313]	Time  0.415 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  67.97 ( 64.59)
Epoch: [12][300/313]	Time  0.418 ( 0.423)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  54.69 ( 64.62)
Validate: [ 0/79]	Time  0.969 ( 0.969)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.75)
Validate: [50/79]	Time  0.221 ( 0.237)	Loss 4.3438e+00 (4.3289e+00)	Prompt Acc@1  53.91 ( 64.55)
Validate: [75/79]	Time  0.218 ( 0.232)	Loss 4.3477e+00 (4.3285e+00)	Prompt Acc@1  62.50 ( 64.03)
 * Prompt Acc@1 64.060
There's no improvement for 1 epochs.
Training mode
Epoch: [13][  0/313]	Time  1.175 ( 1.175)	Data  0.750 ( 0.750)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [13][ 25/313]	Time  0.419 ( 0.449)	Data  0.016 ( 0.045)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.11)
Epoch: [13][ 50/313]	Time  0.413 ( 0.435)	Data  0.016 ( 0.031)	Loss 4.3398e+00 (4.3277e+00)	Acc@1  60.94 ( 64.75)
Epoch: [13][ 75/313]	Time  0.424 ( 0.430)	Data  0.018 ( 0.027)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  67.19 ( 64.87)
Epoch: [13][100/313]	Time  0.421 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.85)
Epoch: [13][125/313]	Time  0.421 ( 0.425)	Data  0.016 ( 0.023)	Loss 4.3398e+00 (4.3279e+00)	Acc@1  61.72 ( 64.86)
Epoch: [13][150/313]	Time  0.416 ( 0.424)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.90)
Epoch: [13][175/313]	Time  0.429 ( 0.424)	Data  0.018 ( 0.021)	Loss 4.3164e+00 (4.3279e+00)	Acc@1  69.53 ( 64.65)
Epoch: [13][200/313]	Time  0.417 ( 0.423)	Data  0.015 ( 0.021)	Loss 4.3359e+00 (4.3276e+00)	Acc@1  62.50 ( 64.71)
Epoch: [13][225/313]	Time  0.415 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3359e+00 (4.3276e+00)	Acc@1  65.62 ( 64.78)
Epoch: [13][250/313]	Time  0.426 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.73)
Epoch: [13][275/313]	Time  0.416 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  67.97 ( 64.63)
Epoch: [13][300/313]	Time  0.428 ( 0.422)	Data  0.017 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  55.47 ( 64.66)
Validate: [ 0/79]	Time  0.932 ( 0.932)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.253)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.72)
Validate: [50/79]	Time  0.222 ( 0.237)	Loss 4.3438e+00 (4.3289e+00)	Prompt Acc@1  53.91 ( 64.48)
Validate: [75/79]	Time  0.218 ( 0.231)	Loss 4.3477e+00 (4.3285e+00)	Prompt Acc@1  62.50 ( 64.02)
 * Prompt Acc@1 64.050
There's no improvement for 2 epochs.
Training mode
Epoch: [14][  0/313]	Time  1.167 ( 1.167)	Data  0.746 ( 0.746)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [14][ 25/313]	Time  0.418 ( 0.448)	Data  0.016 ( 0.045)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.11)
Epoch: [14][ 50/313]	Time  0.416 ( 0.433)	Data  0.015 ( 0.031)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  60.94 ( 64.72)
Epoch: [14][ 75/313]	Time  0.412 ( 0.429)	Data  0.015 ( 0.026)	Loss 4.3203e+00 (4.3281e+00)	Acc@1  67.19 ( 64.84)
Epoch: [14][100/313]	Time  0.420 ( 0.427)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.82)
Epoch: [14][125/313]	Time  0.421 ( 0.426)	Data  0.017 ( 0.023)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  61.72 ( 64.83)
Epoch: [14][150/313]	Time  0.420 ( 0.425)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.87)
Epoch: [14][175/313]	Time  0.416 ( 0.424)	Data  0.016 ( 0.021)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  69.53 ( 64.62)
Epoch: [14][200/313]	Time  0.414 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 64.71)
Epoch: [14][225/313]	Time  0.420 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3398e+00 (4.3276e+00)	Acc@1  66.41 ( 64.77)
Epoch: [14][250/313]	Time  0.427 ( 0.422)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.72)
Epoch: [14][275/313]	Time  0.415 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  68.75 ( 64.62)
Epoch: [14][300/313]	Time  0.426 ( 0.422)	Data  0.020 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  54.69 ( 64.64)
Validate: [ 0/79]	Time  1.069 ( 1.069)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.220 ( 0.269)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.69)
Validate: [50/79]	Time  0.220 ( 0.246)	Loss 4.3438e+00 (4.3289e+00)	Prompt Acc@1  53.91 ( 64.51)
Validate: [75/79]	Time  0.218 ( 0.238)	Loss 4.3477e+00 (4.3285e+00)	Prompt Acc@1  62.50 ( 64.05)
 * Prompt Acc@1 64.080
There's no improvement for 3 epochs.
Training mode
Epoch: [15][  0/313]	Time  1.270 ( 1.270)	Data  0.853 ( 0.853)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  62.50 ( 62.50)
Epoch: [15][ 25/313]	Time  0.413 ( 0.453)	Data  0.016 ( 0.049)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.17)
Epoch: [15][ 50/313]	Time  0.416 ( 0.436)	Data  0.015 ( 0.033)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  60.94 ( 64.74)
Epoch: [15][ 75/313]	Time  0.420 ( 0.431)	Data  0.016 ( 0.028)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  67.19 ( 64.84)
Epoch: [15][100/313]	Time  0.424 ( 0.428)	Data  0.015 ( 0.025)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.81)
Epoch: [15][125/313]	Time  0.424 ( 0.426)	Data  0.023 ( 0.024)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  62.50 ( 64.80)
Epoch: [15][150/313]	Time  0.419 ( 0.425)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.85)
Epoch: [15][175/313]	Time  0.423 ( 0.424)	Data  0.016 ( 0.022)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  69.53 ( 64.60)
Epoch: [15][200/313]	Time  0.419 ( 0.424)	Data  0.017 ( 0.021)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 64.68)
Epoch: [15][225/313]	Time  0.412 ( 0.423)	Data  0.016 ( 0.021)	Loss 4.3398e+00 (4.3276e+00)	Acc@1  65.62 ( 64.75)
Epoch: [15][250/313]	Time  0.418 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.70)
Epoch: [15][275/313]	Time  0.416 ( 0.423)	Data  0.016 ( 0.020)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  68.75 ( 64.60)
Epoch: [15][300/313]	Time  0.419 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  54.69 ( 64.63)
Validate: [ 0/79]	Time  0.927 ( 0.927)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.220 ( 0.262)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.78)
Validate: [50/79]	Time  0.234 ( 0.248)	Loss 4.3438e+00 (4.3289e+00)	Prompt Acc@1  53.91 ( 64.58)
Validate: [75/79]	Time  0.220 ( 0.241)	Loss 4.3477e+00 (4.3285e+00)	Prompt Acc@1  62.50 ( 64.09)
 * Prompt Acc@1 64.120
There's no improvement for 4 epochs.
Training mode
Epoch: [16][  0/313]	Time  1.148 ( 1.148)	Data  0.746 ( 0.746)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  62.50 ( 62.50)
Epoch: [16][ 25/313]	Time  0.424 ( 0.450)	Data  0.017 ( 0.046)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.17)
Epoch: [16][ 50/313]	Time  0.423 ( 0.436)	Data  0.017 ( 0.032)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  60.94 ( 64.77)
Epoch: [16][ 75/313]	Time  0.418 ( 0.431)	Data  0.017 ( 0.027)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  67.19 ( 64.86)
Epoch: [16][100/313]	Time  0.435 ( 0.429)	Data  0.018 ( 0.025)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.82)
Epoch: [16][125/313]	Time  0.414 ( 0.427)	Data  0.016 ( 0.024)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  62.50 ( 64.83)
Epoch: [16][150/313]	Time  0.415 ( 0.425)	Data  0.017 ( 0.022)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.85)
Epoch: [16][175/313]	Time  0.412 ( 0.424)	Data  0.016 ( 0.022)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  69.53 ( 64.60)
Epoch: [16][200/313]	Time  0.418 ( 0.423)	Data  0.016 ( 0.021)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 64.69)
Epoch: [16][225/313]	Time  0.415 ( 0.423)	Data  0.017 ( 0.020)	Loss 4.3359e+00 (4.3276e+00)	Acc@1  65.62 ( 64.77)
Epoch: [16][250/313]	Time  0.422 ( 0.422)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.73)
Epoch: [16][275/313]	Time  0.428 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  67.97 ( 64.63)
Epoch: [16][300/313]	Time  0.414 ( 0.422)	Data  0.015 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  55.47 ( 64.65)
Validate: [ 0/79]	Time  0.963 ( 0.963)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3164e+00 (4.3271e+00)	Prompt Acc@1  62.50 ( 64.72)
Validate: [50/79]	Time  0.219 ( 0.237)	Loss 4.3438e+00 (4.3287e+00)	Prompt Acc@1  53.91 ( 64.54)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 4.3477e+00 (4.3284e+00)	Prompt Acc@1  62.50 ( 64.05)
 * Prompt Acc@1 64.080
There's no improvement for 5 epochs.
Training mode
Epoch: [17][  0/313]	Time  1.145 ( 1.145)	Data  0.742 ( 0.742)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  61.72 ( 61.72)
Epoch: [17][ 25/313]	Time  0.413 ( 0.446)	Data  0.016 ( 0.045)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.14)
Epoch: [17][ 50/313]	Time  0.413 ( 0.432)	Data  0.017 ( 0.031)	Loss 4.3398e+00 (4.3278e+00)	Acc@1  60.94 ( 64.78)
Epoch: [17][ 75/313]	Time  0.412 ( 0.427)	Data  0.016 ( 0.026)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  67.19 ( 64.88)
Epoch: [17][100/313]	Time  0.423 ( 0.425)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3280e+00)	Acc@1  62.50 ( 64.84)
Epoch: [17][125/313]	Time  0.414 ( 0.424)	Data  0.015 ( 0.022)	Loss 4.3398e+00 (4.3280e+00)	Acc@1  61.72 ( 64.83)
Epoch: [17][150/313]	Time  0.415 ( 0.423)	Data  0.018 ( 0.021)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.87)
Epoch: [17][175/313]	Time  0.420 ( 0.423)	Data  0.017 ( 0.021)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  69.53 ( 64.61)
Epoch: [17][200/313]	Time  0.420 ( 0.422)	Data  0.017 ( 0.020)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 64.70)
Epoch: [17][225/313]	Time  0.420 ( 0.422)	Data  0.018 ( 0.020)	Loss 4.3398e+00 (4.3276e+00)	Acc@1  66.41 ( 64.76)
Epoch: [17][250/313]	Time  0.415 ( 0.421)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.72)
Epoch: [17][275/313]	Time  0.419 ( 0.421)	Data  0.016 ( 0.019)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  67.97 ( 64.61)
Epoch: [17][300/313]	Time  0.412 ( 0.421)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  54.69 ( 64.64)
Validate: [ 0/79]	Time  0.955 ( 0.955)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3164e+00 (4.3271e+00)	Prompt Acc@1  62.50 ( 64.78)
Validate: [50/79]	Time  0.221 ( 0.237)	Loss 4.3438e+00 (4.3287e+00)	Prompt Acc@1  53.91 ( 64.52)
Validate: [75/79]	Time  0.220 ( 0.231)	Loss 4.3477e+00 (4.3284e+00)	Prompt Acc@1  62.50 ( 64.02)
 * Prompt Acc@1 64.050
There's no improvement for 6 epochs.
Training mode
Epoch: [18][  0/313]	Time  1.108 ( 1.108)	Data  0.698 ( 0.698)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  62.50 ( 62.50)
Epoch: [18][ 25/313]	Time  0.420 ( 0.444)	Data  0.017 ( 0.043)	Loss 4.3203e+00 (4.3268e+00)	Acc@1  67.19 ( 65.17)
Epoch: [18][ 50/313]	Time  0.417 ( 0.432)	Data  0.016 ( 0.030)	Loss 4.3398e+00 (4.3277e+00)	Acc@1  60.94 ( 64.78)
Epoch: [18][ 75/313]	Time  0.420 ( 0.427)	Data  0.017 ( 0.026)	Loss 4.3203e+00 (4.3280e+00)	Acc@1  67.19 ( 64.88)
Epoch: [18][100/313]	Time  0.421 ( 0.425)	Data  0.022 ( 0.023)	Loss 4.3242e+00 (4.3279e+00)	Acc@1  62.50 ( 64.83)
Epoch: [18][125/313]	Time  0.416 ( 0.424)	Data  0.017 ( 0.022)	Loss 4.3398e+00 (4.3279e+00)	Acc@1  61.72 ( 64.82)
Epoch: [18][150/313]	Time  0.416 ( 0.423)	Data  0.016 ( 0.021)	Loss 4.3125e+00 (4.3273e+00)	Acc@1  64.06 ( 64.87)
Epoch: [18][175/313]	Time  0.426 ( 0.422)	Data  0.017 ( 0.020)	Loss 4.3164e+00 (4.3279e+00)	Acc@1  69.53 ( 64.63)
Epoch: [18][200/313]	Time  0.425 ( 0.422)	Data  0.017 ( 0.020)	Loss 4.3320e+00 (4.3276e+00)	Acc@1  62.50 ( 64.70)
Epoch: [18][225/313]	Time  0.419 ( 0.422)	Data  0.016 ( 0.020)	Loss 4.3398e+00 (4.3275e+00)	Acc@1  65.62 ( 64.78)
Epoch: [18][250/313]	Time  0.419 ( 0.422)	Data  0.017 ( 0.019)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  66.41 ( 64.73)
Epoch: [18][275/313]	Time  0.423 ( 0.422)	Data  0.018 ( 0.019)	Loss 4.3164e+00 (4.3280e+00)	Acc@1  67.97 ( 64.62)
Epoch: [18][300/313]	Time  0.414 ( 0.422)	Data  0.016 ( 0.019)	Loss 4.3516e+00 (4.3280e+00)	Acc@1  54.69 ( 64.64)
Validate: [ 0/79]	Time  0.995 ( 0.995)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.222 ( 0.258)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.75)
Validate: [50/79]	Time  0.219 ( 0.240)	Loss 4.3438e+00 (4.3288e+00)	Prompt Acc@1  53.91 ( 64.52)
Validate: [75/79]	Time  0.221 ( 0.234)	Loss 4.3477e+00 (4.3284e+00)	Prompt Acc@1  62.50 ( 64.03)
 * Prompt Acc@1 64.070
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Validate: [ 0/79]	Time  0.907 ( 0.907)	Loss 4.3359e+00 (4.3359e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.216 ( 0.250)	Loss 4.3164e+00 (4.3272e+00)	Prompt Acc@1  62.50 ( 64.75)
Validate: [50/79]	Time  0.221 ( 0.235)	Loss 4.3438e+00 (4.3288e+00)	Prompt Acc@1  53.91 ( 64.52)
Validate: [75/79]	Time  0.218 ( 0.230)	Loss 4.3477e+00 (4.3284e+00)	Prompt Acc@1  62.50 ( 64.03)
 * Prompt Acc@1 64.070
Validate: [ 0/79]	Time  0.908 ( 0.908)	Loss 4.3047e+00 (4.3047e+00)	Prompt Acc@1  70.31 ( 70.31)
Validate: [25/79]	Time  0.221 ( 0.252)	Loss 4.3203e+00 (4.3290e+00)	Prompt Acc@1  62.50 ( 64.12)
Validate: [50/79]	Time  0.219 ( 0.237)	Loss 4.3398e+00 (4.3313e+00)	Prompt Acc@1  64.06 ( 64.20)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 4.3086e+00 (4.3297e+00)	Prompt Acc@1  65.62 ( 64.26)
 * Prompt Acc@1 64.280
Running experiment on cifar100 with random_patch and prompt size 1
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='random_patch', prompt_size=1, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='random_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/random_patch_1_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
"Parameters to be updated: {'prompt_learner.random_patch'}"
Number of prompt parameters:  3
Training mode
Epoch: [0][  0/313]	Time  2.156 ( 2.156)	Data  0.738 ( 0.738)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  63.28 ( 63.28)
Epoch: [0][ 25/313]	Time  0.417 ( 0.485)	Data  0.017 ( 0.044)	Loss 4.3477e+00 (4.3392e+00)	Acc@1  64.84 ( 63.85)
Epoch: [0][ 50/313]	Time  0.420 ( 0.452)	Data  0.017 ( 0.030)	Loss 4.3242e+00 (4.3382e+00)	Acc@1  65.62 ( 63.39)
Epoch: [0][ 75/313]	Time  0.418 ( 0.441)	Data  0.016 ( 0.026)	Loss 4.3320e+00 (4.3351e+00)	Acc@1  64.06 ( 63.97)
Epoch: [0][100/313]	Time  0.413 ( 0.435)	Data  0.017 ( 0.024)	Loss 4.3242e+00 (4.3333e+00)	Acc@1  67.97 ( 64.35)
Epoch: [0][125/313]	Time  0.426 ( 0.432)	Data  0.017 ( 0.022)	Loss 4.3086e+00 (4.3330e+00)	Acc@1  74.22 ( 64.35)
Epoch: [0][150/313]	Time  0.415 ( 0.430)	Data  0.016 ( 0.021)	Loss 4.3203e+00 (4.3322e+00)	Acc@1  64.06 ( 64.20)
Epoch: [0][175/313]	Time  0.417 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3594e+00 (4.3317e+00)	Acc@1  53.91 ( 64.15)
Epoch: [0][200/313]	Time  0.414 ( 0.428)	Data  0.015 ( 0.020)	Loss 4.3398e+00 (4.3311e+00)	Acc@1  57.03 ( 64.34)
Epoch: [0][225/313]	Time  0.443 ( 0.427)	Data  0.024 ( 0.020)	Loss 4.3359e+00 (4.3309e+00)	Acc@1  64.06 ( 64.17)
Epoch: [0][250/313]	Time  0.419 ( 0.427)	Data  0.018 ( 0.020)	Loss 4.3281e+00 (4.3309e+00)	Acc@1  62.50 ( 63.98)
Epoch: [0][275/313]	Time  0.421 ( 0.426)	Data  0.016 ( 0.019)	Loss 4.3242e+00 (4.3306e+00)	Acc@1  60.94 ( 64.03)
Epoch: [0][300/313]	Time  0.417 ( 0.426)	Data  0.018 ( 0.019)	Loss 4.3203e+00 (4.3301e+00)	Acc@1  68.75 ( 64.05)
Validate: [ 0/79]	Time  0.985 ( 0.985)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  66.41 ( 66.41)
Validate: [25/79]	Time  0.220 ( 0.255)	Loss 4.3281e+00 (4.3280e+00)	Prompt Acc@1  61.72 ( 63.70)
Validate: [50/79]	Time  0.223 ( 0.238)	Loss 4.3242e+00 (4.3277e+00)	Prompt Acc@1  64.06 ( 64.05)
Validate: [75/79]	Time  0.219 ( 0.234)	Loss 4.3125e+00 (4.3278e+00)	Prompt Acc@1  63.28 ( 63.82)
 * Prompt Acc@1 63.830
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.198 ( 1.198)	Data  0.771 ( 0.771)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  63.28 ( 63.28)
Epoch: [1][ 25/313]	Time  0.418 ( 0.450)	Data  0.016 ( 0.046)	Loss 4.3320e+00 (4.3272e+00)	Acc@1  60.94 ( 62.95)
Epoch: [1][ 50/313]	Time  0.425 ( 0.435)	Data  0.017 ( 0.032)	Loss 4.3203e+00 (4.3277e+00)	Acc@1  66.41 ( 63.01)
Epoch: [1][ 75/313]	Time  0.420 ( 0.431)	Data  0.016 ( 0.027)	Loss 4.3281e+00 (4.3265e+00)	Acc@1  61.72 ( 63.47)
Epoch: [1][100/313]	Time  0.415 ( 0.428)	Data  0.016 ( 0.024)	Loss 4.3203e+00 (4.3264e+00)	Acc@1  67.97 ( 63.87)
Epoch: [1][125/313]	Time  0.421 ( 0.427)	Data  0.016 ( 0.023)	Loss 4.3320e+00 (4.3272e+00)	Acc@1  73.44 ( 63.96)
Epoch: [1][150/313]	Time  0.415 ( 0.426)	Data  0.016 ( 0.022)	Loss 4.3164e+00 (4.3270e+00)	Acc@1  60.94 ( 63.85)
Epoch: [1][175/313]	Time  0.437 ( 0.425)	Data  0.016 ( 0.021)	Loss 4.3594e+00 (4.3273e+00)	Acc@1  53.12 ( 63.80)
Epoch: [1][200/313]	Time  0.419 ( 0.425)	Data  0.016 ( 0.021)	Loss 4.3320e+00 (4.3271e+00)	Acc@1  60.94 ( 64.02)
Epoch: [1][225/313]	Time  0.443 ( 0.424)	Data  0.029 ( 0.020)	Loss 4.3281e+00 (4.3273e+00)	Acc@1  65.62 ( 63.88)
Epoch: [1][250/313]	Time  0.440 ( 0.424)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3275e+00)	Acc@1  68.75 ( 63.73)
Epoch: [1][275/313]	Time  0.421 ( 0.424)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3276e+00)	Acc@1  60.16 ( 63.80)
Epoch: [1][300/313]	Time  0.418 ( 0.424)	Data  0.016 ( 0.019)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  65.62 ( 63.88)
Validate: [ 0/79]	Time  0.924 ( 0.924)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.220 ( 0.253)	Loss 4.3320e+00 (4.3280e+00)	Prompt Acc@1  59.38 ( 63.10)
Validate: [50/79]	Time  0.222 ( 0.237)	Loss 4.3242e+00 (4.3271e+00)	Prompt Acc@1  63.28 ( 63.86)
Validate: [75/79]	Time  0.221 ( 0.233)	Loss 4.3164e+00 (4.3270e+00)	Prompt Acc@1  61.72 ( 63.89)
 * Prompt Acc@1 63.890
saved best file
Training mode
Epoch: [2][  0/313]	Time  1.225 ( 1.225)	Data  0.789 ( 0.789)	Loss 4.3242e+00 (4.3242e+00)	Acc@1  62.50 ( 62.50)
Epoch: [2][ 25/313]	Time  0.415 ( 0.453)	Data  0.016 ( 0.048)	Loss 4.3359e+00 (4.3292e+00)	Acc@1  60.94 ( 63.16)
Epoch: [2][ 50/313]	Time  0.424 ( 0.437)	Data  0.016 ( 0.032)	Loss 4.3242e+00 (4.3293e+00)	Acc@1  64.06 ( 63.50)
Epoch: [2][ 75/313]	Time  0.417 ( 0.432)	Data  0.016 ( 0.027)	Loss 4.3516e+00 (4.3278e+00)	Acc@1  65.62 ( 64.00)
Epoch: [2][100/313]	Time  0.420 ( 0.429)	Data  0.016 ( 0.025)	Loss 4.3203e+00 (4.3275e+00)	Acc@1  64.06 ( 64.24)
Epoch: [2][125/313]	Time  0.418 ( 0.428)	Data  0.016 ( 0.023)	Loss 4.3047e+00 (4.3278e+00)	Acc@1  72.66 ( 64.16)
Epoch: [2][150/313]	Time  0.425 ( 0.427)	Data  0.017 ( 0.022)	Loss 4.3164e+00 (4.3275e+00)	Acc@1  62.50 ( 64.07)
Epoch: [2][175/313]	Time  0.428 ( 0.426)	Data  0.017 ( 0.021)	Loss 4.3633e+00 (4.3275e+00)	Acc@1  55.47 ( 63.96)
Epoch: [2][200/313]	Time  0.417 ( 0.425)	Data  0.017 ( 0.021)	Loss 4.3398e+00 (4.3274e+00)	Acc@1  56.25 ( 64.05)
Epoch: [2][225/313]	Time  0.417 ( 0.425)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3274e+00)	Acc@1  64.84 ( 63.94)
Epoch: [2][250/313]	Time  0.420 ( 0.425)	Data  0.016 ( 0.020)	Loss 4.3242e+00 (4.3277e+00)	Acc@1  65.62 ( 63.73)
Epoch: [2][275/313]	Time  0.414 ( 0.424)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3278e+00)	Acc@1  63.28 ( 63.76)
Epoch: [2][300/313]	Time  0.421 ( 0.424)	Data  0.016 ( 0.020)	Loss 4.3242e+00 (4.3276e+00)	Acc@1  68.75 ( 63.81)
Validate: [ 0/79]	Time  0.957 ( 0.957)	Loss 4.3281e+00 (4.3281e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.221 ( 0.256)	Loss 4.3320e+00 (4.3278e+00)	Prompt Acc@1  60.94 ( 63.16)
Validate: [50/79]	Time  0.222 ( 0.239)	Loss 4.3242e+00 (4.3266e+00)	Prompt Acc@1  64.06 ( 64.23)
Validate: [75/79]	Time  0.219 ( 0.233)	Loss 4.3164e+00 (4.3267e+00)	Prompt Acc@1  63.28 ( 64.08)
 * Prompt Acc@1 64.110
saved best file
Training mode
Epoch: [3][  0/313]	Time  1.223 ( 1.223)	Data  0.775 ( 0.775)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  66.41 ( 66.41)
Epoch: [3][ 25/313]	Time  0.415 ( 0.451)	Data  0.016 ( 0.046)	Loss 4.3359e+00 (4.3272e+00)	Acc@1  64.06 ( 63.64)
Epoch: [3][ 50/313]	Time  0.432 ( 0.437)	Data  0.016 ( 0.032)	Loss 4.3203e+00 (4.3288e+00)	Acc@1  67.19 ( 63.30)
Epoch: [3][ 75/313]	Time  0.424 ( 0.432)	Data  0.017 ( 0.027)	Loss 4.3281e+00 (4.3273e+00)	Acc@1  63.28 ( 63.92)
Epoch: [3][100/313]	Time  0.421 ( 0.430)	Data  0.017 ( 0.024)	Loss 4.3320e+00 (4.3273e+00)	Acc@1  67.97 ( 64.29)
Epoch: [3][125/313]	Time  0.427 ( 0.429)	Data  0.017 ( 0.023)	Loss 4.3047e+00 (4.3276e+00)	Acc@1  75.00 ( 64.28)
Epoch: [3][150/313]	Time  0.425 ( 0.429)	Data  0.017 ( 0.022)	Loss 4.3164e+00 (4.3273e+00)	Acc@1  64.06 ( 64.07)
Epoch: [3][175/313]	Time  0.422 ( 0.428)	Data  0.017 ( 0.021)	Loss 4.3633e+00 (4.3275e+00)	Acc@1  56.25 ( 63.96)
Epoch: [3][200/313]	Time  0.421 ( 0.428)	Data  0.016 ( 0.021)	Loss 4.3398e+00 (4.3276e+00)	Acc@1  63.28 ( 64.18)
Epoch: [3][225/313]	Time  0.427 ( 0.427)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3276e+00)	Acc@1  61.72 ( 64.06)
Epoch: [3][250/313]	Time  0.425 ( 0.427)	Data  0.018 ( 0.020)	Loss 4.3242e+00 (4.3277e+00)	Acc@1  64.84 ( 63.91)
Epoch: [3][275/313]	Time  0.425 ( 0.427)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3278e+00)	Acc@1  60.16 ( 63.94)
Epoch: [3][300/313]	Time  0.422 ( 0.427)	Data  0.017 ( 0.020)	Loss 4.3203e+00 (4.3276e+00)	Acc@1  69.53 ( 63.89)
Validate: [ 0/79]	Time  0.971 ( 0.971)	Loss 4.3320e+00 (4.3320e+00)	Prompt Acc@1  59.38 ( 59.38)
Validate: [25/79]	Time  0.222 ( 0.256)	Loss 4.3242e+00 (4.3275e+00)	Prompt Acc@1  60.94 ( 63.07)
Validate: [50/79]	Time  0.219 ( 0.240)	Loss 4.3242e+00 (4.3266e+00)	Prompt Acc@1  64.06 ( 63.91)
Validate: [75/79]	Time  0.221 ( 0.234)	Loss 4.3164e+00 (4.3270e+00)	Prompt Acc@1  63.28 ( 63.60)
 * Prompt Acc@1 63.580
There's no improvement for 1 epochs.
Training mode
Epoch: [4][  0/313]	Time  1.253 ( 1.253)	Data  0.818 ( 0.818)	Loss 4.3242e+00 (4.3242e+00)	Acc@1  61.72 ( 61.72)
Epoch: [4][ 25/313]	Time  0.420 ( 0.458)	Data  0.017 ( 0.048)	Loss 4.3359e+00 (4.3278e+00)	Acc@1  61.72 ( 63.97)
Epoch: [4][ 50/313]	Time  0.421 ( 0.441)	Data  0.017 ( 0.033)	Loss 4.3203e+00 (4.3290e+00)	Acc@1  69.53 ( 63.51)
Epoch: [4][ 75/313]	Time  0.419 ( 0.436)	Data  0.015 ( 0.027)	Loss 4.3281e+00 (4.3273e+00)	Acc@1  61.72 ( 64.00)
Epoch: [4][100/313]	Time  0.433 ( 0.433)	Data  0.016 ( 0.025)	Loss 4.3203e+00 (4.3269e+00)	Acc@1  66.41 ( 64.30)
Epoch: [4][125/313]	Time  0.421 ( 0.432)	Data  0.016 ( 0.023)	Loss 4.3086e+00 (4.3272e+00)	Acc@1  75.00 ( 64.13)
Epoch: [4][150/313]	Time  0.423 ( 0.430)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3269e+00)	Acc@1  61.72 ( 64.02)
Epoch: [4][175/313]	Time  0.420 ( 0.430)	Data  0.017 ( 0.021)	Loss 4.3594e+00 (4.3270e+00)	Acc@1  50.78 ( 63.94)
Epoch: [4][200/313]	Time  0.432 ( 0.429)	Data  0.017 ( 0.021)	Loss 4.3398e+00 (4.3269e+00)	Acc@1  56.25 ( 64.03)
Epoch: [4][225/313]	Time  0.420 ( 0.429)	Data  0.017 ( 0.021)	Loss 4.3320e+00 (4.3271e+00)	Acc@1  63.28 ( 63.97)
Epoch: [4][250/313]	Time  0.423 ( 0.429)	Data  0.017 ( 0.020)	Loss 4.3203e+00 (4.3272e+00)	Acc@1  65.62 ( 63.82)
Epoch: [4][275/313]	Time  0.425 ( 0.429)	Data  0.018 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  61.72 ( 63.87)
Epoch: [4][300/313]	Time  0.425 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3164e+00 (4.3271e+00)	Acc@1  68.75 ( 63.93)
Validate: [ 0/79]	Time  0.979 ( 0.979)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.221 ( 0.252)	Loss 4.3281e+00 (4.3266e+00)	Prompt Acc@1  60.94 ( 64.15)
Validate: [50/79]	Time  0.222 ( 0.237)	Loss 4.3203e+00 (4.3257e+00)	Prompt Acc@1  65.62 ( 64.52)
Validate: [75/79]	Time  0.220 ( 0.232)	Loss 4.3164e+00 (4.3261e+00)	Prompt Acc@1  64.06 ( 64.25)
 * Prompt Acc@1 64.220
saved best file
Training mode
Epoch: [5][  0/313]	Time  1.224 ( 1.224)	Data  0.797 ( 0.797)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  62.50 ( 62.50)
Epoch: [5][ 25/313]	Time  0.425 ( 0.457)	Data  0.017 ( 0.049)	Loss 4.3359e+00 (4.3284e+00)	Acc@1  59.38 ( 63.46)
Epoch: [5][ 50/313]	Time  0.427 ( 0.441)	Data  0.017 ( 0.033)	Loss 4.3242e+00 (4.3296e+00)	Acc@1  64.84 ( 63.37)
Epoch: [5][ 75/313]	Time  0.439 ( 0.437)	Data  0.027 ( 0.028)	Loss 4.3320e+00 (4.3277e+00)	Acc@1  62.50 ( 63.89)
Epoch: [5][100/313]	Time  0.424 ( 0.433)	Data  0.016 ( 0.025)	Loss 4.3203e+00 (4.3271e+00)	Acc@1  66.41 ( 64.09)
Epoch: [5][125/313]	Time  0.432 ( 0.432)	Data  0.023 ( 0.024)	Loss 4.3008e+00 (4.3274e+00)	Acc@1  71.88 ( 63.96)
Epoch: [5][150/313]	Time  0.425 ( 0.431)	Data  0.015 ( 0.023)	Loss 4.3203e+00 (4.3270e+00)	Acc@1  62.50 ( 63.96)
Epoch: [5][175/313]	Time  0.424 ( 0.430)	Data  0.017 ( 0.022)	Loss 4.3633e+00 (4.3270e+00)	Acc@1  56.25 ( 63.95)
Epoch: [5][200/313]	Time  0.425 ( 0.429)	Data  0.015 ( 0.021)	Loss 4.3320e+00 (4.3267e+00)	Acc@1  57.81 ( 64.09)
Epoch: [5][225/313]	Time  0.424 ( 0.429)	Data  0.017 ( 0.021)	Loss 4.3320e+00 (4.3269e+00)	Acc@1  64.06 ( 63.95)
Epoch: [5][250/313]	Time  0.420 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  64.06 ( 63.77)
Epoch: [5][275/313]	Time  0.419 ( 0.428)	Data  0.016 ( 0.020)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  61.72 ( 63.86)
Epoch: [5][300/313]	Time  0.421 ( 0.428)	Data  0.016 ( 0.020)	Loss 4.3203e+00 (4.3272e+00)	Acc@1  68.75 ( 63.90)
Validate: [ 0/79]	Time  1.001 ( 1.001)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.230 ( 0.258)	Loss 4.3320e+00 (4.3275e+00)	Prompt Acc@1  64.06 ( 63.40)
Validate: [50/79]	Time  0.221 ( 0.243)	Loss 4.3203e+00 (4.3268e+00)	Prompt Acc@1  64.84 ( 63.97)
Validate: [75/79]	Time  0.222 ( 0.237)	Loss 4.3164e+00 (4.3275e+00)	Prompt Acc@1  64.06 ( 63.58)
 * Prompt Acc@1 63.590
There's no improvement for 1 epochs.
Training mode
Epoch: [6][  0/313]	Time  1.293 ( 1.293)	Data  0.875 ( 0.875)	Loss 4.3203e+00 (4.3203e+00)	Acc@1  64.84 ( 64.84)
Epoch: [6][ 25/313]	Time  0.424 ( 0.461)	Data  0.018 ( 0.051)	Loss 4.3320e+00 (4.3275e+00)	Acc@1  61.72 ( 63.25)
Epoch: [6][ 50/313]	Time  0.421 ( 0.443)	Data  0.017 ( 0.035)	Loss 4.3242e+00 (4.3287e+00)	Acc@1  66.41 ( 63.07)
Epoch: [6][ 75/313]	Time  0.419 ( 0.437)	Data  0.018 ( 0.029)	Loss 4.3242e+00 (4.3271e+00)	Acc@1  62.50 ( 63.84)
Epoch: [6][100/313]	Time  0.418 ( 0.433)	Data  0.017 ( 0.026)	Loss 4.3242e+00 (4.3268e+00)	Acc@1  64.06 ( 63.94)
Epoch: [6][125/313]	Time  0.421 ( 0.432)	Data  0.017 ( 0.024)	Loss 4.3047e+00 (4.3273e+00)	Acc@1  72.66 ( 63.94)
Epoch: [6][150/313]	Time  0.422 ( 0.431)	Data  0.016 ( 0.023)	Loss 4.3125e+00 (4.3270e+00)	Acc@1  64.84 ( 63.81)
Epoch: [6][175/313]	Time  0.419 ( 0.430)	Data  0.016 ( 0.022)	Loss 4.3555e+00 (4.3270e+00)	Acc@1  55.47 ( 63.74)
Epoch: [6][200/313]	Time  0.438 ( 0.429)	Data  0.017 ( 0.021)	Loss 4.3359e+00 (4.3268e+00)	Acc@1  59.38 ( 63.93)
Epoch: [6][225/313]	Time  0.430 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3320e+00 (4.3270e+00)	Acc@1  62.50 ( 63.79)
Epoch: [6][250/313]	Time  0.441 ( 0.428)	Data  0.018 ( 0.020)	Loss 4.3281e+00 (4.3274e+00)	Acc@1  63.28 ( 63.63)
Epoch: [6][275/313]	Time  0.436 ( 0.428)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3274e+00)	Acc@1  60.94 ( 63.72)
Epoch: [6][300/313]	Time  0.425 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  68.75 ( 63.77)
Validate: [ 0/79]	Time  1.007 ( 1.007)	Loss 4.3281e+00 (4.3281e+00)	Prompt Acc@1  66.41 ( 66.41)
Validate: [25/79]	Time  0.220 ( 0.256)	Loss 4.3281e+00 (4.3263e+00)	Prompt Acc@1  61.72 ( 63.52)
Validate: [50/79]	Time  0.220 ( 0.240)	Loss 4.3281e+00 (4.3255e+00)	Prompt Acc@1  67.19 ( 64.14)
Validate: [75/79]	Time  0.219 ( 0.235)	Loss 4.3125e+00 (4.3263e+00)	Prompt Acc@1  64.06 ( 63.85)
 * Prompt Acc@1 63.870
There's no improvement for 2 epochs.
Training mode
Epoch: [7][  0/313]	Time  1.129 ( 1.129)	Data  0.715 ( 0.715)	Loss 4.3398e+00 (4.3398e+00)	Acc@1  60.16 ( 60.16)
Epoch: [7][ 25/313]	Time  0.422 ( 0.450)	Data  0.017 ( 0.044)	Loss 4.3359e+00 (4.3286e+00)	Acc@1  60.16 ( 63.16)
Epoch: [7][ 50/313]	Time  0.419 ( 0.437)	Data  0.017 ( 0.031)	Loss 4.3203e+00 (4.3288e+00)	Acc@1  61.72 ( 62.97)
Epoch: [7][ 75/313]	Time  0.428 ( 0.434)	Data  0.018 ( 0.026)	Loss 4.3320e+00 (4.3269e+00)	Acc@1  64.84 ( 63.54)
Epoch: [7][100/313]	Time  0.430 ( 0.432)	Data  0.018 ( 0.024)	Loss 4.3203e+00 (4.3264e+00)	Acc@1  67.97 ( 64.02)
Epoch: [7][125/313]	Time  0.423 ( 0.431)	Data  0.019 ( 0.023)	Loss 4.3086e+00 (4.3273e+00)	Acc@1  73.44 ( 63.92)
Epoch: [7][150/313]	Time  0.427 ( 0.430)	Data  0.016 ( 0.022)	Loss 4.3164e+00 (4.3269e+00)	Acc@1  63.28 ( 63.94)
Epoch: [7][175/313]	Time  0.419 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3594e+00 (4.3270e+00)	Acc@1  55.47 ( 63.92)
Epoch: [7][200/313]	Time  0.421 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3477e+00 (4.3269e+00)	Acc@1  58.59 ( 64.02)
Epoch: [7][225/313]	Time  0.429 ( 0.428)	Data  0.016 ( 0.020)	Loss 4.3359e+00 (4.3270e+00)	Acc@1  62.50 ( 63.89)
Epoch: [7][250/313]	Time  0.426 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  64.06 ( 63.70)
Epoch: [7][275/313]	Time  0.426 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  59.38 ( 63.71)
Epoch: [7][300/313]	Time  0.434 ( 0.428)	Data  0.022 ( 0.020)	Loss 4.3203e+00 (4.3272e+00)	Acc@1  67.97 ( 63.77)
Validate: [ 0/79]	Time  0.996 ( 0.996)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  64.06 ( 64.06)
Validate: [25/79]	Time  0.225 ( 0.255)	Loss 4.3281e+00 (4.3266e+00)	Prompt Acc@1  60.94 ( 63.73)
Validate: [50/79]	Time  0.221 ( 0.238)	Loss 4.3281e+00 (4.3262e+00)	Prompt Acc@1  64.06 ( 64.17)
Validate: [75/79]	Time  0.218 ( 0.233)	Loss 4.3125e+00 (4.3266e+00)	Prompt Acc@1  64.84 ( 63.99)
 * Prompt Acc@1 64.040
There's no improvement for 3 epochs.
Training mode
Epoch: [8][  0/313]	Time  1.184 ( 1.184)	Data  0.749 ( 0.749)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  62.50 ( 62.50)
Epoch: [8][ 25/313]	Time  0.433 ( 0.454)	Data  0.017 ( 0.045)	Loss 4.3359e+00 (4.3274e+00)	Acc@1  60.94 ( 63.88)
Epoch: [8][ 50/313]	Time  0.430 ( 0.440)	Data  0.018 ( 0.031)	Loss 4.3242e+00 (4.3285e+00)	Acc@1  65.62 ( 63.31)
Epoch: [8][ 75/313]	Time  0.432 ( 0.436)	Data  0.023 ( 0.027)	Loss 4.3242e+00 (4.3269e+00)	Acc@1  61.72 ( 63.89)
Epoch: [8][100/313]	Time  0.426 ( 0.433)	Data  0.017 ( 0.024)	Loss 4.3203e+00 (4.3265e+00)	Acc@1  63.28 ( 64.05)
Epoch: [8][125/313]	Time  0.418 ( 0.432)	Data  0.016 ( 0.023)	Loss 4.3047e+00 (4.3271e+00)	Acc@1  74.22 ( 64.03)
Epoch: [8][150/313]	Time  0.425 ( 0.431)	Data  0.017 ( 0.022)	Loss 4.3164e+00 (4.3267e+00)	Acc@1  62.50 ( 63.91)
Epoch: [8][175/313]	Time  0.439 ( 0.430)	Data  0.028 ( 0.022)	Loss 4.3555e+00 (4.3270e+00)	Acc@1  53.12 ( 63.82)
Epoch: [8][200/313]	Time  0.424 ( 0.430)	Data  0.017 ( 0.021)	Loss 4.3398e+00 (4.3270e+00)	Acc@1  55.47 ( 63.95)
Epoch: [8][225/313]	Time  0.422 ( 0.430)	Data  0.017 ( 0.021)	Loss 4.3320e+00 (4.3271e+00)	Acc@1  64.06 ( 63.92)
Epoch: [8][250/313]	Time  0.422 ( 0.429)	Data  0.016 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  64.06 ( 63.70)
Epoch: [8][275/313]	Time  0.438 ( 0.429)	Data  0.016 ( 0.020)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  60.94 ( 63.74)
Epoch: [8][300/313]	Time  0.434 ( 0.429)	Data  0.018 ( 0.020)	Loss 4.3203e+00 (4.3272e+00)	Acc@1  68.75 ( 63.77)
Validate: [ 0/79]	Time  0.959 ( 0.959)	Loss 4.3281e+00 (4.3281e+00)	Prompt Acc@1  67.19 ( 67.19)
Validate: [25/79]	Time  0.221 ( 0.255)	Loss 4.3320e+00 (4.3265e+00)	Prompt Acc@1  60.16 ( 63.58)
Validate: [50/79]	Time  0.270 ( 0.240)	Loss 4.3242e+00 (4.3266e+00)	Prompt Acc@1  64.84 ( 64.12)
Validate: [75/79]	Time  0.219 ( 0.235)	Loss 4.3125e+00 (4.3271e+00)	Prompt Acc@1  63.28 ( 63.92)
 * Prompt Acc@1 63.900
There's no improvement for 4 epochs.
Training mode
Epoch: [9][  0/313]	Time  1.207 ( 1.207)	Data  0.781 ( 0.781)	Loss 4.3281e+00 (4.3281e+00)	Acc@1  61.72 ( 61.72)
Epoch: [9][ 25/313]	Time  0.419 ( 0.457)	Data  0.016 ( 0.048)	Loss 4.3359e+00 (4.3269e+00)	Acc@1  60.16 ( 63.31)
Epoch: [9][ 50/313]	Time  0.421 ( 0.441)	Data  0.018 ( 0.033)	Loss 4.3281e+00 (4.3285e+00)	Acc@1  71.88 ( 63.37)
Epoch: [9][ 75/313]	Time  0.418 ( 0.436)	Data  0.016 ( 0.028)	Loss 4.3242e+00 (4.3269e+00)	Acc@1  62.50 ( 63.82)
Epoch: [9][100/313]	Time  0.421 ( 0.434)	Data  0.016 ( 0.025)	Loss 4.3203e+00 (4.3267e+00)	Acc@1  68.75 ( 64.19)
Epoch: [9][125/313]	Time  0.424 ( 0.432)	Data  0.017 ( 0.024)	Loss 4.3086e+00 (4.3273e+00)	Acc@1  71.09 ( 64.08)
Epoch: [9][150/313]	Time  0.423 ( 0.431)	Data  0.017 ( 0.023)	Loss 4.3203e+00 (4.3271e+00)	Acc@1  61.72 ( 64.02)
Epoch: [9][175/313]	Time  0.437 ( 0.430)	Data  0.017 ( 0.022)	Loss 4.3594e+00 (4.3273e+00)	Acc@1  54.69 ( 63.99)
Epoch: [9][200/313]	Time  0.432 ( 0.430)	Data  0.016 ( 0.021)	Loss 4.3398e+00 (4.3271e+00)	Acc@1  55.47 ( 64.07)
Epoch: [9][225/313]	Time  0.419 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3359e+00 (4.3273e+00)	Acc@1  61.72 ( 63.95)
Epoch: [9][250/313]	Time  0.422 ( 0.429)	Data  0.016 ( 0.020)	Loss 4.3203e+00 (4.3275e+00)	Acc@1  65.62 ( 63.74)
Epoch: [9][275/313]	Time  0.428 ( 0.429)	Data  0.018 ( 0.020)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  60.16 ( 63.75)
Epoch: [9][300/313]	Time  0.438 ( 0.429)	Data  0.016 ( 0.020)	Loss 4.3281e+00 (4.3276e+00)	Acc@1  67.97 ( 63.79)
Validate: [ 0/79]	Time  0.982 ( 0.982)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  62.50 ( 62.50)
Validate: [25/79]	Time  0.223 ( 0.259)	Loss 4.3281e+00 (4.3271e+00)	Prompt Acc@1  62.50 ( 63.79)
Validate: [50/79]	Time  0.224 ( 0.243)	Loss 4.3164e+00 (4.3261e+00)	Prompt Acc@1  67.19 ( 63.96)
Validate: [75/79]	Time  0.221 ( 0.235)	Loss 4.3164e+00 (4.3268e+00)	Prompt Acc@1  62.50 ( 63.61)
 * Prompt Acc@1 63.650
There's no improvement for 5 epochs.
Training mode
Epoch: [10][  0/313]	Time  1.212 ( 1.212)	Data  0.769 ( 0.769)	Loss 4.3242e+00 (4.3242e+00)	Acc@1  63.28 ( 63.28)
Epoch: [10][ 25/313]	Time  0.433 ( 0.454)	Data  0.017 ( 0.046)	Loss 4.3359e+00 (4.3286e+00)	Acc@1  60.16 ( 64.00)
Epoch: [10][ 50/313]	Time  0.431 ( 0.440)	Data  0.017 ( 0.032)	Loss 4.3242e+00 (4.3291e+00)	Acc@1  62.50 ( 63.45)
Epoch: [10][ 75/313]	Time  0.425 ( 0.435)	Data  0.017 ( 0.027)	Loss 4.3281e+00 (4.3277e+00)	Acc@1  60.94 ( 63.92)
Epoch: [10][100/313]	Time  0.417 ( 0.433)	Data  0.015 ( 0.024)	Loss 4.3203e+00 (4.3269e+00)	Acc@1  66.41 ( 64.24)
Epoch: [10][125/313]	Time  0.421 ( 0.431)	Data  0.017 ( 0.023)	Loss 4.3047e+00 (4.3273e+00)	Acc@1  75.00 ( 64.25)
Epoch: [10][150/313]	Time  0.420 ( 0.430)	Data  0.016 ( 0.022)	Loss 4.3125e+00 (4.3274e+00)	Acc@1  65.62 ( 64.04)
Epoch: [10][175/313]	Time  0.420 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3555e+00 (4.3275e+00)	Acc@1  50.78 ( 63.96)
Epoch: [10][200/313]	Time  0.423 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3438e+00 (4.3273e+00)	Acc@1  53.91 ( 64.11)
Epoch: [10][225/313]	Time  0.421 ( 0.428)	Data  0.018 ( 0.020)	Loss 4.3320e+00 (4.3273e+00)	Acc@1  66.41 ( 64.07)
Epoch: [10][250/313]	Time  0.419 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  63.28 ( 63.87)
Epoch: [10][275/313]	Time  0.423 ( 0.428)	Data  0.021 ( 0.020)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  60.94 ( 63.90)
Epoch: [10][300/313]	Time  0.419 ( 0.428)	Data  0.015 ( 0.020)	Loss 4.3242e+00 (4.3274e+00)	Acc@1  68.75 ( 63.93)
Validate: [ 0/79]	Time  1.089 ( 1.089)	Loss 4.3281e+00 (4.3281e+00)	Prompt Acc@1  63.28 ( 63.28)
Validate: [25/79]	Time  0.222 ( 0.258)	Loss 4.3320e+00 (4.3268e+00)	Prompt Acc@1  61.72 ( 63.55)
Validate: [50/79]	Time  0.221 ( 0.240)	Loss 4.3242e+00 (4.3261e+00)	Prompt Acc@1  65.62 ( 64.14)
Validate: [75/79]	Time  0.219 ( 0.234)	Loss 4.3164e+00 (4.3266e+00)	Prompt Acc@1  64.06 ( 63.74)
 * Prompt Acc@1 63.750
There's no improvement for 6 epochs.
Training mode
Epoch: [11][  0/313]	Time  1.165 ( 1.165)	Data  0.731 ( 0.731)	Loss 4.3242e+00 (4.3242e+00)	Acc@1  66.41 ( 66.41)
Epoch: [11][ 25/313]	Time  0.422 ( 0.455)	Data  0.018 ( 0.045)	Loss 4.3359e+00 (4.3274e+00)	Acc@1  58.59 ( 63.46)
Epoch: [11][ 50/313]	Time  0.424 ( 0.441)	Data  0.017 ( 0.031)	Loss 4.3242e+00 (4.3296e+00)	Acc@1  67.19 ( 63.48)
Epoch: [11][ 75/313]	Time  0.426 ( 0.436)	Data  0.016 ( 0.027)	Loss 4.3242e+00 (4.3277e+00)	Acc@1  61.72 ( 63.97)
Epoch: [11][100/313]	Time  0.417 ( 0.433)	Data  0.016 ( 0.025)	Loss 4.3164e+00 (4.3270e+00)	Acc@1  67.97 ( 64.25)
Epoch: [11][125/313]	Time  0.422 ( 0.431)	Data  0.018 ( 0.023)	Loss 4.3047e+00 (4.3277e+00)	Acc@1  74.22 ( 64.19)
Epoch: [11][150/313]	Time  0.423 ( 0.430)	Data  0.017 ( 0.022)	Loss 4.3164e+00 (4.3273e+00)	Acc@1  62.50 ( 64.17)
Epoch: [11][175/313]	Time  0.424 ( 0.429)	Data  0.016 ( 0.021)	Loss 4.3594e+00 (4.3274e+00)	Acc@1  53.12 ( 64.11)
Epoch: [11][200/313]	Time  0.426 ( 0.429)	Data  0.017 ( 0.021)	Loss 4.3398e+00 (4.3273e+00)	Acc@1  59.38 ( 64.25)
Epoch: [11][225/313]	Time  0.433 ( 0.428)	Data  0.017 ( 0.020)	Loss 4.3281e+00 (4.3273e+00)	Acc@1  67.19 ( 64.18)
Epoch: [11][250/313]	Time  0.441 ( 0.428)	Data  0.037 ( 0.020)	Loss 4.3281e+00 (4.3275e+00)	Acc@1  63.28 ( 63.98)
Epoch: [11][275/313]	Time  0.431 ( 0.428)	Data  0.019 ( 0.020)	Loss 4.3281e+00 (4.3275e+00)	Acc@1  60.94 ( 63.96)
Epoch: [11][300/313]	Time  0.425 ( 0.428)	Data  0.022 ( 0.020)	Loss 4.3242e+00 (4.3273e+00)	Acc@1  68.75 ( 64.02)
Validate: [ 0/79]	Time  0.924 ( 0.924)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  67.97 ( 67.97)
Validate: [25/79]	Time  0.219 ( 0.254)	Loss 4.3242e+00 (4.3260e+00)	Prompt Acc@1  63.28 ( 63.43)
Validate: [50/79]	Time  0.220 ( 0.239)	Loss 4.3203e+00 (4.3258e+00)	Prompt Acc@1  65.62 ( 64.03)
Validate: [75/79]	Time  0.221 ( 0.234)	Loss 4.3242e+00 (4.3266e+00)	Prompt Acc@1  61.72 ( 63.91)
 * Prompt Acc@1 63.960
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Validate: [ 0/79]	Time  1.025 ( 1.025)	Loss 4.3242e+00 (4.3242e+00)	Prompt Acc@1  66.41 ( 66.41)
Validate: [25/79]	Time  0.222 ( 0.258)	Loss 4.3320e+00 (4.3269e+00)	Prompt Acc@1  61.72 ( 63.37)
Validate: [50/79]	Time  0.229 ( 0.241)	Loss 4.3203e+00 (4.3264e+00)	Prompt Acc@1  67.19 ( 64.08)
Validate: [75/79]	Time  0.219 ( 0.234)	Loss 4.3164e+00 (4.3269e+00)	Prompt Acc@1  61.72 ( 63.86)
 * Prompt Acc@1 63.890
Validate: [ 0/79]	Time  0.936 ( 0.936)	Loss 4.3047e+00 (4.3047e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.224 ( 0.253)	Loss 4.3242e+00 (4.3298e+00)	Prompt Acc@1  61.72 ( 62.44)
Validate: [50/79]	Time  0.222 ( 0.237)	Loss 4.3477e+00 (4.3316e+00)	Prompt Acc@1  63.28 ( 63.45)
Validate: [75/79]	Time  0.219 ( 0.232)	Loss 4.3086e+00 (4.3292e+00)	Prompt Acc@1  69.53 ( 63.75)
 * Prompt Acc@1 63.700
Running experiment on cifar100 with padding and prompt size 30
Namespace(print_freq=25, save_freq=50, batch_size=128, num_workers=3, epochs=20, square_size=8, optim='sgd', learning_rate=40, weight_decay=0, warmup=1000, momentum=0.9, patience=7, model='clip', arch='ViT-B/32', method='padding', prompt_size=30, text_prompt_template='This is a photo of a {}', visualize_prompt=False, root='/scratch/lcur0649', dataset='cifar100', image_size=224, test_noise=False, seed=0, model_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints', image_dir='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/images', filename='padding_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1', trial=1, resume=None, evaluate=False, gpu=None, use_wandb=False, device='cuda', model_folder='/home/lcur0649/uvadlc_practicals_2022/assignment2/part2/checkpoints/padding_30_cifar100_clip_ViT-B/32_sgd_lr_40_decay_0_bsz_128_warmup_1000_trial_1')
Files already downloaded and verified
Files already downloaded and verified
Building custom CLIP
Loading CLIP (backbone: ViT-B/32)
List of prompts:
['This is a photo of a apple',
 'This is a photo of a aquarium fish',
 'This is a photo of a baby',
 'This is a photo of a bear',
 'This is a photo of a beaver',
 'This is a photo of a bed',
 'This is a photo of a bee',
 'This is a photo of a beetle',
 'This is a photo of a bicycle',
 'This is a photo of a bottle',
 'This is a photo of a bowl',
 'This is a photo of a boy',
 'This is a photo of a bridge',
 'This is a photo of a bus',
 'This is a photo of a butterfly',
 'This is a photo of a camel',
 'This is a photo of a can',
 'This is a photo of a castle',
 'This is a photo of a caterpillar',
 'This is a photo of a cattle',
 'This is a photo of a chair',
 'This is a photo of a chimpanzee',
 'This is a photo of a clock',
 'This is a photo of a cloud',
 'This is a photo of a cockroach',
 'This is a photo of a couch',
 'This is a photo of a crab',
 'This is a photo of a crocodile',
 'This is a photo of a cup',
 'This is a photo of a dinosaur',
 'This is a photo of a dolphin',
 'This is a photo of a elephant',
 'This is a photo of a flatfish',
 'This is a photo of a forest',
 'This is a photo of a fox',
 'This is a photo of a girl',
 'This is a photo of a hamster',
 'This is a photo of a house',
 'This is a photo of a kangaroo',
 'This is a photo of a keyboard',
 'This is a photo of a lamp',
 'This is a photo of a lawn mower',
 'This is a photo of a leopard',
 'This is a photo of a lion',
 'This is a photo of a lizard',
 'This is a photo of a lobster',
 'This is a photo of a man',
 'This is a photo of a maple tree',
 'This is a photo of a motorcycle',
 'This is a photo of a mountain',
 'This is a photo of a mouse',
 'This is a photo of a mushroom',
 'This is a photo of a oak tree',
 'This is a photo of a orange',
 'This is a photo of a orchid',
 'This is a photo of a otter',
 'This is a photo of a palm tree',
 'This is a photo of a pear',
 'This is a photo of a pickup truck',
 'This is a photo of a pine tree',
 'This is a photo of a plain',
 'This is a photo of a plate',
 'This is a photo of a poppy',
 'This is a photo of a porcupine',
 'This is a photo of a possum',
 'This is a photo of a rabbit',
 'This is a photo of a raccoon',
 'This is a photo of a ray',
 'This is a photo of a road',
 'This is a photo of a rocket',
 'This is a photo of a rose',
 'This is a photo of a sea',
 'This is a photo of a seal',
 'This is a photo of a shark',
 'This is a photo of a shrew',
 'This is a photo of a skunk',
 'This is a photo of a skyscraper',
 'This is a photo of a snail',
 'This is a photo of a snake',
 'This is a photo of a spider',
 'This is a photo of a squirrel',
 'This is a photo of a streetcar',
 'This is a photo of a sunflower',
 'This is a photo of a sweet pepper',
 'This is a photo of a table',
 'This is a photo of a tank',
 'This is a photo of a telephone',
 'This is a photo of a television',
 'This is a photo of a tiger',
 'This is a photo of a tractor',
 'This is a photo of a train',
 'This is a photo of a trout',
 'This is a photo of a tulip',
 'This is a photo of a turtle',
 'This is a photo of a wardrobe',
 'This is a photo of a whale',
 'This is a photo of a willow tree',
 'This is a photo of a wolf',
 'This is a photo of a woman',
 'This is a photo of a worm']
Turning off gradients in both the image and the text encoder
Parameters to be updated:
("Parameters to be updated: {'prompt_learner.pad_right', "
 "'prompt_learner.pad_up', 'prompt_learner.pad_left', "
 "'prompt_learner.pad_down'}")
Number of prompt parameters:  69840
Training mode
Epoch: [0][  0/313]	Time  2.329 ( 2.329)	Data  0.750 ( 0.750)	Loss 4.4062e+00 (4.4062e+00)	Acc@1  44.53 ( 44.53)
Epoch: [0][ 25/313]	Time  0.435 ( 0.500)	Data  0.016 ( 0.046)	Loss 4.3945e+00 (4.3870e+00)	Acc@1  47.66 ( 47.90)
Epoch: [0][ 50/313]	Time  0.427 ( 0.465)	Data  0.017 ( 0.032)	Loss 4.3594e+00 (4.3797e+00)	Acc@1  52.34 ( 49.34)
Epoch: [0][ 75/313]	Time  0.422 ( 0.453)	Data  0.015 ( 0.027)	Loss 4.3516e+00 (4.3740e+00)	Acc@1  55.47 ( 50.82)
Epoch: [0][100/313]	Time  0.424 ( 0.446)	Data  0.016 ( 0.024)	Loss 4.3281e+00 (4.3677e+00)	Acc@1  62.50 ( 52.07)
Epoch: [0][125/313]	Time  0.433 ( 0.443)	Data  0.016 ( 0.023)	Loss 4.3438e+00 (4.3612e+00)	Acc@1  57.81 ( 53.52)
Epoch: [0][150/313]	Time  0.429 ( 0.440)	Data  0.017 ( 0.022)	Loss 4.3242e+00 (4.3558e+00)	Acc@1  61.72 ( 54.37)
Epoch: [0][175/313]	Time  0.433 ( 0.438)	Data  0.017 ( 0.021)	Loss 4.2695e+00 (4.3481e+00)	Acc@1  66.41 ( 55.40)
Epoch: [0][200/313]	Time  0.437 ( 0.437)	Data  0.017 ( 0.021)	Loss 4.2773e+00 (4.3400e+00)	Acc@1  60.16 ( 56.04)
Epoch: [0][225/313]	Time  0.422 ( 0.436)	Data  0.015 ( 0.020)	Loss 4.2461e+00 (4.3313e+00)	Acc@1  60.94 ( 56.63)
Epoch: [0][250/313]	Time  0.422 ( 0.435)	Data  0.017 ( 0.020)	Loss 4.2539e+00 (4.3241e+00)	Acc@1  64.06 ( 56.99)
Epoch: [0][275/313]	Time  0.434 ( 0.435)	Data  0.016 ( 0.020)	Loss 4.2539e+00 (4.3168e+00)	Acc@1  52.34 ( 57.40)
Epoch: [0][300/313]	Time  0.427 ( 0.434)	Data  0.017 ( 0.020)	Loss 4.2266e+00 (4.3099e+00)	Acc@1  67.19 ( 57.82)
Validate: [ 0/79]	Time  1.055 ( 1.055)	Loss 4.2305e+00 (4.2305e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.220 ( 0.259)	Loss 4.2266e+00 (4.2270e+00)	Prompt Acc@1  67.19 ( 64.21)
Validate: [50/79]	Time  0.222 ( 0.241)	Loss 4.2266e+00 (4.2261e+00)	Prompt Acc@1  62.50 ( 63.92)
Validate: [75/79]	Time  0.220 ( 0.236)	Loss 4.2109e+00 (4.2251e+00)	Prompt Acc@1  65.62 ( 63.83)
 * Prompt Acc@1 63.640
saved best file
Training mode
Epoch: [1][  0/313]	Time  1.277 ( 1.277)	Data  0.849 ( 0.849)	Loss 4.2383e+00 (4.2383e+00)	Acc@1  61.72 ( 61.72)
Epoch: [1][ 25/313]	Time  0.432 ( 0.461)	Data  0.017 ( 0.049)	Loss 4.2422e+00 (4.2227e+00)	Acc@1  64.84 ( 63.64)
Epoch: [1][ 50/313]	Time  0.430 ( 0.445)	Data  0.016 ( 0.033)	Loss 4.2070e+00 (4.2181e+00)	Acc@1  67.19 ( 63.51)
Epoch: [1][ 75/313]	Time  0.429 ( 0.441)	Data  0.017 ( 0.028)	Loss 4.2148e+00 (4.2152e+00)	Acc@1  61.72 ( 63.45)
Epoch: [1][100/313]	Time  0.433 ( 0.438)	Data  0.017 ( 0.026)	Loss 4.1875e+00 (4.2117e+00)	Acc@1  70.31 ( 63.37)
Epoch: [1][125/313]	Time  0.429 ( 0.436)	Data  0.016 ( 0.024)	Loss 4.2148e+00 (4.2078e+00)	Acc@1  59.38 ( 63.41)
Epoch: [1][150/313]	Time  0.446 ( 0.435)	Data  0.018 ( 0.023)	Loss 4.1875e+00 (4.2051e+00)	Acc@1  65.62 ( 63.25)
Epoch: [1][175/313]	Time  0.429 ( 0.435)	Data  0.016 ( 0.022)	Loss 4.1562e+00 (4.2017e+00)	Acc@1  67.19 ( 63.24)
Epoch: [1][200/313]	Time  0.428 ( 0.434)	Data  0.018 ( 0.022)	Loss 4.1797e+00 (4.1986e+00)	Acc@1  56.25 ( 63.18)
Epoch: [1][225/313]	Time  0.428 ( 0.434)	Data  0.016 ( 0.021)	Loss 4.1641e+00 (4.1950e+00)	Acc@1  63.28 ( 63.18)
Epoch: [1][250/313]	Time  0.424 ( 0.433)	Data  0.017 ( 0.021)	Loss 4.1562e+00 (4.1925e+00)	Acc@1  65.62 ( 63.11)
Epoch: [1][275/313]	Time  0.429 ( 0.433)	Data  0.017 ( 0.021)	Loss 4.1719e+00 (4.1890e+00)	Acc@1  56.25 ( 63.13)
Epoch: [1][300/313]	Time  0.425 ( 0.433)	Data  0.018 ( 0.020)	Loss 4.1484e+00 (4.1859e+00)	Acc@1  69.53 ( 63.08)
Validate: [ 0/79]	Time  0.997 ( 0.997)	Loss 4.1445e+00 (4.1445e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.222 ( 0.257)	Loss 4.1484e+00 (4.1454e+00)	Prompt Acc@1  67.19 ( 64.09)
Validate: [50/79]	Time  0.234 ( 0.240)	Loss 4.1523e+00 (4.1445e+00)	Prompt Acc@1  61.72 ( 63.80)
Validate: [75/79]	Time  0.219 ( 0.235)	Loss 4.1289e+00 (4.1433e+00)	Prompt Acc@1  65.62 ( 63.89)
 * Prompt Acc@1 63.730
saved best file
Training mode
Epoch: [2][  0/313]	Time  1.249 ( 1.249)	Data  0.807 ( 0.807)	Loss 4.1523e+00 (4.1523e+00)	Acc@1  59.38 ( 59.38)
Epoch: [2][ 25/313]	Time  0.432 ( 0.463)	Data  0.016 ( 0.050)	Loss 4.1562e+00 (4.1390e+00)	Acc@1  65.62 ( 64.78)
Epoch: [2][ 50/313]	Time  0.426 ( 0.448)	Data  0.019 ( 0.035)	Loss 4.1289e+00 (4.1362e+00)	Acc@1  63.28 ( 64.78)
Epoch: [2][ 75/313]	Time  0.428 ( 0.443)	Data  0.017 ( 0.029)	Loss 4.1445e+00 (4.1346e+00)	Acc@1  64.84 ( 64.60)
Epoch: [2][100/313]	Time  0.423 ( 0.439)	Data  0.015 ( 0.026)	Loss 4.1133e+00 (4.1324e+00)	Acc@1  67.97 ( 64.16)
Epoch: [2][125/313]	Time  0.426 ( 0.437)	Data  0.016 ( 0.024)	Loss 4.1484e+00 (4.1292e+00)	Acc@1  58.59 ( 64.18)
Epoch: [2][150/313]	Time  0.431 ( 0.436)	Data  0.017 ( 0.023)	Loss 4.1211e+00 (4.1273e+00)	Acc@1  64.84 ( 64.08)
Epoch: [2][175/313]	Time  0.437 ( 0.435)	Data  0.021 ( 0.022)	Loss 4.0859e+00 (4.1249e+00)	Acc@1  67.19 ( 64.10)
Epoch: [2][200/313]	Time  0.426 ( 0.434)	Data  0.016 ( 0.021)	Loss 4.1172e+00 (4.1231e+00)	Acc@1  58.59 ( 64.02)
Epoch: [2][225/313]	Time  0.424 ( 0.433)	Data  0.017 ( 0.021)	Loss 4.0898e+00 (4.1205e+00)	Acc@1  65.62 ( 64.01)
Epoch: [2][250/313]	Time  0.429 ( 0.433)	Data  0.016 ( 0.021)	Loss 4.0820e+00 (4.1189e+00)	Acc@1  69.53 ( 63.86)
Epoch: [2][275/313]	Time  0.421 ( 0.432)	Data  0.016 ( 0.020)	Loss 4.1055e+00 (4.1162e+00)	Acc@1  53.91 ( 63.88)
Epoch: [2][300/313]	Time  0.428 ( 0.432)	Data  0.016 ( 0.020)	Loss 4.0859e+00 (4.1141e+00)	Acc@1  68.75 ( 63.84)
Validate: [ 0/79]	Time  0.892 ( 0.892)	Loss 4.0781e+00 (4.0781e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.220 ( 0.259)	Loss 4.0820e+00 (4.0823e+00)	Prompt Acc@1  67.97 ( 64.15)
Validate: [50/79]	Time  0.222 ( 0.241)	Loss 4.0859e+00 (4.0817e+00)	Prompt Acc@1  62.50 ( 64.22)
Validate: [75/79]	Time  0.222 ( 0.236)	Loss 4.0703e+00 (4.0811e+00)	Prompt Acc@1  64.06 ( 63.94)
 * Prompt Acc@1 63.820
saved best file
Training mode
Epoch: [3][  0/313]	Time  1.157 ( 1.157)	Data  0.739 ( 0.739)	Loss 4.0820e+00 (4.0820e+00)	Acc@1  62.50 ( 62.50)
Epoch: [3][ 25/313]	Time  0.429 ( 0.461)	Data  0.017 ( 0.047)	Loss 4.0938e+00 (4.0772e+00)	Acc@1  64.06 ( 64.30)
Epoch: [3][ 50/313]	Time  0.433 ( 0.446)	Data  0.018 ( 0.033)	Loss 4.0625e+00 (4.0753e+00)	Acc@1  65.62 ( 64.69)
Epoch: [3][ 75/313]	Time  0.427 ( 0.442)	Data  0.017 ( 0.028)	Loss 4.0859e+00 (4.0745e+00)	Acc@1  63.28 ( 64.68)
Epoch: [3][100/313]	Time  0.426 ( 0.439)	Data  0.017 ( 0.025)	Loss 4.0508e+00 (4.0727e+00)	Acc@1  67.97 ( 64.36)
Epoch: [3][125/313]	Time  0.431 ( 0.438)	Data  0.016 ( 0.024)	Loss 4.0898e+00 (4.0698e+00)	Acc@1  61.72 ( 64.30)
Epoch: [3][150/313]	Time  0.437 ( 0.437)	Data  0.017 ( 0.022)	Loss 4.0586e+00 (4.0683e+00)	Acc@1  64.06 ( 64.18)
Epoch: [3][175/313]	Time  0.433 ( 0.437)	Data  0.017 ( 0.022)	Loss 4.0352e+00 (4.0663e+00)	Acc@1  65.62 ( 64.20)
Epoch: [3][200/313]	Time  0.436 ( 0.436)	Data  0.022 ( 0.021)	Loss 4.0625e+00 (4.0648e+00)	Acc@1  59.38 ( 64.03)
Epoch: [3][225/313]	Time  0.432 ( 0.436)	Data  0.017 ( 0.021)	Loss 4.0391e+00 (4.0625e+00)	Acc@1  64.06 ( 63.93)
Epoch: [3][250/313]	Time  0.432 ( 0.435)	Data  0.016 ( 0.020)	Loss 4.0312e+00 (4.0615e+00)	Acc@1  68.75 ( 63.71)
Epoch: [3][275/313]	Time  0.433 ( 0.435)	Data  0.017 ( 0.020)	Loss 4.0508e+00 (4.0591e+00)	Acc@1  52.34 ( 63.64)
Epoch: [3][300/313]	Time  0.427 ( 0.435)	Data  0.016 ( 0.020)	Loss 4.0273e+00 (4.0571e+00)	Acc@1  68.75 ( 63.61)
Validate: [ 0/79]	Time  0.942 ( 0.942)	Loss 4.0234e+00 (4.0234e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.219 ( 0.255)	Loss 4.0234e+00 (4.0308e+00)	Prompt Acc@1  67.97 ( 63.22)
Validate: [50/79]	Time  0.221 ( 0.239)	Loss 4.0352e+00 (4.0300e+00)	Prompt Acc@1  64.06 ( 62.99)
Validate: [75/79]	Time  0.222 ( 0.233)	Loss 4.0156e+00 (4.0293e+00)	Prompt Acc@1  66.41 ( 62.79)
 * Prompt Acc@1 62.630
There's no improvement for 1 epochs.
Training mode
Epoch: [4][  0/313]	Time  1.183 ( 1.183)	Data  0.736 ( 0.736)	Loss 4.0273e+00 (4.0273e+00)	Acc@1  61.72 ( 61.72)
Epoch: [4][ 25/313]	Time  0.438 ( 0.465)	Data  0.025 ( 0.047)	Loss 4.0547e+00 (4.0273e+00)	Acc@1  64.84 ( 64.45)
Epoch: [4][ 50/313]	Time  0.427 ( 0.448)	Data  0.017 ( 0.032)	Loss 4.0156e+00 (4.0242e+00)	Acc@1  65.62 ( 64.34)
Epoch: [4][ 75/313]	Time  0.434 ( 0.444)	Data  0.017 ( 0.027)	Loss 4.0391e+00 (4.0238e+00)	Acc@1  63.28 ( 64.10)
Epoch: [4][100/313]	Time  0.427 ( 0.441)	Data  0.017 ( 0.025)	Loss 4.0000e+00 (4.0228e+00)	Acc@1  70.31 ( 63.76)
Epoch: [4][125/313]	Time  0.435 ( 0.440)	Data  0.018 ( 0.024)	Loss 4.0430e+00 (4.0201e+00)	Acc@1  62.50 ( 63.79)
Epoch: [4][150/313]	Time  0.428 ( 0.439)	Data  0.017 ( 0.023)	Loss 4.0117e+00 (4.0193e+00)	Acc@1  64.06 ( 63.75)
Epoch: [4][175/313]	Time  0.426 ( 0.438)	Data  0.016 ( 0.022)	Loss 3.9980e+00 (4.0180e+00)	Acc@1  65.62 ( 63.78)
Epoch: [4][200/313]	Time  0.427 ( 0.437)	Data  0.017 ( 0.021)	Loss 4.0156e+00 (4.0173e+00)	Acc@1  57.81 ( 63.59)
Epoch: [4][225/313]	Time  0.434 ( 0.437)	Data  0.017 ( 0.021)	Loss 4.0000e+00 (4.0158e+00)	Acc@1  64.06 ( 63.46)
Epoch: [4][250/313]	Time  0.435 ( 0.436)	Data  0.016 ( 0.020)	Loss 3.9922e+00 (4.0155e+00)	Acc@1  69.53 ( 63.34)
Epoch: [4][275/313]	Time  0.428 ( 0.436)	Data  0.016 ( 0.020)	Loss 4.0117e+00 (4.0138e+00)	Acc@1  53.12 ( 63.30)
Epoch: [4][300/313]	Time  0.431 ( 0.436)	Data  0.018 ( 0.020)	Loss 3.9902e+00 (4.0125e+00)	Acc@1  70.31 ( 63.26)
Validate: [ 0/79]	Time  0.963 ( 0.963)	Loss 3.9922e+00 (3.9922e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.219 ( 0.253)	Loss 3.9863e+00 (3.9970e+00)	Prompt Acc@1  69.53 ( 62.89)
Validate: [50/79]	Time  0.226 ( 0.238)	Loss 4.0000e+00 (3.9961e+00)	Prompt Acc@1  62.50 ( 62.59)
Validate: [75/79]	Time  0.223 ( 0.234)	Loss 3.9785e+00 (3.9952e+00)	Prompt Acc@1  64.06 ( 62.55)
 * Prompt Acc@1 62.440
There's no improvement for 2 epochs.
Training mode
Epoch: [5][  0/313]	Time  1.158 ( 1.158)	Data  0.701 ( 0.701)	Loss 4.0000e+00 (4.0000e+00)	Acc@1  62.50 ( 62.50)
Epoch: [5][ 25/313]	Time  0.434 ( 0.462)	Data  0.017 ( 0.045)	Loss 4.0273e+00 (3.9920e+00)	Acc@1  60.94 ( 63.76)
Epoch: [5][ 50/313]	Time  0.435 ( 0.447)	Data  0.016 ( 0.031)	Loss 3.9805e+00 (3.9897e+00)	Acc@1  67.97 ( 63.94)
Epoch: [5][ 75/313]	Time  0.440 ( 0.443)	Data  0.017 ( 0.027)	Loss 4.0156e+00 (3.9900e+00)	Acc@1  63.28 ( 64.11)
Epoch: [5][100/313]	Time  0.429 ( 0.440)	Data  0.017 ( 0.025)	Loss 3.9727e+00 (3.9899e+00)	Acc@1  67.97 ( 63.75)
Epoch: [5][125/313]	Time  0.442 ( 0.439)	Data  0.017 ( 0.023)	Loss 4.0195e+00 (3.9879e+00)	Acc@1  65.62 ( 63.67)
Epoch: [5][150/313]	Time  0.432 ( 0.438)	Data  0.017 ( 0.022)	Loss 3.9805e+00 (3.9877e+00)	Acc@1  64.84 ( 63.55)
Epoch: [5][175/313]	Time  0.428 ( 0.437)	Data  0.017 ( 0.022)	Loss 3.9727e+00 (3.9870e+00)	Acc@1  60.16 ( 63.51)
Epoch: [5][200/313]	Time  0.437 ( 0.437)	Data  0.018 ( 0.021)	Loss 3.9824e+00 (3.9868e+00)	Acc@1  57.81 ( 63.29)
Epoch: [5][225/313]	Time  0.434 ( 0.437)	Data  0.018 ( 0.021)	Loss 3.9766e+00 (3.9857e+00)	Acc@1  63.28 ( 63.20)
Epoch: [5][250/313]	Time  0.432 ( 0.436)	Data  0.017 ( 0.021)	Loss 3.9648e+00 (3.9859e+00)	Acc@1  69.53 ( 63.10)
Epoch: [5][275/313]	Time  0.433 ( 0.436)	Data  0.017 ( 0.020)	Loss 3.9863e+00 (3.9847e+00)	Acc@1  56.25 ( 63.08)
Epoch: [5][300/313]	Time  0.432 ( 0.435)	Data  0.016 ( 0.020)	Loss 3.9688e+00 (3.9838e+00)	Acc@1  66.41 ( 62.99)
Validate: [ 0/79]	Time  0.989 ( 0.989)	Loss 3.9688e+00 (3.9688e+00)	Prompt Acc@1  67.97 ( 67.97)
Validate: [25/79]	Time  0.223 ( 0.257)	Loss 3.9629e+00 (3.9736e+00)	Prompt Acc@1  68.75 ( 63.04)
Validate: [50/79]	Time  0.222 ( 0.240)	Loss 3.9766e+00 (3.9727e+00)	Prompt Acc@1  61.72 ( 62.61)
Validate: [75/79]	Time  0.223 ( 0.235)	Loss 3.9531e+00 (3.9717e+00)	Prompt Acc@1  64.06 ( 62.45)
 * Prompt Acc@1 62.270
There's no improvement for 3 epochs.
Training mode
Epoch: [6][  0/313]	Time  1.116 ( 1.116)	Data  0.668 ( 0.668)	Loss 3.9805e+00 (3.9805e+00)	Acc@1  60.16 ( 60.16)
Epoch: [6][ 25/313]	Time  0.426 ( 0.460)	Data  0.016 ( 0.045)	Loss 4.0078e+00 (3.9688e+00)	Acc@1  60.16 ( 63.40)
Epoch: [6][ 50/313]	Time  0.445 ( 0.446)	Data  0.024 ( 0.031)	Loss 3.9570e+00 (3.9669e+00)	Acc@1  67.19 ( 63.71)
Epoch: [6][ 75/313]	Time  0.430 ( 0.442)	Data  0.018 ( 0.027)	Loss 3.9922e+00 (3.9676e+00)	Acc@1  62.50 ( 63.69)
Epoch: [6][100/313]	Time  0.431 ( 0.440)	Data  0.016 ( 0.024)	Loss 3.9492e+00 (3.9678e+00)	Acc@1  67.97 ( 63.40)
Epoch: [6][125/313]	Time  0.437 ( 0.438)	Data  0.017 ( 0.023)	Loss 4.0039e+00 (3.9660e+00)	Acc@1  61.72 ( 63.38)
Epoch: [6][150/313]	Time  0.435 ( 0.437)	Data  0.017 ( 0.022)	Loss 3.9609e+00 (3.9660e+00)	Acc@1  64.84 ( 63.28)
Epoch: [6][175/313]	Time  0.439 ( 0.436)	Data  0.017 ( 0.021)	Loss 3.9551e+00 (3.9655e+00)	Acc@1  59.38 ( 63.21)
Epoch: [6][200/313]	Time  0.434 ( 0.436)	Data  0.017 ( 0.021)	Loss 3.9609e+00 (3.9656e+00)	Acc@1  60.16 ( 62.95)
Epoch: [6][225/313]	Time  0.431 ( 0.436)	Data  0.016 ( 0.021)	Loss 3.9590e+00 (3.9648e+00)	Acc@1  62.50 ( 62.95)
Epoch: [6][250/313]	Time  0.432 ( 0.435)	Data  0.018 ( 0.020)	Loss 3.9434e+00 (3.9652e+00)	Acc@1  65.62 ( 62.92)
Epoch: [6][275/313]	Time  0.430 ( 0.435)	Data  0.017 ( 0.020)	Loss 3.9648e+00 (3.9642e+00)	Acc@1  53.12 ( 62.90)
Epoch: [6][300/313]	Time  0.444 ( 0.435)	Data  0.023 ( 0.020)	Loss 3.9531e+00 (3.9635e+00)	Acc@1  66.41 ( 62.81)
Validate: [ 0/79]	Time  0.981 ( 0.981)	Loss 3.9512e+00 (3.9512e+00)	Prompt Acc@1  68.75 ( 68.75)
Validate: [25/79]	Time  0.223 ( 0.264)	Loss 3.9453e+00 (3.9554e+00)	Prompt Acc@1  67.97 ( 62.89)
Validate: [50/79]	Time  0.223 ( 0.244)	Loss 3.9609e+00 (3.9547e+00)	Prompt Acc@1  60.94 ( 62.36)
Validate: [75/79]	Time  0.220 ( 0.237)	Loss 3.9336e+00 (3.9539e+00)	Prompt Acc@1  65.62 ( 62.39)
 * Prompt Acc@1 62.190
There's no improvement for 4 epochs.
Training mode
Epoch: [7][  0/313]	Time  1.185 ( 1.185)	Data  0.746 ( 0.746)	Loss 3.9629e+00 (3.9629e+00)	Acc@1  61.72 ( 61.72)
Epoch: [7][ 25/313]	Time  0.433 ( 0.459)	Data  0.019 ( 0.045)	Loss 3.9902e+00 (3.9519e+00)	Acc@1  58.59 ( 63.19)
Epoch: [7][ 50/313]	Time  0.436 ( 0.446)	Data  0.016 ( 0.031)	Loss 3.9414e+00 (3.9500e+00)	Acc@1  65.62 ( 63.54)
Epoch: [7][ 75/313]	Time  0.432 ( 0.441)	Data  0.017 ( 0.027)	Loss 3.9766e+00 (3.9508e+00)	Acc@1  61.72 ( 63.71)
Epoch: [7][100/313]	Time  0.435 ( 0.439)	Data  0.016 ( 0.024)	Loss 3.9297e+00 (3.9511e+00)	Acc@1  68.75 ( 63.24)
Epoch: [7][125/313]	Time  0.427 ( 0.437)	Data  0.017 ( 0.023)	Loss 3.9902e+00 (3.9494e+00)	Acc@1  62.50 ( 63.22)
Epoch: [7][150/313]	Time  0.425 ( 0.437)	Data  0.017 ( 0.022)	Loss 3.9453e+00 (3.9494e+00)	Acc@1  66.41 ( 63.11)
Epoch: [7][175/313]	Time  0.427 ( 0.436)	Data  0.017 ( 0.021)	Loss 3.9414e+00 (3.9490e+00)	Acc@1  60.16 ( 63.05)
Epoch: [7][200/313]	Time  0.430 ( 0.435)	Data  0.016 ( 0.021)	Loss 3.9473e+00 (3.9492e+00)	Acc@1  60.16 ( 62.88)
Epoch: [7][225/313]	Time  0.442 ( 0.435)	Data  0.018 ( 0.021)	Loss 3.9434e+00 (3.9484e+00)	Acc@1  60.16 ( 62.81)
Epoch: [7][250/313]	Time  0.439 ( 0.435)	Data  0.024 ( 0.020)	Loss 3.9258e+00 (3.9489e+00)	Acc@1  66.41 ( 62.78)
Epoch: [7][275/313]	Time  0.433 ( 0.435)	Data  0.017 ( 0.020)	Loss 3.9473e+00 (3.9480e+00)	Acc@1  54.69 ( 62.75)
Epoch: [7][300/313]	Time  0.432 ( 0.435)	Data  0.017 ( 0.020)	Loss 3.9395e+00 (3.9474e+00)	Acc@1  66.41 ( 62.66)
Validate: [ 0/79]	Time  1.090 ( 1.090)	Loss 3.9375e+00 (3.9375e+00)	Prompt Acc@1  66.41 ( 66.41)
Validate: [25/79]	Time  0.220 ( 0.259)	Loss 3.9297e+00 (3.9404e+00)	Prompt Acc@1  67.97 ( 62.32)
Validate: [50/79]	Time  0.228 ( 0.243)	Loss 3.9453e+00 (3.9399e+00)	Prompt Acc@1  61.72 ( 62.25)
Validate: [75/79]	Time  0.222 ( 0.237)	Loss 3.9199e+00 (3.9394e+00)	Prompt Acc@1  63.28 ( 62.16)
 * Prompt Acc@1 61.970
There's no improvement for 5 epochs.
Training mode
Epoch: [8][  0/313]	Time  1.133 ( 1.133)	Data  0.699 ( 0.699)	Loss 3.9512e+00 (3.9512e+00)	Acc@1  59.38 ( 59.38)
Epoch: [8][ 25/313]	Time  0.432 ( 0.464)	Data  0.017 ( 0.046)	Loss 3.9766e+00 (3.9374e+00)	Acc@1  57.81 ( 62.98)
Epoch: [8][ 50/313]	Time  0.437 ( 0.449)	Data  0.017 ( 0.032)	Loss 3.9297e+00 (3.9355e+00)	Acc@1  63.28 ( 63.10)
Epoch: [8][ 75/313]	Time  0.427 ( 0.444)	Data  0.017 ( 0.028)	Loss 3.9648e+00 (3.9362e+00)	Acc@1  61.72 ( 63.28)
Epoch: [8][100/313]	Time  0.428 ( 0.441)	Data  0.016 ( 0.025)	Loss 3.9121e+00 (3.9366e+00)	Acc@1  68.75 ( 62.98)
Epoch: [8][125/313]	Time  0.424 ( 0.439)	Data  0.016 ( 0.023)	Loss 3.9766e+00 (3.9351e+00)	Acc@1  59.38 ( 62.98)
Epoch: [8][150/313]	Time  0.426 ( 0.438)	Data  0.016 ( 0.022)	Loss 3.9316e+00 (3.9352e+00)	Acc@1  65.62 ( 62.85)
Epoch: [8][175/313]	Time  0.432 ( 0.437)	Data  0.016 ( 0.022)	Loss 3.9277e+00 (3.9349e+00)	Acc@1  59.38 ( 62.91)
Epoch: [8][200/313]	Time  0.435 ( 0.436)	Data  0.017 ( 0.021)	Loss 3.9336e+00 (3.9352e+00)	Acc@1  57.03 ( 62.67)
Epoch: [8][225/313]	Time  0.425 ( 0.436)	Data  0.015 ( 0.021)	Loss 3.9297e+00 (3.9345e+00)	Acc@1  61.72 ( 62.63)
Epoch: [8][250/313]	Time  0.428 ( 0.435)	Data  0.017 ( 0.020)	Loss 3.9121e+00 (3.9351e+00)	Acc@1  67.19 ( 62.58)
Epoch: [8][275/313]	Time  0.432 ( 0.435)	Data  0.017 ( 0.020)	Loss 3.9355e+00 (3.9344e+00)	Acc@1  54.69 ( 62.53)
Epoch: [8][300/313]	Time  0.433 ( 0.435)	Data  0.016 ( 0.020)	Loss 3.9277e+00 (3.9339e+00)	Acc@1  67.97 ( 62.45)
Validate: [ 0/79]	Time  0.922 ( 0.922)	Loss 3.9258e+00 (3.9258e+00)	Prompt Acc@1  66.41 ( 66.41)
Validate: [25/79]	Time  0.220 ( 0.255)	Loss 3.9199e+00 (3.9289e+00)	Prompt Acc@1  67.19 ( 62.02)
Validate: [50/79]	Time  0.220 ( 0.238)	Loss 3.9336e+00 (3.9283e+00)	Prompt Acc@1  61.72 ( 61.81)
Validate: [75/79]	Time  0.223 ( 0.233)	Loss 3.9082e+00 (3.9281e+00)	Prompt Acc@1  64.84 ( 61.71)
 * Prompt Acc@1 61.570
There's no improvement for 6 epochs.
Training mode
Epoch: [9][  0/313]	Time  1.099 ( 1.099)	Data  0.680 ( 0.680)	Loss 3.9395e+00 (3.9395e+00)	Acc@1  57.03 ( 57.03)
Epoch: [9][ 25/313]	Time  0.442 ( 0.462)	Data  0.023 ( 0.046)	Loss 3.9629e+00 (3.9260e+00)	Acc@1  57.03 ( 62.59)
Epoch: [9][ 50/313]	Time  0.439 ( 0.447)	Data  0.017 ( 0.032)	Loss 3.9180e+00 (3.9242e+00)	Acc@1  63.28 ( 62.79)
Epoch: [9][ 75/313]	Time  0.428 ( 0.442)	Data  0.017 ( 0.027)	Loss 3.9531e+00 (3.9249e+00)	Acc@1  60.94 ( 62.93)
Epoch: [9][100/313]	Time  0.437 ( 0.440)	Data  0.026 ( 0.024)	Loss 3.8984e+00 (3.9254e+00)	Acc@1  67.97 ( 62.67)
Epoch: [9][125/313]	Time  0.439 ( 0.439)	Data  0.017 ( 0.023)	Loss 3.9668e+00 (3.9239e+00)	Acc@1  58.59 ( 62.69)
Epoch: [9][150/313]	Time  0.438 ( 0.438)	Data  0.016 ( 0.022)	Loss 3.9219e+00 (3.9241e+00)	Acc@1  64.84 ( 62.61)
Epoch: [9][175/313]	Time  0.429 ( 0.437)	Data  0.016 ( 0.022)	Loss 3.9180e+00 (3.9241e+00)	Acc@1  61.72 ( 62.69)
Epoch: [9][200/313]	Time  0.440 ( 0.437)	Data  0.023 ( 0.021)	Loss 3.9238e+00 (3.9244e+00)	Acc@1  57.81 ( 62.45)
Epoch: [9][225/313]	Time  0.430 ( 0.436)	Data  0.016 ( 0.021)	Loss 3.9180e+00 (3.9238e+00)	Acc@1  61.72 ( 62.43)
Epoch: [9][250/313]	Time  0.436 ( 0.436)	Data  0.025 ( 0.020)	Loss 3.9004e+00 (3.9244e+00)	Acc@1  67.19 ( 62.38)
Epoch: [9][275/313]	Time  0.435 ( 0.436)	Data  0.022 ( 0.020)	Loss 3.9258e+00 (3.9238e+00)	Acc@1  53.91 ( 62.36)
Epoch: [9][300/313]	Time  0.435 ( 0.435)	Data  0.019 ( 0.020)	Loss 3.9180e+00 (3.9234e+00)	Acc@1  67.97 ( 62.32)
Validate: [ 0/79]	Time  0.967 ( 0.967)	Loss 3.9160e+00 (3.9160e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.219 ( 0.258)	Loss 3.9102e+00 (3.9192e+00)	Prompt Acc@1  65.62 ( 61.87)
Validate: [50/79]	Time  0.220 ( 0.241)	Loss 3.9258e+00 (3.9186e+00)	Prompt Acc@1  59.38 ( 61.75)
Validate: [75/79]	Time  0.222 ( 0.235)	Loss 3.8965e+00 (3.9184e+00)	Prompt Acc@1  64.84 ( 61.68)
 * Prompt Acc@1 61.570
There's no improvement for 7 epochs.
The training halted by early stopping criterion.
Validate: [ 0/79]	Time  0.978 ( 0.978)	Loss 3.9160e+00 (3.9160e+00)	Prompt Acc@1  64.84 ( 64.84)
Validate: [25/79]	Time  0.225 ( 0.258)	Loss 3.9102e+00 (3.9192e+00)	Prompt Acc@1  65.62 ( 61.87)
Validate: [50/79]	Time  0.224 ( 0.242)	Loss 3.9258e+00 (3.9186e+00)	Prompt Acc@1  59.38 ( 61.75)
Validate: [75/79]	Time  0.219 ( 0.236)	Loss 3.8965e+00 (3.9184e+00)	Prompt Acc@1  64.84 ( 61.68)
 * Prompt Acc@1 61.570
Validate: [ 0/79]	Time  0.988 ( 0.988)	Loss 3.8945e+00 (3.8945e+00)	Prompt Acc@1  73.44 ( 73.44)
Validate: [25/79]	Time  0.221 ( 0.259)	Loss 3.9492e+00 (3.9199e+00)	Prompt Acc@1  55.47 ( 63.25)
Validate: [50/79]	Time  0.220 ( 0.241)	Loss 3.9316e+00 (3.9234e+00)	Prompt Acc@1  60.94 ( 62.25)
Validate: [75/79]	Time  0.223 ( 0.236)	Loss 3.9062e+00 (3.9229e+00)	Prompt Acc@1  60.16 ( 62.38)
 * Prompt Acc@1 62.460
